<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 2 Estimación no-paramétrica de densidades | Notas Curso de Estadística II</title>
  <meta name="description" content="Capítulo 2 Estimación no-paramétrica de densidades | Notas Curso de Estadística II" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 2 Estimación no-paramétrica de densidades | Notas Curso de Estadística II" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 2 Estimación no-paramétrica de densidades | Notas Curso de Estadística II" />
  
  
  

<meta name="author" content="Maikol Solís Chacón y Luis Barboza Chinchilla" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="02-jacknife-bootstrap.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Curso de Estadística</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html"><i class="fa fa-check"></i><b>2</b> Estimación no-paramétrica de densidades</a>
<ul>
<li class="chapter" data-level="2.1" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#histograma"><i class="fa fa-check"></i><b>2.1</b> Histograma</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#construcción-estadística"><i class="fa fa-check"></i><b>2.1.1</b> Construcción Estadística</a></li>
<li class="chapter" data-level="2.1.2" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#construcción-probabilística"><i class="fa fa-check"></i><b>2.1.2</b> Construcción probabilística</a></li>
<li class="chapter" data-level="2.1.3" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#propiedades-estadísticas"><i class="fa fa-check"></i><b>2.1.3</b> Propiedades estadísticas</a></li>
<li class="chapter" data-level="2.1.4" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#propiedades-estadísticas-1"><i class="fa fa-check"></i><b>2.1.4</b> Propiedades estadísticas</a></li>
<li class="chapter" data-level="2.1.5" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#sesgo"><i class="fa fa-check"></i><b>2.1.5</b> Sesgo</a></li>
<li class="chapter" data-level="2.1.6" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#varianza"><i class="fa fa-check"></i><b>2.1.6</b> Varianza</a></li>
<li class="chapter" data-level="2.1.7" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#error-cuadrático-medio"><i class="fa fa-check"></i><b>2.1.7</b> Error cuadrático medio</a></li>
<li class="chapter" data-level="2.1.8" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#error-cuadrático-medio-integrado"><i class="fa fa-check"></i><b>2.1.8</b> Error cuadrático medio integrado</a></li>
<li class="chapter" data-level="2.1.9" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#ancho-de-banda-óptimo-para-el-histograma"><i class="fa fa-check"></i><b>2.1.9</b> Ancho de banda óptimo para el histograma</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#estimación-de-densidades-basada-en-kernels."><i class="fa fa-check"></i><b>2.2</b> Estimación de densidades basada en kernels.</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#primera-construcción"><i class="fa fa-check"></i><b>2.2.1</b> Primera construcción</a></li>
<li class="chapter" data-level="2.2.2" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#otra-construcción"><i class="fa fa-check"></i><b>2.2.2</b> Otra construcción</a></li>
<li class="chapter" data-level="2.2.3" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#propiedades-estadísticas-2"><i class="fa fa-check"></i><b>2.2.3</b> Propiedades Estadísticas</a></li>
<li class="chapter" data-level="2.2.4" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#sesgo-1"><i class="fa fa-check"></i><b>2.2.4</b> Sesgo</a></li>
<li class="chapter" data-level="2.2.5" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#error-cuadrático-medio-y-error-cuadrático-medio-integrado"><i class="fa fa-check"></i><b>2.2.5</b> Error cuadrático medio y Error cuadrático medio integrado</a></li>
<li class="chapter" data-level="2.2.6" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#ancho-de-banda-óptimo"><i class="fa fa-check"></i><b>2.2.6</b> Ancho de banda óptimo</a></li>
<li class="chapter" data-level="2.2.7" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#intervalos-de-confianza-para-estimadores-de-densidad-no-paramétricos"><i class="fa fa-check"></i><b>2.2.7</b> Intervalos de confianza para estimadores de densidad no paramétricos</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#laboratorio"><i class="fa fa-check"></i><b>2.3</b> Laboratorio</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#efecto-de-distintos-kernels-en-la-estimación"><i class="fa fa-check"></i><b>2.3.1</b> Efecto de distintos Kernels en la estimación</a></li>
<li class="chapter" data-level="2.3.2" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#efecto-del-ancho-de-banda-en-la-estimación"><i class="fa fa-check"></i><b>2.3.2</b> Efecto del ancho de banda en la estimación</a></li>
<li class="chapter" data-level="2.3.3" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#ancho-de-banda-óptimo-1"><i class="fa fa-check"></i><b>2.3.3</b> Ancho de banda óptimo</a></li>
<li class="chapter" data-level="2.3.4" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#validación-cruzada-1"><i class="fa fa-check"></i><b>2.3.4</b> Validación cruzada</a></li>
<li class="chapter" data-level="2.3.5" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#temas-adicionales"><i class="fa fa-check"></i><b>2.3.5</b> Temas adicionales</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#ejercicios"><i class="fa fa-check"></i><b>2.4</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="02-jacknife-bootstrap.html"><a href="02-jacknife-bootstrap.html"><i class="fa fa-check"></i><b>3</b> Jackknife y Bootstrap</a>
<ul>
<li class="chapter" data-level="3.1" data-path="02-jacknife-bootstrap.html"><a href="02-jacknife-bootstrap.html#caso-concreto"><i class="fa fa-check"></i><b>3.1</b> Caso concreto</a></li>
<li class="chapter" data-level="3.2" data-path="02-jacknife-bootstrap.html"><a href="02-jacknife-bootstrap.html#jackknife"><i class="fa fa-check"></i><b>3.2</b> Jackknife</a></li>
<li class="chapter" data-level="3.3" data-path="02-jacknife-bootstrap.html"><a href="02-jacknife-bootstrap.html#bootstrap"><i class="fa fa-check"></i><b>3.3</b> Bootstrap</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="02-jacknife-bootstrap.html"><a href="02-jacknife-bootstrap.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>3.3.1</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="3.3.2" data-path="02-jacknife-bootstrap.html"><a href="02-jacknife-bootstrap.html#resumiendo"><i class="fa fa-check"></i><b>3.3.2</b> Resumiendo</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="02-jacknife-bootstrap.html"><a href="02-jacknife-bootstrap.html#ejercicios-1"><i class="fa fa-check"></i><b>3.4</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html"><i class="fa fa-check"></i><b>4</b> Métodos lineales de regresión</a>
<ul>
<li class="chapter" data-level="4.1" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#introducción-al-aprendizaje-estadístico."><i class="fa fa-check"></i><b>4.1</b> Introducción al Aprendizaje Estadístico.</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#formas-de-estimar-f"><i class="fa fa-check"></i><b>4.1.1</b> Formas de estimar <span class="math inline">\(f\)</span></a></li>
<li class="chapter" data-level="4.1.2" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#medidas-de-bondad-de-ajuste"><i class="fa fa-check"></i><b>4.1.2</b> Medidas de bondad de ajuste</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#regresión-lineal"><i class="fa fa-check"></i><b>4.2</b> Regresión lineal</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#forma-matricial"><i class="fa fa-check"></i><b>4.2.1</b> Forma matricial</a></li>
<li class="chapter" data-level="4.2.2" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#laboratorio-1"><i class="fa fa-check"></i><b>4.2.2</b> Laboratorio</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#propiedades-estadísticas-3"><i class="fa fa-check"></i><b>4.3</b> Propiedades estadísticas</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#prueba-t"><i class="fa fa-check"></i><b>4.3.1</b> Prueba <span class="math inline">\(t\)</span></a></li>
<li class="chapter" data-level="4.3.2" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#prueba-f"><i class="fa fa-check"></i><b>4.3.2</b> Prueba <span class="math inline">\(F\)</span></a></li>
<li class="chapter" data-level="4.3.3" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#laboratorio-2"><i class="fa fa-check"></i><b>4.3.3</b> Laboratorio</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#medida-de-bondad-de-ajuste"><i class="fa fa-check"></i><b>4.4</b> Medida de bondad de ajuste</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#laboratorio-3"><i class="fa fa-check"></i><b>4.4.1</b> Laboratorio</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#predicción"><i class="fa fa-check"></i><b>4.5</b> Predicción</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#laboratorio-4"><i class="fa fa-check"></i><b>4.5.1</b> Laboratorio</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#interacciones"><i class="fa fa-check"></i><b>4.6</b> Interacciones</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#laboratorio-5"><i class="fa fa-check"></i><b>4.6.1</b> Laboratorio</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#supuestos"><i class="fa fa-check"></i><b>4.7</b> Supuestos</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#chequeos-básicos-de-las-hipótesis-de-regresión-lineal"><i class="fa fa-check"></i><b>4.7.1</b> Chequeos básicos de las hipótesis de regresión lineal</a></li>
<li class="chapter" data-level="4.7.2" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#otros-chequeos-importantes"><i class="fa fa-check"></i><b>4.7.2</b> Otros chequeos importantes</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#ejercicios-2"><i class="fa fa-check"></i><b>4.8</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html"><i class="fa fa-check"></i><b>5</b> Regresión Logística</a>
<ul>
<li class="chapter" data-level="5.1" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#preliminares"><i class="fa fa-check"></i><b>5.1</b> Preliminares</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#oportunidad-relativa-odds-ratio"><i class="fa fa-check"></i><b>5.1.1</b> Oportunidad relativa (Odds Ratio)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#máxima-verosimilitud"><i class="fa fa-check"></i><b>5.2</b> Máxima verosimilitud</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#resultados-adicionales"><i class="fa fa-check"></i><b>5.2.1</b> Resultados adicionales</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#diágnosticos-del-modelo"><i class="fa fa-check"></i><b>5.3</b> Diágnosticos del modelo</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#supuesto-de-linealidad"><i class="fa fa-check"></i><b>5.3.1</b> Supuesto de linealidad</a></li>
<li class="chapter" data-level="5.3.2" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#valores-de-gran-influencia"><i class="fa fa-check"></i><b>5.3.2</b> Valores de gran influencia</a></li>
<li class="chapter" data-level="5.3.3" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#multicolinealidad-1"><i class="fa fa-check"></i><b>5.3.3</b> Multicolinealidad</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#predicción-y-poder-de-clasificación"><i class="fa fa-check"></i><b>5.4</b> Predicción y poder de clasificación</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#curva-roc"><i class="fa fa-check"></i><b>5.4.1</b> Curva ROC</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#ejercicios-3"><i class="fa fa-check"></i><b>5.5</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html"><i class="fa fa-check"></i><b>6</b> Métodos de selección de variables y regularización.</a>
<ul>
<li class="chapter" data-level="6.1" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#estimación-del-error-de-prueba"><i class="fa fa-check"></i><b>6.1</b> Estimación del error de prueba</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#técnica-de-conjunto-de-validación"><i class="fa fa-check"></i><b>6.1.1</b> Técnica de conjunto de validación</a></li>
<li class="chapter" data-level="6.1.2" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#validación-cruzada-leave-one-out-loocv"><i class="fa fa-check"></i><b>6.1.2</b> Validación cruzada “Leave-One-Out” (LOOCV)</a></li>
<li class="chapter" data-level="6.1.3" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#validación-cruzada-k-veces"><i class="fa fa-check"></i><b>6.1.3</b> Validación cruzada <span class="math inline">\(k-\)</span>veces</a></li>
<li class="chapter" data-level="6.1.4" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#validación-cruzada-para-clasificación"><i class="fa fa-check"></i><b>6.1.4</b> Validación cruzada para clasificación</a></li>
<li class="chapter" data-level="6.1.5" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#otras-medidas-de-error-de-prueba"><i class="fa fa-check"></i><b>6.1.5</b> Otras medidas de error de prueba</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#selección-de-variables"><i class="fa fa-check"></i><b>6.2</b> Selección de variables</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#selección-del-mejor-subconjunto."><i class="fa fa-check"></i><b>6.2.1</b> Selección del mejor subconjunto.</a></li>
<li class="chapter" data-level="6.2.2" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#selección-de-modelos-hacia-adelante-forward-stepwise-selection"><i class="fa fa-check"></i><b>6.2.2</b> Selección de modelos hacia adelante (<strong>Forward Stepwise Selection</strong>)</a></li>
<li class="chapter" data-level="6.2.3" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#selección-de-modelos-hacia-atrás-backward-stepwise-selection"><i class="fa fa-check"></i><b>6.2.3</b> Selección de modelos hacia atrás (<strong>Backward Stepwise Selection</strong>)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#métodos-de-regularización"><i class="fa fa-check"></i><b>6.3</b> Métodos de regularización</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#regresión-ridge"><i class="fa fa-check"></i><b>6.3.1</b> Regresión Ridge</a></li>
<li class="chapter" data-level="6.3.2" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#regresión-lasso"><i class="fa fa-check"></i><b>6.3.2</b> Regresión Lasso</a></li>
<li class="chapter" data-level="6.3.3" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#explicación-gráfica"><i class="fa fa-check"></i><b>6.3.3</b> Explicación gráfica</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#laboratorio-6"><i class="fa fa-check"></i><b>6.4</b> Laboratorio</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#cross-validation"><i class="fa fa-check"></i><b>6.4.1</b> Cross-Validation</a></li>
<li class="chapter" data-level="6.4.2" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#regresión-lasso-1"><i class="fa fa-check"></i><b>6.4.2</b> Regresión Lasso</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#ejercicios-4"><i class="fa fa-check"></i><b>6.5</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notas Curso de Estadística II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="estimación-no-paramétrica-de-densidades" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Capítulo 2</span> Estimación no-paramétrica de densidades<a href="01-estimacion-densidades-no-parametricas.html#estimación-no-paramétrica-de-densidades" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="histograma" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Histograma<a href="01-estimacion-densidades-no-parametricas.html#histograma" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El histograma es una de las estructuras básicas en estadística y es una herramienta descriptiva que permite visualizar la distribución de los datos sin tener conocimiento previo de los mismos. En esta sección definiremos el histograma más como un estadístico que como una herramienta de visualización de datos.</p>
<div id="construcción-estadística" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Construcción Estadística<a href="01-estimacion-densidades-no-parametricas.html#construcción-estadística" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suponga que <span class="math inline">\(X_1,X_2, \dots ,X_n\)</span> es una muestra independiente que proviene de una distribución desconocida <span class="math inline">\(f\)</span>. En este caso no asumiremos que <span class="math inline">\(f\)</span> tenga alguna forma particular, que permita definirla de manera paramétrica como en el curso anterior.</p>
<p>Construcción:</p>
<ul>
<li><p>Seleccione un origen <span class="math inline">\(x_0\)</span> y divida la linea real en <em>segmentos</em>.
<span class="math display">\[\begin{equation*}
B_j = [x_0 +(j - 1)h,x_0 + jh), \quad j\in \mathbb{Z}
\end{equation*}\]</span></p></li>
<li><p>Cuente cuántas observaciones caen en el segmento <span class="math inline">\(B_j\)</span>. Denótelo como <span class="math inline">\(n_j\)</span>.</p></li>
</ul>
<p><img src="Notas-Curso-Estadistica_files/figure-html/observaciones-histograma-1.svg" width="70%" style="display: block; margin: auto;" />
- Divida el número de observaciones en <span class="math inline">\(B_j\)</span> por el tamaño de muestra <span class="math inline">\(n\)</span> y el ancho de banda <span class="math inline">\(h\)</span> de cada caja.
<span class="math display">\[\begin{equation*}
f_j = \frac{n_j}{nh}
\end{equation*}\]</span>
De esta forma si se suma las áreas definidas por el histograma da un total de 1.</p>
<ul>
<li><p>Cuente la frecuencia por el tamaño de muestra <span class="math inline">\(n\)</span> y el ancho de banda <span class="math inline">\(h\)</span>.
<span class="math display">\[\begin{equation*}
  f_j = \frac{n_j}{nh}
  \end{equation*}\]</span></p></li>
<li><p>Dibuje el histograma.</p></li>
</ul>
<p><img src="Notas-Curso-Estadistica_files/figure-html/ejemplo-inicial-histograma-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<p>Formalmente el histograma es el</p>
<p><span class="math display">\[\begin{equation*}
\hat{f}_h(x) = \frac{1}{nh} \sum_{i = 1}^{n} \sum_{j} I(X_i\in B_j) I(x\in B_j),
\end{equation*}\]</span></p>
<p>donde <span class="math inline">\(I\)</span> es la indicadora.</p>
</div>
<div id="construcción-probabilística" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Construcción probabilística<a href="01-estimacion-densidades-no-parametricas.html#construcción-probabilística" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Denote <span class="math inline">\(m_j=jh-h/2\)</span> el centro del segmento,</p>
<p><span class="math display">\[\begin{align*}
    \mathbb{P}\left(X\in \left[m_j - \frac{h}{2},m_j + \frac{h}{2} \right)\right)
      &amp; =
    \int_{m_j - \frac{h}{2}}^{m_j + \frac{h}{2}} f(u)du                                             \\
      &amp; \approx f(m_j)h
\end{align*}\]</span></p>
<p>Otra forma de aproximarlo es:</p>
<p><span class="math display">\[\begin{equation*}
    \mathbb{P} \left(X\in \left[m_j - \frac{h}{2},m_j + \frac{h}{2}\right) \right)  \approx   \frac{1}{n} \#
    \left\{X\in \left[m_j - \frac{h}{2},m_j + \frac{h}{2}\right) \right\}
\end{equation*}\]</span></p>
<p>Acomodando un poco la expresión</p>
<p><span class="math display">\[\begin{equation*}
\hat{f}_h(m_j) =  \frac{1}{nh} \#
\left\{X\in \left[m_j - \frac{h}{2},m_j + \frac{h}{2}\right) \right\}
\end{equation*}\]</span></p>
</div>
<div id="propiedades-estadísticas" class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Propiedades estadísticas<a href="01-estimacion-densidades-no-parametricas.html#propiedades-estadísticas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Note que el estimador de histograma <span class="math inline">\(\hat f_h\)</span> tiende a ser más suave conforme aumenta el ancho de banda <span class="math inline">\(h\)</span>.</p>
</div>
<div id="propiedades-estadísticas-1" class="section level3 hasAnchor" number="2.1.4">
<h3><span class="header-section-number">2.1.4</span> Propiedades estadísticas<a href="01-estimacion-densidades-no-parametricas.html#propiedades-estadísticas-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suponga que <span class="math inline">\(x_0 = 0\)</span> y que <span class="math inline">\(x \in B_j\)</span> es un punto fijo, entonces el estimador evaluado en <span class="math inline">\(x\)</span> es:</p>
<p><span class="math display">\[\begin{equation*}
\hat{f}_h(x) =  \frac{1}{nh} \sum_{i = 1}^{n} I(X_i \in B_j)
\end{equation*}\]</span></p>
</div>
<div id="sesgo" class="section level3 hasAnchor" number="2.1.5">
<h3><span class="header-section-number">2.1.5</span> Sesgo<a href="01-estimacion-densidades-no-parametricas.html#sesgo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para calcular el sesgo primero calculamos:</p>
<p><span class="math display">\[\begin{align*}
\mathbb{E}\left[ \hat{f}_h(x)\right]
&amp; =  \frac{1}{nh} \sum_{i = 1}^{n} \mathbb{E}\left[ I(X_i \in B_j)\right] \\
&amp; = \frac{1}{nh} n \mathbb{E}\left[ I(X_i \in B_j)\right]
\end{align*}\]</span></p>
<p>donde <span class="math inline">\(I(X_i \in B_j)\)</span> es una variable Bernoulli con valor esperado:</p>
<p><span class="math display">\[\begin{align*}
\mathbb{E}\left[ I(X_i \in B_j)\right] = \mathbb{P}\left(I(X_i \in
B_j)=1\right) = \int_{(j - 1)h}^{jh} f(u)du.
\end{align*}\]</span></p>
<p>Entonces,
<span class="math display">\[\begin{align*}
\mathbb{E}\left[{f}_h(x)\right]
&amp; = \frac{1}{h} \int_{(j - 1)h}^{jh} f(u)du
\end{align*}\]</span></p>
<p>y por lo tanto el sesgo de <span class="math inline">\(\hat f_h(x)\)</span> es:
<span class="math display">\[\begin{equation*}
Sesgo(\hat{f}_h(x)) = \frac{1}{h} \int_{(j -
1)h}^{jh} f(u)du - f(x)
\end{equation*}\]</span></p>
<p>Esto se puede aproximar usando Taylor alrededor del centro
<span class="math inline">\(m_j = jh - h/2\)</span> de <span class="math inline">\(B_j\)</span> de modo que
<span class="math inline">\(f(u) - f(x) \approx f^{\prime}(m_j)(u - x)\)</span>.</p>
<p><span class="math display">\[\begin{equation*}
Sesgo(\hat{f}_h(x)) =  \frac{1}{h} \int_{(j -
1)h}^{jh} [f(u) - f(x)] du \approx f^\prime(m_j)(m_j - x)
\end{equation*}\]</span>
Entonces se puede concluir que:</p>
<ul>
<li><span class="math inline">\(\hat f_h(x)\)</span> es un estimador sesgado de <span class="math inline">\(f(x)\)</span>.</li>
<li>El sesgo tiende a ser cero cerca del punto medio de <span class="math inline">\(B_j\)</span>.</li>
<li>El sesgo es creciente con respecto a la pendiente de la verdadera densidad evaluada en el punto medio <span class="math inline">\(m_j\)</span>.</li>
</ul>
</div>
<div id="varianza" class="section level3 hasAnchor" number="2.1.6">
<h3><span class="header-section-number">2.1.6</span> Varianza<a href="01-estimacion-densidades-no-parametricas.html#varianza" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dado que todos los <span class="math inline">\(X_i\)</span> son i.i.d., entonces</p>
<p><span class="math display">\[\begin{align*}
\mathrm{Var}\left( \hat{f}_h(x)\right) &amp; =
\mathrm{Var}\left( \frac{1}{nh} \sum_{i = 1}^{n} I(X_i \in B_j)\right)                                  \\
&amp; = \frac{1}{n^2h^2} n\mathrm{Var}\left( I(X_i \in B_j)\right)
\end{align*}\]</span></p>
<p>La variable <span class="math inline">\(I\)</span> es una bernoulli con parametro
<span class="math inline">\(\int_{(j - 1)h}^{h} f(u)du\)</span> por lo tanto su varianza es el</p>
<p><span class="math display">\[\begin{equation*}
\mathrm{Var}\left( \hat{f}_h(x)\right)\, =
\frac{1}{nh^2} \left(\int_{(j - 1)h}^{h} f(u)du \right)\left( 1 -\int_{(j - 1)h}^{h} f(u)du \right)
\end{equation*}\]</span></p>
<div class="exercise">
<p><span id="exr:unnamed-chunk-4" class="exercise"><strong>Ejercicio 2.1  </strong></span>Usando un desarrollo de Taylor como en la parte anterior, pruebe que:
<span class="math display">\[\begin{equation*}
\mathrm{Var}\left( \hat{f}_h(x)\right)\approx
\frac{1}{nh} f(x)
\end{equation*}\]</span></p>
</div>
<p>Consecuencias:</p>
<ul>
<li>La varianza del estimador es proporcional a <span class="math inline">\(f(x)\)</span>.</li>
<li>La varianza decrece si el ancho de banda <span class="math inline">\(h\)</span> crece.</li>
</ul>
</div>
<div id="error-cuadrático-medio" class="section level3 hasAnchor" number="2.1.7">
<h3><span class="header-section-number">2.1.7</span> Error cuadrático medio<a href="01-estimacion-densidades-no-parametricas.html#error-cuadrático-medio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El error cuadrático medio del histograma es el</p>
<p><span class="math display">\[\begin{equation*}
\mathrm{MSE}\left( \hat{f}_h(x)\right) =
\mathrm{E}\left[\left(\hat{f}_h(x) - f(x)\right)^2\right] = \mathrm{Sesgo}^2\left( \hat{f}_h(x)\right) + \mathrm{Var}\left( \hat{f}_h(x)\right).
\end{equation*}\]</span></p>
<div class="exercise">
<p><span id="exr:unnamed-chunk-5" class="exercise"><strong>Ejercicio 2.2  </strong></span>¿Pueden probar la segunda igualdad de la expresión anterior?</p>
</div>
<p>Retomando los términos anteriores se puede comprobar que:</p>
<p><span class="math display" id="eq:MSE">\[\begin{align}
\mathrm{MSE}\left( \hat{f}_h(x)\right) = \frac{1}{nh} f(x) +
f^\prime \left\{ \left( j - \frac{1}{2} \right) h \right\}^2 \left\{ \left( j -
\frac{1}{2} \right) h - x \right\}^2 \\
+ o\left(h \right) +        o\left(\frac{1}{nh} \right)
\tag{2.1}
\end{align}\]</span></p>
<div class="remark">
<p><span id="unlabeled-div-1" class="remark"><em>Nota</em>. </span>Si <span class="math inline">\(h \to 0\)</span> y <span class="math inline">\(nh \to \infty\)</span> entonces <span class="math inline">\(\mathrm{MSE}\left( \hat{f}_h(x)\right) \to 0\)</span>. Es decir, conforme usamos más observaciones, pero el ancho de banda de banda no decrece tan rápido, entonces el error cuadrático medio converge a 0.</p>
<p>Como <span class="math inline">\(\mathrm{MSE}\left( \hat{f}_h(x)\right) \to 0\)</span> (convergencia en <span class="math inline">\(\mathbb{L}^2\)</span>) implica que <span class="math inline">\(\hat{f}_h(x) \stackrel{\mathcal{P}}{\to} f(x)\)</span>, entonces <span class="math inline">\(\hat{f}_h\)</span> es consistente. Además según la fórmula <a href="01-estimacion-densidades-no-parametricas.html#eq:MSE">(2.1)</a>, concluimos lo siguiente:</p>
<ul>
<li>Si <span class="math inline">\(h\to 0\)</span>, la varianza crece (converge a <span class="math inline">\(\infty\)</span>) y el sesgo
decrece (converge a <span class="math inline">\(f^\prime (0)x^2\)</span>).</li>
<li>Si <span class="math inline">\(h\to \infty\)</span>, la varianza decrece (hacia 0) y el sesgo crece
(hacia <span class="math inline">\(\infty\)</span>)</li>
</ul>
</div>
<div class="exercise">
<p><span id="exr:unnamed-chunk-8" class="exercise"><strong>Ejercicio 2.3  </strong></span>Si <span class="math inline">\(f\sim N(0,1)\)</span>, aproxime los componentes de sesgo, varianza y MSE, y grafíquelos para distintos valores de <span class="math inline">\(h\)</span>.</p>
</div>
<p>Solución:</p>
<p><img src="Notas-Curso-Estadistica_files/figure-html/MSE-histograma-1.svg" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="error-cuadrático-medio-integrado" class="section level3 hasAnchor" number="2.1.8">
<h3><span class="header-section-number">2.1.8</span> Error cuadrático medio integrado<a href="01-estimacion-densidades-no-parametricas.html#error-cuadrático-medio-integrado" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Uno de los problemas con el <span class="math inline">\(\mathrm{MSE}\left( \hat{f}_h(x)\right)\)</span> es que depende de <span class="math inline">\(x\)</span> y de la función de densidad <span class="math inline">\(f\)</span> (desconocida). Integrando con respecto a <span class="math inline">\(x\)</span> el MSE se logra resolver el primer problema:</p>
<p><span class="math display">\[\begin{align*}
\mathrm{MISE}\left(  \hat{f}_h\right)
&amp; = \mathrm{E}\left[
\int_{ -\infty}^{\infty} \left\{
\hat{f}_h(x) - f(x)
\right\}^2 dx
\right]                                                       \\
&amp; = \int_{ -\infty}^{\infty} \mathrm{E}\left[
\left\{
\hat{f}_h(x) - f(x)
\right\}^2
\right] dx                                                    \\
&amp; = \int_{ -\infty}^{\infty}\mathrm{MSE}(\hat{f}_h(x)) \, dx
\end{align*}\]</span></p>
<p>Al <span class="math inline">\(\mathrm{MISE}\)</span> se le llama error cuadrático medio integrado. Además,</p>
<p><span class="math display">\[\begin{align*}
\mathrm{MISE} (\hat{f}_h)
&amp; \approx \int_{ -\infty}^{\infty} \frac{1}{nh} f(x)dx                                                                                                                                          \\
&amp; + \int_{ -\infty}^{\infty}\, \sum_{j}^{} I(x\in B_j) \left\{ \left( j- \frac{1}{2} \right)h -x  \right\}^2 \left [f^\prime \left( \left\{j - \frac{1}{2}\right\}h \right)  \right]^2 dx \\
&amp; = \frac{1}{nh} + \sum_{j}^{} \left [f^\prime \left( \left\{j - \frac{1}{2}\right\}h \right)  \right]^2 \int_{ B_j}    \left\{ \left( j- \frac{1}{2} \right)h -x  \right\}^2 dx          \\
&amp; =\frac{1}{nh} + \frac{h^2}{12} \sum_{j} \left [f^\prime \left( \left\{j - \frac{1}{2}\right\}h \right)  \right]^2                                                                       \\
&amp; \approx \frac{1}{nh} + \frac{h^2}{12} \int \{f^\prime(x)\}^2 dx                                                                                                                         \\
&amp; =\frac{1}{nh} + \frac{h^2}{12} \Vert f^\prime\Vert_{2}^2
\end{align*}\]</span></p>
<p>la cual es una buena aproximación si <span class="math inline">\(h\rightarrow 0\)</span>. A este último término se le llama MISE asintótico.</p>
</div>
<div id="ancho-de-banda-óptimo-para-el-histograma" class="section level3 hasAnchor" number="2.1.9">
<h3><span class="header-section-number">2.1.9</span> Ancho de banda óptimo para el histograma<a href="01-estimacion-densidades-no-parametricas.html#ancho-de-banda-óptimo-para-el-histograma" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El MISE tiene un comportamiento asintótico similar al observado en el MSE. La figura siguiente presenta el comportamiento de la varianza, sesgo y MISE para nuestro ejemplo anterior:</p>
<div class="figure" style="text-align: center">
<img src="Notas-Curso-Estadistica_files/figure-html/MISE-histograma-1.svg" alt=" " width="70%" />
<p class="caption">
</p>
</div>
<p>Un problema frecuente en los histogramas es que la mala elección del parámetro <span class="math inline">\(h\)</span> causa que estos no capturen toda la estructura de los datos. Por ejemplo, en el siguiente caso se muestra histogramas construídos a partir de 1000 números aleatorios según una <span class="math inline">\(N(0,1)\)</span>, bajo 4 distintas escogencias de ancho de banda.</p>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-10-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<p>Un criterio más preciso para seleccionar el ancho de banda es a través de la minimización del MISE:</p>
<p><span class="math display">\[\begin{equation*}
\frac{\partial \mathrm{MISE}(f_{h})}{\partial h} = -\frac{1}{nh^2} + \frac{1}{6} h \Vert f^\prime\Vert_{2}^2 = 0
\end{equation*}\]</span></p>
<p>lo implica que</p>
<p><span class="math display">\[\begin{equation*}
h_{opt} = \left(\frac{6}{n\Vert f^\prime\Vert_{2}^2}\right) ^{1/3} = O\left( n^{-1/3} \right).
\end{equation*}\]</span></p>
<p>y por lo tanto</p>
<p><span class="math display">\[\begin{equation*}
\mathrm{MISE}(\hat{f}_{h}) = \frac{1}{n} \left(\frac{n\Vert f^\prime\Vert_{2}^2}{6}\right)  ^{1/3}
\end{equation*}\]</span></p>
<div class="remark">
<p><span id="unlabeled-div-2" class="remark"><em>Nota</em> (Recuerde de Estad&lt;U+00ED&gt;stica I). </span>Si <span class="math inline">\(X_1, \ldots, X_n \sim f_{\theta}\)</span> i.i.d, con <span class="math inline">\(\mathrm{Var}(X) = \sigma^2\)</span> y media <span class="math inline">\(\theta\)</span>, recuerde que el estimador <span class="math inline">\(\hat{\theta}\)</span> de <span class="math inline">\(\theta\)</span> tiene la característica que</p>
<p><span class="math display">\[\begin{equation*}
\mathrm{MSE}(\theta) = \mathrm{Var}(\hat{\theta}) +
\mathrm{Sesgo}^2(\hat{\theta}) = \frac{\sigma^2}{n}
\end{equation*}\]</span></p>
</div>
<p>Según la nota anterior la tasas de convergencia del histograma es más lenta que la de un estimador parámetrico considerando la misma cantidad de datos, tal y como se ilustra en el siguiente gráfico:</p>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-12-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<p>Finalmente, podemos encontrar el valor óptimo del ancho de banda (<span class="math inline">\(h=\)</span> 0.2805) del conjunto de datos en el ejemplo anterior.<br />
<img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-14-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="exercise">
<p><span id="exr:unnamed-chunk-15" class="exercise"><strong>Ejercicio 2.4  </strong></span>Verifique que en el caso normal estándar: <span class="math inline">\(h_{opt}\approx 3.5 n^{-1/3}\)</span>.</p>
</div>
</div>
</div>
<div id="estimación-de-densidades-basada-en-kernels." class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Estimación de densidades basada en kernels.<a href="01-estimacion-densidades-no-parametricas.html#estimación-de-densidades-basada-en-kernels." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="primera-construcción" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Primera construcción<a href="01-estimacion-densidades-no-parametricas.html#primera-construcción" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sea <span class="math inline">\(X_{1},\ldots,X_{n}\)</span> variables aleatorias i.i.d. con distribución <span class="math inline">\(f\)</span> en <span class="math inline">\(\mathbb{R}\)</span>. La distribución de <span class="math inline">\(f\)</span> es <span class="math inline">\(F(x)=\int_{-\infty}^{x}f(t)dt\)</span>.</p>
<p>La distribución empírica de <span class="math inline">\(F\)</span> es:
<span class="math display">\[
F_{n}(x)=\frac{1}{n}\sum_{i=1}^{n}I(X_{i}\leq x).
\]</span></p>
<p>Por la ley de los grandes números tenemos que <span class="math inline">\(F_{n}(x) \xrightarrow{c.s} F(x)\)</span> para todo <span class="math inline">\(x\)</span> en <span class="math inline">\(\mathbb{R}\)</span>, conforme
<span class="math inline">\(n\rightarrow\infty\)</span>. Entonces, <span class="math inline">\(F_{n}(x)\)</span> es un estimador consistente de <span class="math inline">\(F(x)\)</span> para todo <span class="math inline">\(x\)</span> in <span class="math inline">\(\mathbb{R}\)</span>.</p>
<div class="remark">
<p><span id="unlabeled-div-3" class="remark"><em>Nota</em>. </span>¿Podríamos derivar <span class="math inline">\(F_n\)</span> para encontrar el estimador <span class="math inline">\(\hat{f}_n\)</span>?</p>
</div>
<p>La respuesta es si (más o menos).</p>
<p>Suponga que <span class="math inline">\(h&gt;0\)</span> tenemos la aproximación
<span class="math display">\[
f(x)\approx\frac{F(x+h)-F(x-h)}{2h}.
\]</span></p>
<p>Remplazando <span class="math inline">\(F\)</span> por su estimador <span class="math inline">\(F_{n}\)</span>, defina
<span class="math display">\[
\hat{f}_{n}^{R}(x)=\frac{F_{n}(x+h)-F_{n}(x-h)}{2h},
\]</span>
donde <span class="math inline">\(\hat{f}_{n}^{R}(x)\)</span> es el estimador de <em>Rosenblatt</em> .</p>
<p>Podemos rescribirlo de la forma,
<span class="math display">\[
\hat{f}_{n}^{R}(x)=\frac{1}{2nh}\sum_{i=1}^{n}I(x-h&lt;X_{i}\leq x+h)=\frac{1}{nh}\sum_{i=1}^{n}K_{0}\left(\frac{X_{i}-x}{h}\right)
\]</span>
con <span class="math inline">\(K_{0}(u)=\frac{1}{2}I(-1&lt;u\leq1)\)</span>, lo cual es equivalente al caso del histograma.</p>
</div>
<div id="otra-construcción" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Otra construcción<a href="01-estimacion-densidades-no-parametricas.html#otra-construcción" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Con el histograma construimos una serie de segmentos fijo <span class="math inline">\(B_{j}\)</span> y contabamos el número de datos que estaban <strong>contenidos en <span class="math inline">\(B_{j}\)</span></strong></p>
<div class="remark">
<p><span id="unlabeled-div-4" class="remark"><em>Nota</em>. </span>¿Qué pasaría si cambiamos la palabra <strong>contenidos</strong> por <strong>alrededor de “x”</strong>?</p>
</div>
<p>Suponga que se tienen intervalos de longitud <span class="math inline">\(2h\)</span>, es decir, intervalos de la forma <span class="math inline">\([x-h,x+h)\)</span>.</p>
<p>El estimador de histograma se escribe como</p>
<p><span class="math display">\[\begin{equation*}
\hat{f_{h}}(x) = \dfrac{1}{2hn} \# \{ X_i \in [x-h,x+h) \}.
\end{equation*}\]</span></p>
<p>Note que si definimos
<span class="math display">\[\begin{equation*}
K(u)=\frac{1}{2} I \left( \left\vert u \right\vert \leq 1 \right)
\end{equation*}\]</span>
con <span class="math inline">\(u = \frac{x-x_i}{h}\)</span>, entonces parte del estimador de histograma se puede escribir como:
<span class="math display">\[\begin{equation*}
\frac{1}{2}\# \{ X_i \in [x-h,x+h) \}
=\sum_{i=1}^{n} K\left( \frac{x-x_{i}}{h} \right)
=\sum_{i=1}^{n}  \frac{1}{2} I \left( \left\vert \frac{x-x_{i}}{h}
\right\vert \leq 1 \right)
\end{equation*}\]</span></p>
<p>Finalmente se tendría que</p>
<p><span class="math display">\[\begin{equation*}
\hat{f}_{h}\left( x \right) = \frac{1}{nh}\sum_{i=1}^{n} K\left( \frac{x-x_{i}}{h} \right)
\end{equation*}\]</span></p>
<!-- \begin{center} -->
<!-- \includegraphics[width=\linewidth]{manual_figure/np-density-interval-crop.pdf} -->
<!-- \end{center} -->
<div class="remark">
<p><span id="unlabeled-div-5" class="remark"><em>Nota</em>. </span>¿Qué pasaría si cambiaríamos la función <span class="math inline">\(K\)</span> del histograma por una más general? Esto permitiría incluir la noción de “cercanía” de cada dato alrededor de <span class="math inline">\(x\)</span>.</p>
</div>
<p>Esta función debería cumplir las siguientes características:</p>
<ul>
<li><span class="math inline">\(K(u)\geq 0\)</span>.</li>
<li><span class="math inline">\(\int_{-\infty}^{\infty} K(u)du = 1\)</span>.</li>
<li><span class="math inline">\(\int_{-\infty}^{\infty} u K(u)du = 0\)</span>.</li>
<li><span class="math inline">\(\int_{-\infty}^{\infty} u^{2} K(u)du &lt;\infty\)</span>.</li>
</ul>
<p>Por ejemplo:</p>
<ul>
<li><strong>Uniforme:</strong> <span class="math inline">\(\frac{1}{2} I \left( \left\vert u \right\vert \leq 1 \right)\)</span>.</li>
<li><strong>Triangular:</strong> <span class="math inline">\((1-|u|) I \left( \left\vert u \right\vert \leq 1 \right)\)</span>.</li>
<li><strong>Epanechnikov:</strong> <span class="math inline">\(\frac{3}{4} (1-u^{2}) I \left( \left\vert u \right\vert \leq 1 \right)\)</span>.</li>
<li><strong>Gaussian:</strong> <span class="math inline">\(\frac{1}{\sqrt{2\pi}} \exp \left( -\frac{1}{2}u^{2} \right)\)</span>.</li>
</ul>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-19-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<p>Entonces se tendría que la expresión general para un estimador por núcleos (kernel) de <span class="math inline">\(f\)</span>:</p>
<p><span class="math display">\[\begin{equation*}
\hat{f}_{h}\left( x \right) = \frac{1}{nh}\sum_{i=1}^{n} K\left( \frac{x-x_{i}}{h} \right)=\frac{1}{n}\sum_{i=1}^{n} K_h(x-x_{i})
\end{equation*}\]</span></p>
<p>donde <span class="math inline">\(x_1,\ldots,x_n\)</span> es una muestra i.i.d. de <span class="math inline">\(f\)</span>,
<span class="math display">\[\begin{align*}
K_h(\cdot)=\frac 1 h K(\cdot /h).
\end{align*}\]</span>
y <span class="math inline">\(K\)</span> es un kernel según las 4 propiedades anteriores.</p>
<div class="remark">
<p><span id="unlabeled-div-6" class="remark"><em>Nota</em>. </span>¿Qué pasaría si modificamos el ancho de banda <span class="math inline">\(h\)</span> para un mismo kernel?</p>
</div>
<p>Nuevamente controlaríamos la suavidad del estimador a como se ilustra a continuación:</p>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-21-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<p>Inconveniente: no tenemos aún un criterio para un <span class="math inline">\(h\)</span> óptimo.</p>
<div class="remark">
<p><span id="unlabeled-div-7" class="remark"><em>Nota</em>. </span>¿Qué pasaría si modificamos el kernel para un mismo ancho de banda <span class="math inline">\(h\)</span>?</p>
</div>
<p>Usando 1000 números aleatorios según una normal estándar, con un ancho de banda fijo (<span class="math inline">\(h=0.3\)</span>) podemos ver que no hay diferencias muy marcadas entre los estimadores por kernel:
<img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-23-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<p>Recordemos nuevamente la fórmula</p>
<p><span class="math display">\[\begin{equation*}
\hat{f}_{h}\left( x \right) = \frac{1}{nh}\sum_{i=1}^{n} K\left( \frac{x-X_{i}}{h} \right)
\end{equation*}\]</span></p>
<p>Cada sumando de esta expresión es una función de la variable <span class="math inline">\(x\)</span>. Si la integramos se obtiene que</p>
<p><span class="math display">\[\begin{equation*}
\frac{1}{nh}\int K\left( \frac{x-X_{i}}{h} \right) dx
= \frac{1}{nh} \int K\left( u \right) h du
= \frac{1}{n} \int K(u) du
= \frac{1}{n}
\end{equation*}\]</span></p>
<p>En el siguiente gráfico se generan 10 puntos aleatorios según una normal estándar (rojo) y se grafica cada uno de los 10 componentes del estimador de la densidad usando kernels gaussianos (azul). El estimador resultante aparece en color negro. Note que cada uno de los 10 componentes tiene la misma área bajo la curva, la cual en este caso es 0.1.
<img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-24-1.svg" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="propiedades-estadísticas-2" class="section level3 hasAnchor" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Propiedades Estadísticas<a href="01-estimacion-densidades-no-parametricas.html#propiedades-estadísticas-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Al igual que en el caso de histograma, también aplica lo siguiente:</p>
<p><span class="math display">\[\begin{align*}
\mathrm{MSE}(\hat{f}_{h}(x)) &amp; =\mathrm{Var}(\hat{f}_{h}(x))+\mathrm{Sesgo}^{2} (\hat{f}_{h}(x))            \\
\mathrm{MISE}(\hat{f}_{h})   &amp; =\int\mathrm{Var}(\hat{f}_{h}(x))dx+\int\mathrm{Sesgo}^{2}(\hat{f}_{h}(x))dx
\end{align*}\]</span></p>
<p>donde</p>
<p><span class="math inline">\(\mathrm{Var}\left(\hat{f}_{h}(x)\right)=\mathbb{E}\left[\hat{f}_{h}(x)-\mathbb{E}\hat{f}_{h}(x)\right]^{2}\)</span> and <span class="math inline">\(\mathrm{Sesgo}\left(\hat{f}_{h}(x)\right)=\mathbb{E}\left[\hat{f}_{h}(x)\right]-f(x)\)</span>.</p>
<p>En el caso de la varianza:</p>
<p><span class="math display">\[\begin{align*}
\mathrm{Var}(\hat{f}_{h}(x))
&amp; =\mathrm{Var}\left(\frac{1}{n}\sum_{i=1}^{n}K\left(\frac{x-X_{i}}{h}\right)\right)          \\
&amp; =\frac{1}{n^{2}h^{2}}\sum_{i=1}^{n}\mathrm{Var}\left(K\left(\frac{x-X_{i}}{h}\right)\right) \\
&amp; =\frac{1}{nh^{2}}\mathrm{Var}\left(K\left(\frac{x-X}{h}\right)\right)                       \\
&amp; =\frac{1}{nh^{2}}\left\{
\textcolor{red}{\mathbb{E}\left[K^{2}\left(\frac{x-X}{h}\right)\right]}
-\left\{
\textcolor{blue}{\mathbb{E}\left[K\left(\frac{x-X}{h}\right)\right]}
\right\}^{2}
\right\}.
\end{align*}\]</span> Usando que: <span class="math display">\[\begin{align*}
\textcolor{red}{\mathbb{E}\left[K^{2}\left(\frac{x-X}{h}\right)\right]}
&amp; =\int K^{2}\left(\frac{x-s}{h}\right)f(s)ds            \\
&amp; =h\int K^{2}\left(u\right)f(uh+x)du                    \\
&amp; =h\int K^{2}\left(u\right)\left\{ f(x)+o(1)\right\} du \\
&amp; =h\left\{ \Vert K\Vert_{2}^{2}f(x)+o(1)\right\} .
\end{align*}\]</span></p>
<p><span class="math display">\[\begin{align*}
\textcolor{blue}{\mathbb{E}\left[K\left(\frac{x-X}{h}\right)\right]}
&amp; =\int K\left(\frac{x-s}{h}\right)f(s)ds            \\
&amp; = h\int K\left(u\right)f(uh+x)du                    \\
&amp; =h\int K\left(u\right)\left\{ f(x)+o(1)\right\} du \\
&amp; =h\left\{f(x)+o(1)\right\} .
\end{align*}\]</span></p>
<p>Por lo tanto se obtiene que</p>
<p><span class="math display">\[\begin{equation*}
\mathrm{Var}\left(\hat{f}_{h}(x)\right) = \frac{1}{nh} \Vert K\Vert_{2}^{2}f(x) + o\left(\frac{1}{nh}\right), \text{ si } nh\to \infty.
\end{equation*}\]</span></p>
</div>
<div id="sesgo-1" class="section level3 hasAnchor" number="2.2.4">
<h3><span class="header-section-number">2.2.4</span> Sesgo<a href="01-estimacion-densidades-no-parametricas.html#sesgo-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para el sesgo tenemos</p>
<p><span class="math display">\[\begin{align*}
\mathrm{Sesgo}\left(\hat{f}_{h}(x)\right)
&amp; = \mathbb{E}\left[\hat{f}_{h}(x)\right]-f(x)                                                  \\
&amp; = \frac{1}{nh} \sum_{i=1}^{n} \mathrm{E}\left[K\left( \frac{x-X_{i}}{h} \right)\right] - f(x) \\
&amp; = \frac{1}{h}\mathrm{E}\left[K\left( \frac{x-X_{1}}{h} \right)\right] - f(x)                  \\
&amp; = \int \frac{1}{h} K\left( \frac{x-u}{h}\right)f(u)du -f(x)                                   \\
\end{align*}\]</span></p>
<div class="exercise">
<p><span id="exr:unnamed-chunk-25" class="exercise"><strong>Ejercicio 2.5  </strong></span>Usando el cambio de variable <span class="math inline">\(s=\frac{u-x}{h}\)</span> y las propiedades del kernel pruebe que</p>
<p><span class="math display">\[\begin{equation*}
\mathrm{Sesgo}\left(\hat{f}_{h}(x)\right) = \frac{h^{2}}{2} f^{\prime\prime} \mu_{2}(K) + o(h^{2}), \text{ si } h\to 0
\end{equation*}\]</span>
donde <span class="math inline">\(\mu_{2}=\int s^{2}K(s)ds\)</span>.</p>
</div>
<div class="remark">
<p><span id="unlabeled-div-8" class="remark"><em>Nota</em>. </span>En algunas pruebas más formales, se necesita además que <span class="math inline">\(f^{\prime\prime}\)</span> sea absolutamente continua y que <span class="math inline">\(\int(f^{\prime\prime\prime}(x))dx&lt;\infty\)</span>.}</p>
</div>
<p>En el siguiente gráfico se ilustra el estimador no paramétrico de la distribución de tiempos entre erupciones en la muy conocida tabla de datos <em>faithful</em>. El estimador se calcula bajo dos distintas escogencias de ancho de banda.</p>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-28-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="remark">
<p><span id="unlabeled-div-9" class="remark"><em>Nota</em>. </span>Note como los cambios en el ancho de banda modifican la suavidad (sesgo) y el aplanamiento de la curva (varianza).</p>
</div>
</div>
<div id="error-cuadrático-medio-y-error-cuadrático-medio-integrado" class="section level3 hasAnchor" number="2.2.5">
<h3><span class="header-section-number">2.2.5</span> Error cuadrático medio y Error cuadrático medio integrado<a href="01-estimacion-densidades-no-parametricas.html#error-cuadrático-medio-y-error-cuadrático-medio-integrado" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El error cuadrático medio se escribe</p>
<p><span class="math display">\[\begin{align*}
\mathrm{MSE}(\hat{f}_{h}(x))
&amp; = \mathrm{Sesgo}\left(\hat{f}_{h}(x)\right)^{2} + \mathrm{Var}\left(\hat{f}_{h}(x)\right)                                                 \\
&amp; = \frac{h^{4}}{4}\left(\mu_{2}(K)f^{\prime\prime}(x)\right)^{2}+\frac{1}{nh}\Vert K\Vert_{2}^{2}f(x)+o(h^{4})+o\left(\frac{1}{nh}\right).
\end{align*}\]</span></p>
<p>Y el error cuadrático medio integrado se escribe como,</p>
<p><span class="math display">\[\begin{align*}
\mathrm{MISE}\left(\hat{f}_{h}\right) &amp; = \int \mathrm{MSE}\left(\hat{f}_{h}(x)\right)dx                                                                                                        \\
&amp; = \int \mathrm{Sesgo}\left(\hat{f}_{h}(x)\right)^{2} + \mathrm{Var}\left(\hat{f}_{h}(x)\right)dx                                                        \\
&amp; = \frac{h^{4}}{4}\mu_{2}^{2}(K)\left\Vert f^{\prime\prime}(x)\right\Vert_{2}^{2} +\frac{1}{nh}\Vert K\Vert_{2}^{2}+o(h^{4})+o\left(\frac{1}{nh}\right).
\end{align*}\]</span></p>
<p>Al igual que en el caso del histograma, el estimador por kernels es un estimador consistente de <span class="math inline">\(f\)</span> si <span class="math inline">\(h\rightarrow 0\)</span> y <span class="math inline">\(nh\rightarrow \infty\)</span>. Además el MISE depende directamente de <span class="math inline">\(f&#39;&#39;\)</span>.</p>
</div>
<div id="ancho-de-banda-óptimo" class="section level3 hasAnchor" number="2.2.6">
<h3><span class="header-section-number">2.2.6</span> Ancho de banda óptimo<a href="01-estimacion-densidades-no-parametricas.html#ancho-de-banda-óptimo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Minimizando el <span class="math inline">\(\mathrm{MISE}\)</span> con respecto a <span class="math inline">\(h\)</span> obtenemos</p>
<p><span class="math display">\[\begin{equation*}
h_{opt}=\left(\frac{\Vert K\Vert_{2}^{2}}{\Vert f^{\prime\prime}\Vert_{2}^{2}\left(\mu_{2}(K)\right)^{2}n}\right)^{1/5}=O\left( n^{-1/5} \right).
\end{equation*}\]</span></p>
<div class="remark">
<p><span id="unlabeled-div-10" class="remark"><em>Nota</em>. </span>De forma práctica, <span class="math inline">\(h_{opt}\)</span> no es un estimador útil de <span class="math inline">\(h\)</span> porque depende de <span class="math inline">\(\Vert f^{\prime\prime}\Vert_{2}^{2}\)</span> que es desconocido. Más adelante veremos otra forma de encontrar este estimador.</p>
</div>
<p>Evaluando <span class="math inline">\(h_{opt}\)</span> en el <span class="math inline">\(\mathrm{MISE}\)</span> tenemos que</p>
<p><span class="math display">\[\begin{equation*}
\mathrm{MISE}(\hat{f}_{h})=\frac{5}{4}\left(\Vert K\Vert_{2}^{2}\right)^{4/5}\left(\Vert f^{\prime\prime}\Vert_{2}^{2}\mu_{2}(K)\right)^{2/5}n^{-4/5} = O\left( n^{-4/5} \right).
\end{equation*}\]</span></p>
<p>y por lo tanto la tasa de convergencia del MISE a 0 es más rápida que para el caso del histograma:</p>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-31-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="remark">
<p><span id="unlabeled-div-11" class="remark"><em>Nota</em>. </span>Como se comentó anteriormente, el principal inconveniente del ancho de banda:
<span class="math display">\[\begin{equation*}
h_{opt}=\left(\frac{\Vert K\Vert_{2}^{2}}{\Vert f^{\prime\prime}\Vert_{2}^{2}\left(\mu_{2}(K)\right)^{2}n}\right)^{1/5}=O\left( n^{-1/5} \right).
\end{equation*}\]</span>
es que depende de <span class="math inline">\(f&#39;&#39;\)</span>.</p>
</div>
<p>A continuación se explica dos posibles métodos para determinar para aproximar el ancho de banda óptimo:</p>
<div id="referencia-normal" class="section level4 hasAnchor" number="2.2.6.1">
<h4><span class="header-section-number">2.2.6.1</span> Referencia normal<a href="01-estimacion-densidades-no-parametricas.html#referencia-normal" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="remark">
<p><span id="unlabeled-div-12" class="remark"><em>Nota</em>. </span>Este método es más efectivo si se conoce que la verdadera distribución es bastante suave, unimodal y simétrica. Más adelante veremos otro método para densidades más generales.</p>
</div>
<p>Asuma que <span class="math inline">\(f\)</span> es normal distribuida y se utiliza un kernel <span class="math inline">\(K\)</span> gausiano.
Entonces se tiene que</p>
<p><span class="math display">\[\begin{align*}
\hat{h}_{rn} &amp; =\left(\frac{\Vert K\Vert_{2}^{2}}{\Vert f^{\prime\prime}\Vert_{2}^{2}\left(\mu_{2}(K)\right)^{2}n}\right)^{1/5}=O\left( n^{-1/5} \right) \\
&amp; =1.06 \hat{\sigma} n^{-1/5}.
\end{align*}\]</span></p>
<p>donde</p>
<p><span class="math display">\[\begin{equation*}
\hat{\sigma} = \sqrt{\frac{1}{n-1} \sum_{i=1}^{n} \left( x_{i}-\bar{x}^{2} \right)}
\end{equation*}\]</span></p>
<div class="exercise">
<p><span id="exr:unnamed-chunk-35" class="exercise"><strong>Ejercicio 2.6  </strong></span>Pruebe que la ecuación anterior es verdadera. Utilice el hecho de que:
<span class="math display">\[\begin{align*}
\Vert f^{\prime\prime}\Vert_{2}^{2}=\sigma^{-5}\int \phi^{\prime \prime}(x)^2 dx
\end{align*}\]</span>
donde <span class="math inline">\(\phi\)</span> es la función de densidad de una <span class="math inline">\(N(0,1)\)</span>.</p>
</div>
<div class="remark">
<p><span id="unlabeled-div-13" class="remark"><em>Nota</em>. </span>El principal inconveniente de <span class="math inline">\(\hat{h}_{rn}\)</span> es su sensibilidad a los valores extremos:</p>
</div>
<div class="example">
<p><span id="exm:unnamed-chunk-37" class="example"><strong>Ejemplo 2.1  </strong></span>La varianza empírica de 1, 2, 3, 4, 5, es 2.5.</p>
<p>La varianza empírica de 1, 2, 3, 4, 5, 99, es 1538.</p>
</div>
<p>Para solucionar el problema anterior, se puede considerar una medida más robusta de variación, por ejemplo el rango intercuantil IQR:</p>
<p><span class="math display">\[\begin{equation*}
\mathrm{IQR}^{X} = Q^{X}_{3} - Q^{X}_{1}
\end{equation*}\]</span>
donde <span class="math inline">\(Q^{X}_{1}\)</span> y <span class="math inline">\(Q^{X}_{3}\)</span> son el primer y tercer cuartil de un conjunto de datos <span class="math inline">\(X_{1},\ldots, X_n\)</span>.</p>
<p>Con el supuesto que <span class="math inline">\(X\sim \mathcal{N}(\mu,\sigma^{2})\)</span> entonces <span class="math inline">\(\displaystyle Z = \frac{X-\mu}{\sigma} \sim \mathcal{N}(0,1)\)</span> y entonces:</p>
<p><span class="math display">\[\begin{align*}
\mathrm{IQR}
&amp; = Q^{X}_{3} - Q^{X}_{1}                                                     \\
&amp; = \left( \mu+\sigma Q^{Z}_{3} \right) - \left( \mu+\sigma Q^{Z}_{1} \right) \\
&amp; = \sigma \left(Q^{Z}_{3} - Q^{Z}_{1} \right)                                \\
&amp; \approx \sigma \left( 0.67 - (-0.67) \right)                                 \\
&amp; =1.34 \sigma.
\end{align*}\]</span></p>
<p>Por lo tanto
<span class="math inline">\(\displaystyle \hat{\sigma} = \frac{\widehat{\mathrm{IQR}}^{X}}{1.34}\)</span></p>
<p>Podemos sustituir la varianza empírica de la fórmula inicial y tenemos
<span class="math display">\[\begin{equation*}
\hat{h}_{rn} = 1.06 \frac{\widehat{\mathrm{IQR}}^{X}}{1.34} n^{-\frac{1}{5}} \approx 0.79\  \widehat{\mathrm{IQR}}^{X}\ n^{-\frac{1}{5}}
\end{equation*}\]</span></p>
<p>Combinando ambos estimadores, podemos obtener,</p>
<p><span class="math display">\[\begin{equation*}
\hat{h}_{rn} = 1.06 \min \left\{\frac{\widehat{\mathrm{IQR}}^{X}}{1.34}, \hat{\sigma }\right\} n^{-\frac{1}{5}}
\end{equation*}\]</span></p>
<p>pero esta aproximación es conveniente bajo el escenario de que la densidad <span class="math inline">\(f\)</span> sea similar a una densidad normal.</p>
</div>
<div id="validación-cruzada" class="section level4 hasAnchor" number="2.2.6.2">
<h4><span class="header-section-number">2.2.6.2</span> Validación Cruzada<a href="01-estimacion-densidades-no-parametricas.html#validación-cruzada" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Defina el <em>error cuadrático integrado</em> como <span class="math display">\[\begin{align*}
\mathrm{ISE}(\hat{f}_{h}) &amp; =\int\left(\hat{f}_{h}(x)-f(x)\right)^{2}dx\nonumber                   \\
&amp; =\int \hat{f}_{h}^{2}(x)dx-2\int \hat{f}_{h}(x)f(x)dx+\int f^{2}(x)dx.
\end{align*}\]</span></p>
<div class="remark">
<p><span id="unlabeled-div-14" class="remark"><em>Nota</em>. </span>El MISE es el valor esperado del ISE.</p>
</div>
<p>Nuestro objetivo es minimizar el ISE con respecto a <span class="math inline">\(h\)</span>.</p>
<p>Primero note que <span class="math inline">\(\int f^{2}(x)dx\)</span> NO DEPENDE de <span class="math inline">\(h\)</span>. Podemos minimizar
la expresión <span class="math display">\[\begin{equation*}
\mathrm{ISE}(\hat{f}_{h})-\int f^{2}(x)dx=
\textcolor{red}{\int\hat{f}_{h}^{2}(x)dx}
-2
\textcolor{blue}{\int\hat{f}_{h}(x)f(x)dx}
\end{equation*}\]</span></p>
<p>Vamos a resolver esto en dos pasos partes</p>
<p><strong>Integral</strong> <span class="math inline">\(\textcolor{blue}{\int\hat{f}_{h}(x)f(x)dx}\)</span></p>
<p><strong>Integral <span class="math inline">\(\textcolor{blue}{\int\hat{f}_{h}(x)f(x)dx}\)</span></strong></p>
<p>El término <span class="math inline">\(\textcolor{blue}{\int\hat{f}_{h}(x)f(x)dx}\)</span> es el valor esperado de
<span class="math inline">\(\mathrm{E}\left[\hat{f}_h(X)\right]\)</span>. Su estimador empírico sería:
<span class="math display">\[\begin{equation*}
\widehat{\mathrm{E}\left[\hat{f}_h(X)\right]}
= \frac{1}{n}\sum_{i=1}^{n}\hat{f}_{h}(X_{i})
=\frac{1}{n^{2}h}\sum_{i=1}^{n}\sum_{j=1}^{n}
K\left(\frac{X_{j}-X_{i}}{h}\right).
\end{equation*}\]</span></p>
<div class="remark">
<p><span id="unlabeled-div-15" class="remark"><em>Nota</em>. </span>El problema con esta expresión es que las observaciones que se usan para estimar la esperanza son las mismas que se usan para estimar <span class="math inline">\(\hat{f}_{h}(x)\)</span> (Se utilizan doble).</p>
</div>
<p>La solución es remover la <span class="math inline">\(i^{\text{ésima}}\)</span> observación de
<span class="math inline">\(\hat{f}_{h}\)</span> para cada <span class="math inline">\(i\)</span>.</p>
<p>Redefiniendo el estimador anterior tenemos una estimación de <span class="math inline">\(\int \hat{f}_{h}(x)f(x)dx\)</span> a través de:
<span class="math display">\[
\frac{1}{n}\sum_{i=1}^{n}\hat{f}_{h,-i}(X_{i}),
\]</span>
donde (estimador <em>leave-one-out</em>)
<span class="math display">\[
\hat{f}_{h,-i}(x)=\frac{1}{(n-1)h}\sum_{\substack{j=1\\ j\neq i}}^{n}K\left( \frac{x-X_{j}}{h} \right) .
\]</span></p>
<p>de esta forma nos aseguramos que las observaciones que se usan para calcular <span class="math inline">\(\hat{f}_{h,-i}(x)\)</span> son independientes de la observación que uno usa para definir el estimador de <span class="math inline">\(E[\hat f_h(x)]\)</span>.</p>
<p>Siguiendo con el término <span class="math inline">\(\textcolor{red}{\int\hat{f}_{h}^{2}(x)dx}\)</span>
note que este se puede reescribir como</p>
<p><span class="math display">\[\begin{align*}
\textcolor{red}{\int\hat{f}_{h}^{2}(x)dx}
&amp; =\int\left(\frac{1}{nh}\sum_{i=1}^{n}K\left( \frac{x-X_{i}}{h} \right)\right)^{2}dx                                    \\
&amp; =\frac{1}{n^{2}h^{2}}\sum_{i=1}^{n}\sum_{i=1}^{n}\int K\left(\frac{x-X_{i}}{h}\right)K\left(\frac{x-X_{j}}{h}\right)dx \\
&amp; =\frac{1}{n^{2}h}\sum_{i=1}^{n}\sum_{i=1}^{n}\int K\left(u\right)K\left(\frac{X_{i}-X_{j}}{h}-u\right)du               \\
&amp; =\frac{1}{n^{2}h}\sum_{i=1}^{n}\sum_{i=1}^{n}K*K\left(\frac{X_{i}-X_{j}}{h}\right).
\end{align*}\]</span></p>
<p>donde <span class="math inline">\(K*K\)</span> es la convolución de <span class="math inline">\(K\)</span> consigo misma.</p>
<p>Finalmente tenemos la función,</p>
<p>Finalmente definimos la función objetivo del criterio de validación cruzada como:</p>
<p><span class="math display">\[
\mathrm{CV}(h)=\frac{1}{n^{2}h}\sum_{i=1}^{n}\sum_{j=1}^{n}K*K\left(\frac{X_{i}-X_{j}}{h}\right)-\frac{2}{n(n-1)h}\sum_{i=1}^{n}\mathop{\sum_{j=1}^{n}}_{j\neq i}K\left( \frac{X_{i}-X_{j}}{h} \right).
\]</span></p>
<div class="remark">
<p><span id="unlabeled-div-16" class="remark"><em>Nota</em>. </span>Note que <span class="math inline">\(\mathrm{CV}(h)\)</span> no depende de <span class="math inline">\(f\)</span> o sus derivadas y además la función objetivo se adapta automáticamente a las características de la densidad <span class="math inline">\(f\)</span>.</p>
</div>
</div>
</div>
<div id="intervalos-de-confianza-para-estimadores-de-densidad-no-paramétricos" class="section level3 hasAnchor" number="2.2.7">
<h3><span class="header-section-number">2.2.7</span> Intervalos de confianza para estimadores de densidad no paramétricos<a href="01-estimacion-densidades-no-parametricas.html#intervalos-de-confianza-para-estimadores-de-densidad-no-paramétricos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Usando los resultados anteriores y asumiendo que <span class="math inline">\(h=cn^{-\frac{1}{5}}\)</span>
entonces</p>
<p><span class="math display">\[\begin{equation*}
n^{\frac{2}{5}} \left\{ \hat{f}_{h}(x) -f(x)\right\}
\xrightarrow{\mathcal{L}} \mathcal{N}\left(\underbrace{\frac{c^{2}}{2} f^{\prime\prime}
\mu_{2}(K)}_{b_{x}}, \underbrace{\frac{1}{c}f(x) \left\Vert K \right\Vert_{2}^{2}}_{v_{x}}\right).
\end{equation*}\]</span></p>
<p>Si <span class="math inline">\(z_{1-\frac{\alpha}{2}}\)</span> es el cuantil <span class="math inline">\(1-\frac{\alpha}{2}\)</span> de una
distribución normal estándar, entonces</p>
<p><span class="math display">\[\begin{align*}
1-\alpha
&amp; \approx \mathbb{P}\left(b_{x}-z_{1-\frac{\alpha}{2}} v_{x} \leq n^{2 / 5}\left\{\widehat{f}_{h}(x)-f(x)\right\} \leq b_{x}+z_{1-\frac{\alpha}{2}} v_{x}\right) \\
&amp; =\mathbb{P}\left(\widehat{f}_{h}(x)-n^{-2 / 5}\left\{b_{x}+z_{1-\frac{\alpha}{2}} v_{x}\right\}\right.                                                         \\
&amp; \qquad\qquad \left. \leq f(x)\leq \hat{f}_{h}(x)-n^{-2 / 5}\left\{b_{x}-z_{1-\frac{\alpha}{2}} v_{x}\right\}\right)
\end{align*}\]</span></p>
<p>Esta expresión nos dice que con una probabilidad de <span class="math inline">\(1-\alpha\)</span> se tiene
que</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
&amp; \left[\hat{f}_{h}(x)-\frac{h^{2}}{2} f^{\prime \prime}(x) \mu_{2}(K)-z_{1-\frac{\alpha}{2}} \sqrt{\frac{f(x)\|K\|_{2}^{2}}{n h}}\right. \\
&amp; \left.\widehat{f}_{h}(x)-\frac{h^{2}}{2} f^{\prime \prime}(x) \mu_{2}(K)+z_{1-\frac{a}{2}} \sqrt{\frac{f(x)\|K\|_{2}^{2}}{n h}}\right]
\end{aligned}
\end{equation*}\]</span></p>
<p>Al igual que en los casos anteriores, este invtervalo no es útil ya que
depende de <span class="math inline">\(f(x)\)</span> y <span class="math inline">\(f^{\prime\prime} (x)\)</span>.</p>
<p>Si <span class="math inline">\(h\)</span> es pequeño relativamente a <span class="math inline">\(n^{-\frac{1}{5}}\)</span> entonces el segundo
término <span class="math inline">\(\frac{h^{2}}{2} f^{\prime \prime}(x) \mu_{2}(K)\)</span> podría ser
ignorado.</p>
<p>Si <span class="math inline">\(h\)</span> es pequeño relativamente a <span class="math inline">\(n^{-\frac{1}{5}}\)</span> entonces el segundo término <span class="math inline">\(\frac{h^{2}}{2} f^{\prime \prime}(x) \mu_{2}(K)\)</span> podría ser ignorado.</p>
<p>Podemos reemplazar <span class="math inline">\(f(x)\)</span> por su estimador <span class="math inline">\(\hat{f}_{h}(x)\)</span>. Entonces tendríamos una intervalo aplicable a nuestro caso:</p>
<p><span class="math display">\[\begin{equation*}
\left[\hat{f_{h}}(x)-z_{1-\frac{\alpha}{2}} \sqrt{\frac{\hat{f_{h}}(x)\|K\|_{2}^{2}}{n h}}, \hat{f}_{h}(x)+z_{1-\frac{\alpha}{2}} \sqrt{\frac{\hat{f}_{h}(x)\|\mathrm{K}\|_{2}^{2}}{n h}}\right]
\end{equation*}\]</span></p>
<div class="remark">
<p><span id="unlabeled-div-17" class="remark"><em>Nota</em>. </span>Este intervalo de confianza está definido para <span class="math inline">\(x\)</span> fijo y no permite hacer inferencia sobre toda la función <span class="math inline">\(f\)</span>. Una forma de determinar la banda de confianza de toda la función <span class="math inline">\(f\)</span> es a través de la fórmula 3.52 en la página 62 de <span class="citation">(Härdle et al. 2004)</span>.</p>
</div>
</div>
</div>
<div id="laboratorio" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Laboratorio<a href="01-estimacion-densidades-no-parametricas.html#laboratorio" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Comenzaremos con una librería bastante básica llamada
.</p>
<div id="efecto-de-distintos-kernels-en-la-estimación" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Efecto de distintos Kernels en la estimación<a href="01-estimacion-densidades-no-parametricas.html#efecto-de-distintos-kernels-en-la-estimación" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="01-estimacion-densidades-no-parametricas.html#cb1-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/stockres.txt&quot;</span>)</span>
<span id="cb1-2"><a href="01-estimacion-densidades-no-parametricas.html#cb1-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">unlist</span>(x)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="01-estimacion-densidades-no-parametricas.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(x)</span></code></pre></div>
<pre><code>##       Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
## -0.6118200 -0.0204085 -0.0010632 -0.0004988  0.0215999  0.1432286</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="01-estimacion-densidades-no-parametricas.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(KernSmooth)</span>
<span id="cb4-2"><a href="01-estimacion-densidades-no-parametricas.html#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="01-estimacion-densidades-no-parametricas.html#cb4-3" aria-hidden="true" tabindex="-1"></a>fhat_normal <span class="ot">&lt;-</span> <span class="fu">bkde</span>(x, <span class="at">kernel =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">bandwidth =</span> <span class="fl">0.05</span>)</span>
<span id="cb4-4"><a href="01-estimacion-densidades-no-parametricas.html#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fhat_normal, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-45-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="01-estimacion-densidades-no-parametricas.html#cb5-1" aria-hidden="true" tabindex="-1"></a>fhat_unif <span class="ot">&lt;-</span> <span class="fu">bkde</span>(x, <span class="at">kernel =</span> <span class="st">&quot;box&quot;</span>, <span class="at">bandwidth =</span> <span class="fl">0.05</span>)</span>
<span id="cb5-2"><a href="01-estimacion-densidades-no-parametricas.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fhat_unif, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-45-2.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="01-estimacion-densidades-no-parametricas.html#cb6-1" aria-hidden="true" tabindex="-1"></a>fhat_epanech <span class="ot">&lt;-</span> <span class="fu">bkde</span>(x, <span class="at">kernel =</span> <span class="st">&quot;epanech&quot;</span>, <span class="at">bandwidth =</span> <span class="fl">0.05</span>)</span>
<span id="cb6-2"><a href="01-estimacion-densidades-no-parametricas.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fhat_epanech, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-45-3.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="01-estimacion-densidades-no-parametricas.html#cb7-1" aria-hidden="true" tabindex="-1"></a>fhat_biweight <span class="ot">&lt;-</span> <span class="fu">bkde</span>(x, <span class="at">kernel =</span> <span class="st">&quot;biweight&quot;</span>, <span class="at">bandwidth =</span> <span class="fl">0.05</span>)</span>
<span id="cb7-2"><a href="01-estimacion-densidades-no-parametricas.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fhat_biweight, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-45-4.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="01-estimacion-densidades-no-parametricas.html#cb8-1" aria-hidden="true" tabindex="-1"></a>fhat_triweight <span class="ot">&lt;-</span> <span class="fu">bkde</span>(x, <span class="at">kernel =</span> <span class="st">&quot;triweight&quot;</span>, <span class="at">bandwidth =</span> <span class="fl">0.05</span>)</span>
<span id="cb8-2"><a href="01-estimacion-densidades-no-parametricas.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fhat_triweight, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-45-5.svg" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="efecto-del-ancho-de-banda-en-la-estimación" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Efecto del ancho de banda en la estimación<a href="01-estimacion-densidades-no-parametricas.html#efecto-del-ancho-de-banda-en-la-estimación" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>** Kernel uniforme **</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="01-estimacion-densidades-no-parametricas.html#cb9-1" aria-hidden="true" tabindex="-1"></a>fhat <span class="ot">&lt;-</span> <span class="fu">bkde</span>(x, <span class="at">kernel =</span> <span class="st">&quot;box&quot;</span>, <span class="at">bandwidth =</span> <span class="fl">0.001</span>)</span>
<span id="cb9-2"><a href="01-estimacion-densidades-no-parametricas.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fhat, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-46-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="01-estimacion-densidades-no-parametricas.html#cb10-1" aria-hidden="true" tabindex="-1"></a>fhat <span class="ot">&lt;-</span> <span class="fu">bkde</span>(x, <span class="at">kernel =</span> <span class="st">&quot;box&quot;</span>, <span class="at">bandwidth =</span> <span class="fl">0.5</span>)</span>
<span id="cb10-2"><a href="01-estimacion-densidades-no-parametricas.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fhat, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-46-2.svg" width="70%" style="display: block; margin: auto;" /></p>
<p>** Kernel Epanechnikov **</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="01-estimacion-densidades-no-parametricas.html#cb11-1" aria-hidden="true" tabindex="-1"></a>fhat <span class="ot">&lt;-</span> <span class="fu">bkde</span>(x, <span class="at">kernel =</span> <span class="st">&quot;epa&quot;</span>, <span class="at">bandwidth =</span> <span class="fl">0.001</span>)</span>
<span id="cb11-2"><a href="01-estimacion-densidades-no-parametricas.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fhat, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-47-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="01-estimacion-densidades-no-parametricas.html#cb12-1" aria-hidden="true" tabindex="-1"></a>fhat <span class="ot">&lt;-</span> <span class="fu">bkde</span>(x, <span class="at">kernel =</span> <span class="st">&quot;epa&quot;</span>, <span class="at">bandwidth =</span> <span class="fl">0.5</span>)</span>
<span id="cb12-2"><a href="01-estimacion-densidades-no-parametricas.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fhat, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-47-2.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="01-estimacion-densidades-no-parametricas.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(tidyverse))</span>
<span id="cb13-2"><a href="01-estimacion-densidades-no-parametricas.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb13-3"><a href="01-estimacion-densidades-no-parametricas.html#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="01-estimacion-densidades-no-parametricas.html#cb13-4" aria-hidden="true" tabindex="-1"></a>fani <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb13-5"><a href="01-estimacion-densidades-no-parametricas.html#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="01-estimacion-densidades-no-parametricas.html#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="fu">seq</span>(<span class="fl">0.001</span>, <span class="fl">0.02</span>, <span class="at">length.out =</span> <span class="dv">40</span>)) {</span>
<span id="cb13-7"><a href="01-estimacion-densidades-no-parametricas.html#cb13-7" aria-hidden="true" tabindex="-1"></a>    f <span class="ot">&lt;-</span> <span class="fu">bkde</span>(x, <span class="at">kernel =</span> <span class="st">&quot;epa&quot;</span>, <span class="at">bandwidth =</span> b, <span class="at">gridsize =</span> <span class="fu">length</span>(x))</span>
<span id="cb13-8"><a href="01-estimacion-densidades-no-parametricas.html#cb13-8" aria-hidden="true" tabindex="-1"></a>    fani <span class="ot">&lt;-</span> fani <span class="sc">%&gt;%</span></span>
<span id="cb13-9"><a href="01-estimacion-densidades-no-parametricas.html#cb13-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">bind_rows</span>(<span class="fu">tibble</span>(<span class="at">xreal =</span> <span class="fu">sort</span>(x), <span class="at">x =</span> f<span class="sc">$</span>x,</span>
<span id="cb13-10"><a href="01-estimacion-densidades-no-parametricas.html#cb13-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> f<span class="sc">$</span>y, <span class="at">bw =</span> b))</span>
<span id="cb13-11"><a href="01-estimacion-densidades-no-parametricas.html#cb13-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-12"><a href="01-estimacion-densidades-no-parametricas.html#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="01-estimacion-densidades-no-parametricas.html#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fani) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, y), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-14"><a href="01-estimacion-densidades-no-parametricas.html#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;Ancho de banda = {closest_state}&quot;</span>)) <span class="sc">+</span></span>
<span id="cb13-15"><a href="01-estimacion-densidades-no-parametricas.html#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transition_states</span>(bw) <span class="sc">+</span> <span class="fu">view_follow</span>() <span class="sc">+</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="01-estimacion-densidades-no-parametricas.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># anim_save(&#39;manual_figure/bandwidth-animation.gif&#39;)</span></span></code></pre></div>
<!-- \includemedia[ -->
<!-- label=bandwidth, -->
<!-- width=0.6\linewidth,height=0.45\linewidth, -->
<!-- addresource=manual_figure/bandwidth-animation.mp4, -->
<!-- transparent, -->
<!-- %transparent player background -->
<!-- activate=pageopen, -->
<!-- %show VPlayer's right-click menu -->
<!-- flashvars={ -->
<!-- source=manual_figure/bandwidth-animation.mp4 -->
<!-- &loop=true -->
<!-- % loop video -->
<!-- } -->
<!-- ]{}{VPlayer.swf} -->
<div class="remark">
<ul>
<li><span id="unlabeled-div-18" class="remark"><em>Nota</em>. </span></li>
<li>Construya una variable llamada <code>u</code> que sea una secuencia de -0.15 a 0.15 con un paso de 0.01</li>
<li>Asigne <code>x</code> a los datos <code>stockrel</code> y calcule su media y varianza.</li>
<li>Usando la función <code>dnorm</code> construya los valores de la distribución de los datos usando la media y varianza calculada anteriormente. Asigne a esta variable <code>f\_param</code>.</li>
<li>Defina un ancho de banda <code>h</code> en 0.02</li>
<li>Construya un histograma para estos datos con ancho de banda <code>h</code>. Llame a esta variable <code>f\_hist</code></li>
<li>Usando el paquete <code>KernSmooth</code> y la función <code>bkde</code>, construya una función que calcule el estimador no paramétrico con un núcleo Epanechivok para un ancho de banda <span class="math inline">\(h\)</span>. Llame a esta variable <code>f\_epa</code>.</li>
<li>Dibuje en el mismo gráfico la estimación paramétrica y no paramétrica.</li>
</ul>
</div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="01-estimacion-densidades-no-parametricas.html#cb16-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/stockres.txt&quot;</span>)</span>
<span id="cb16-2"><a href="01-estimacion-densidades-no-parametricas.html#cb16-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">unlist</span>(x)</span>
<span id="cb16-3"><a href="01-estimacion-densidades-no-parametricas.html#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Eliminar nombres de las columnas</span></span>
<span id="cb16-4"><a href="01-estimacion-densidades-no-parametricas.html#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(x) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb16-5"><a href="01-estimacion-densidades-no-parametricas.html#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="01-estimacion-densidades-no-parametricas.html#cb16-6" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.15</span>, <span class="fl">0.15</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb16-7"><a href="01-estimacion-densidades-no-parametricas.html#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="01-estimacion-densidades-no-parametricas.html#cb16-8" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb16-9"><a href="01-estimacion-densidades-no-parametricas.html#cb16-9" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb16-10"><a href="01-estimacion-densidades-no-parametricas.html#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="01-estimacion-densidades-no-parametricas.html#cb16-11" aria-hidden="true" tabindex="-1"></a>f_param <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(u, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)</span>
<span id="cb16-12"><a href="01-estimacion-densidades-no-parametricas.html#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="01-estimacion-densidades-no-parametricas.html#cb16-13" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fl">0.02</span></span>
<span id="cb16-14"><a href="01-estimacion-densidades-no-parametricas.html#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="01-estimacion-densidades-no-parametricas.html#cb16-15" aria-hidden="true" tabindex="-1"></a>n_bins <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fu">diff</span>(<span class="fu">range</span>(x))<span class="sc">/</span>h)</span>
<span id="cb16-16"><a href="01-estimacion-densidades-no-parametricas.html#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="01-estimacion-densidades-no-parametricas.html#cb16-17" aria-hidden="true" tabindex="-1"></a>f_hist <span class="ot">&lt;-</span> <span class="fu">hist</span>(x, <span class="at">breaks =</span> n_bins)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-50-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="01-estimacion-densidades-no-parametricas.html#cb17-1" aria-hidden="true" tabindex="-1"></a>f_epa <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">bkde</span>(x, <span class="at">kernel =</span> <span class="st">&quot;epa&quot;</span>, <span class="at">bandwidth =</span> h))</span>
<span id="cb17-2"><a href="01-estimacion-densidades-no-parametricas.html#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="01-estimacion-densidades-no-parametricas.html#cb17-3" aria-hidden="true" tabindex="-1"></a>x_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x)</span>
<span id="cb17-4"><a href="01-estimacion-densidades-no-parametricas.html#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="01-estimacion-densidades-no-parametricas.html#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb17-6"><a href="01-estimacion-densidades-no-parametricas.html#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="01-estimacion-densidades-no-parametricas.html#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(x_df, <span class="fu">aes</span>(x)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..),</span>
<span id="cb17-8"><a href="01-estimacion-densidades-no-parametricas.html#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth =</span> <span class="fl">0.02</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-9"><a href="01-estimacion-densidades-no-parametricas.html#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu,</span>
<span id="cb17-10"><a href="01-estimacion-densidades-no-parametricas.html#cb17-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">sd =</span> sigma), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> f_epa,</span>
<span id="cb17-11"><a href="01-estimacion-densidades-no-parametricas.html#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(x, y), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-50-2.svg" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="ancho-de-banda-óptimo-1" class="section level3 hasAnchor" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Ancho de banda óptimo<a href="01-estimacion-densidades-no-parametricas.html#ancho-de-banda-óptimo-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Usemos la regla de la normal o también conocida como Silverman.
<strong>Primero recuerde que en este caso se asume que</strong> <span class="math inline">\(f(x)\)</span> sigue una
distribución normal. En este caso, lo que se obtiene es que</p>
<p><span class="math display">\[\begin{align*}
\Vert f^{\prime \prime} \Vert_2^2 &amp; = \sigma ^{-5} \int \{\phi^{\prime \prime}\}^2 dx              \\
&amp; = \sigma ^{-5} \frac{3}{8\sqrt{\pi}} \approx 0.212 \sigma^{-5}
\end{align*}\]</span></p>
<p>donde <span class="math inline">\(\phi\)</span> es la densidad de una normal estándar.</p>
<p>El estimador para <span class="math inline">\(\sigma\)</span> es</p>
<p><span class="math display">\[
s = \sqrt{\frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})^2  }.
\]</span></p>
<p>Y usando el cálculo realizado anteriormente, se obtiene que</p>
<p><span class="math display">\[
h_{normal} = \left( \frac{4 s^5}{3n} \right)^{1/5} \approx 1.06 s n^{-1/5}.
\]</span></p>
<p>Un estimador más robusto es</p>
<p><span class="math display">\[
h_{normal} =  1.06 \min \left\{ s , \frac{IQR}{1.34} \right\} n^{-1/5}.
\]</span></p>
<p>¿Por qué es <span class="math inline">\(IQR / 1.34\)</span>?</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="01-estimacion-densidades-no-parametricas.html#cb18-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb18-2"><a href="01-estimacion-densidades-no-parametricas.html#cb18-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="01-estimacion-densidades-no-parametricas.html#cb19-1" aria-hidden="true" tabindex="-1"></a>h_normal <span class="ot">&lt;-</span> <span class="fl">1.06</span> <span class="sc">*</span> s <span class="sc">*</span> n<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb19-2"><a href="01-estimacion-densidades-no-parametricas.html#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="01-estimacion-densidades-no-parametricas.html#cb19-3" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> h_normal</span>
<span id="cb19-4"><a href="01-estimacion-densidades-no-parametricas.html#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="01-estimacion-densidades-no-parametricas.html#cb19-5" aria-hidden="true" tabindex="-1"></a>n_bins <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fu">diff</span>(<span class="fu">range</span>(x))<span class="sc">/</span>h)</span>
<span id="cb19-6"><a href="01-estimacion-densidades-no-parametricas.html#cb19-6" aria-hidden="true" tabindex="-1"></a>f_hist <span class="ot">&lt;-</span> <span class="fu">hist</span>(x, <span class="at">breaks =</span> n_bins, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-7"><a href="01-estimacion-densidades-no-parametricas.html#cb19-7" aria-hidden="true" tabindex="-1"></a>f_epa <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">bkde</span>(x, <span class="at">kernel =</span> <span class="st">&quot;epa&quot;</span>, <span class="at">bandwidth =</span> h))</span>
<span id="cb19-8"><a href="01-estimacion-densidades-no-parametricas.html#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="01-estimacion-densidades-no-parametricas.html#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(x_df, <span class="fu">aes</span>(x)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..),</span>
<span id="cb19-10"><a href="01-estimacion-densidades-no-parametricas.html#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth =</span> h, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-11"><a href="01-estimacion-densidades-no-parametricas.html#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu,</span>
<span id="cb19-12"><a href="01-estimacion-densidades-no-parametricas.html#cb19-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">sd =</span> sigma), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> f_epa,</span>
<span id="cb19-13"><a href="01-estimacion-densidades-no-parametricas.html#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(x, y), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-52-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="01-estimacion-densidades-no-parametricas.html#cb20-1" aria-hidden="true" tabindex="-1"></a>h_iqr <span class="ot">&lt;-</span> <span class="fl">1.06</span> <span class="sc">*</span> <span class="fu">min</span>(s, <span class="fu">IQR</span>(x)<span class="sc">/</span><span class="fl">1.34</span>) <span class="sc">*</span> n<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb20-2"><a href="01-estimacion-densidades-no-parametricas.html#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="01-estimacion-densidades-no-parametricas.html#cb20-3" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> h_iqr</span>
<span id="cb20-4"><a href="01-estimacion-densidades-no-parametricas.html#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="01-estimacion-densidades-no-parametricas.html#cb20-5" aria-hidden="true" tabindex="-1"></a>n_bins <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fu">diff</span>(<span class="fu">range</span>(x))<span class="sc">/</span>h)</span>
<span id="cb20-6"><a href="01-estimacion-densidades-no-parametricas.html#cb20-6" aria-hidden="true" tabindex="-1"></a>f_hist <span class="ot">&lt;-</span> <span class="fu">hist</span>(x, <span class="at">breaks =</span> n_bins, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb20-7"><a href="01-estimacion-densidades-no-parametricas.html#cb20-7" aria-hidden="true" tabindex="-1"></a>f_epa <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">bkde</span>(x, <span class="at">kernel =</span> <span class="st">&quot;epa&quot;</span>, <span class="at">bandwidth =</span> h))</span>
<span id="cb20-8"><a href="01-estimacion-densidades-no-parametricas.html#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="01-estimacion-densidades-no-parametricas.html#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(x_df, <span class="fu">aes</span>(x)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..),</span>
<span id="cb20-10"><a href="01-estimacion-densidades-no-parametricas.html#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth =</span> h, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-11"><a href="01-estimacion-densidades-no-parametricas.html#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu,</span>
<span id="cb20-12"><a href="01-estimacion-densidades-no-parametricas.html#cb20-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">sd =</span> sigma), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> f_epa,</span>
<span id="cb20-13"><a href="01-estimacion-densidades-no-parametricas.html#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(x, y), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-53-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<p>Una librería más especializada es (non-parametric).</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="01-estimacion-densidades-no-parametricas.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(np)</span>
<span id="cb21-2"><a href="01-estimacion-densidades-no-parametricas.html#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="01-estimacion-densidades-no-parametricas.html#cb21-3" aria-hidden="true" tabindex="-1"></a>x.eval <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="at">length.out =</span> <span class="dv">200</span>)</span>
<span id="cb21-4"><a href="01-estimacion-densidades-no-parametricas.html#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="01-estimacion-densidades-no-parametricas.html#cb21-5" aria-hidden="true" tabindex="-1"></a>h_normal_np <span class="ot">&lt;-</span> <span class="fu">npudensbw</span>(<span class="at">dat =</span> x, <span class="at">bwmethod =</span> <span class="st">&quot;normal-reference&quot;</span>)</span>
<span id="cb21-6"><a href="01-estimacion-densidades-no-parametricas.html#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="01-estimacion-densidades-no-parametricas.html#cb21-7" aria-hidden="true" tabindex="-1"></a>dens.ksum <span class="ot">&lt;-</span> <span class="fu">npksum</span>(<span class="at">txdat =</span> x, <span class="at">exdat =</span> x.eval, <span class="at">bws =</span> h_normal_np<span class="sc">$</span>bw)<span class="sc">$</span>ksum<span class="sc">/</span>(n <span class="sc">*</span></span>
<span id="cb21-8"><a href="01-estimacion-densidades-no-parametricas.html#cb21-8" aria-hidden="true" tabindex="-1"></a>    h_normal_np<span class="sc">$</span>bw[<span class="dv">1</span>])</span>
<span id="cb21-9"><a href="01-estimacion-densidades-no-parametricas.html#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="01-estimacion-densidades-no-parametricas.html#cb21-10" aria-hidden="true" tabindex="-1"></a>dens.ksum.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x.eval, <span class="at">y =</span> dens.ksum)</span>
<span id="cb21-11"><a href="01-estimacion-densidades-no-parametricas.html#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="01-estimacion-densidades-no-parametricas.html#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(x_df, <span class="fu">aes</span>(x)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..),</span>
<span id="cb21-13"><a href="01-estimacion-densidades-no-parametricas.html#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth =</span> h_normal_np<span class="sc">$</span>bw, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb21-14"><a href="01-estimacion-densidades-no-parametricas.html#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu,</span>
<span id="cb21-15"><a href="01-estimacion-densidades-no-parametricas.html#cb21-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">sd =</span> sigma), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> dens.ksum.df,</span>
<span id="cb21-16"><a href="01-estimacion-densidades-no-parametricas.html#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(x, y), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-54-1.svg" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="validación-cruzada-1" class="section level3 hasAnchor" number="2.3.4">
<h3><span class="header-section-number">2.3.4</span> Validación cruzada<a href="01-estimacion-densidades-no-parametricas.html#validación-cruzada-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La forma que vimos en clase es la de validación cruzada por mínimos
cuadrados``least-square cross validation’’ la cual se puede ejecutar
con este comando.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="01-estimacion-densidades-no-parametricas.html#cb22-1" aria-hidden="true" tabindex="-1"></a>h_cv_np_ls <span class="ot">&lt;-</span> <span class="fu">npudensbw</span>(<span class="at">dat =</span> x, <span class="at">bwmethod =</span> <span class="st">&quot;cv.ls&quot;</span>,</span>
<span id="cb22-2"><a href="01-estimacion-densidades-no-parametricas.html#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ckertype =</span> <span class="st">&quot;epa&quot;</span>, <span class="at">ckerorder =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## 
Multistart 1 of 1 |
Multistart 1 of 1 |
Multistart 1 of 1 |
Multistart 1 of 1 /
Multistart 1 of 1 |
Multistart 1 of 1 |
                   </code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="01-estimacion-densidades-no-parametricas.html#cb24-1" aria-hidden="true" tabindex="-1"></a>dens.np <span class="ot">&lt;-</span> <span class="fu">npudens</span>(h_cv_np_ls)</span>
<span id="cb24-2"><a href="01-estimacion-densidades-no-parametricas.html#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="01-estimacion-densidades-no-parametricas.html#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dens.np, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-55-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="01-estimacion-densidades-no-parametricas.html#cb25-1" aria-hidden="true" tabindex="-1"></a>dens.np.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> dens.np<span class="sc">$</span>eval[, <span class="dv">1</span>], <span class="at">y =</span> dens.np<span class="sc">$</span>dens)</span>
<span id="cb25-2"><a href="01-estimacion-densidades-no-parametricas.html#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="01-estimacion-densidades-no-parametricas.html#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(x_df, <span class="fu">aes</span>(x)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..),</span>
<span id="cb25-4"><a href="01-estimacion-densidades-no-parametricas.html#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth =</span> h_cv_np_ls<span class="sc">$</span>bw, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="01-estimacion-densidades-no-parametricas.html#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu,</span>
<span id="cb25-6"><a href="01-estimacion-densidades-no-parametricas.html#cb25-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">sd =</span> sigma), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> dens.np.df,</span>
<span id="cb25-7"><a href="01-estimacion-densidades-no-parametricas.html#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(x, y), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-56-1.svg" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="temas-adicionales" class="section level3 hasAnchor" number="2.3.5">
<h3><span class="header-section-number">2.3.5</span> Temas adicionales<a href="01-estimacion-densidades-no-parametricas.html#temas-adicionales" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>** Reducción del sesgo ** Como lo mencionamos en el texto, una forma
de mejorar el sesgo en la estimación es suponer que la función de
densidad es más veces diferenciable.</p>
<p>Esto se logra asumiendo que el Kernel es más veces diferenciable.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="01-estimacion-densidades-no-parametricas.html#cb26-1" aria-hidden="true" tabindex="-1"></a>h_cv_np_ls <span class="ot">&lt;-</span> <span class="fu">npudensbw</span>(<span class="at">dat =</span> x, <span class="at">bwmethod =</span> <span class="st">&quot;cv.ls&quot;</span>,</span>
<span id="cb26-2"><a href="01-estimacion-densidades-no-parametricas.html#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ckertype =</span> <span class="st">&quot;epa&quot;</span>, <span class="at">ckerorder =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## 
Multistart 1 of 1 |
Multistart 1 of 1 |
Multistart 1 of 1 |
Multistart 1 of 1 /
Multistart 1 of 1 |
Multistart 1 of 1 |
                   </code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="01-estimacion-densidades-no-parametricas.html#cb28-1" aria-hidden="true" tabindex="-1"></a>dens.np <span class="ot">&lt;-</span> <span class="fu">npudens</span>(h_cv_np_ls)</span>
<span id="cb28-2"><a href="01-estimacion-densidades-no-parametricas.html#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="01-estimacion-densidades-no-parametricas.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dens.np, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-57-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="01-estimacion-densidades-no-parametricas.html#cb29-1" aria-hidden="true" tabindex="-1"></a>dens.np.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> dens.np<span class="sc">$</span>eval[, <span class="dv">1</span>], <span class="at">y =</span> dens.np<span class="sc">$</span>dens)</span>
<span id="cb29-2"><a href="01-estimacion-densidades-no-parametricas.html#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="01-estimacion-densidades-no-parametricas.html#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(x_df, <span class="fu">aes</span>(x)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..),</span>
<span id="cb29-4"><a href="01-estimacion-densidades-no-parametricas.html#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth =</span> h_cv_np_ls<span class="sc">$</span>bw, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb29-5"><a href="01-estimacion-densidades-no-parametricas.html#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu,</span>
<span id="cb29-6"><a href="01-estimacion-densidades-no-parametricas.html#cb29-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">sd =</span> sigma), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> dens.np.df,</span>
<span id="cb29-7"><a href="01-estimacion-densidades-no-parametricas.html#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(x, y), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-58-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<p><strong>Otra forma de estimar el ancho de banda</strong> Otra forma de estimar ancho
de bandas óptimos es usando máxima verosimilitud. Les dejo de tarea
revisar la sección 1.1 del artículo de <span class="citation">(Hall 1987)</span> para entender su
estructura.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="01-estimacion-densidades-no-parametricas.html#cb30-1" aria-hidden="true" tabindex="-1"></a>h_cv_np_ml <span class="ot">&lt;-</span> <span class="fu">npudensbw</span>(<span class="at">dat =</span> x, <span class="at">bwmethod =</span> <span class="st">&quot;cv.ml&quot;</span>,</span>
<span id="cb30-2"><a href="01-estimacion-densidades-no-parametricas.html#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ckertype =</span> <span class="st">&quot;epanechnikov&quot;</span>)</span></code></pre></div>
<pre><code>## 
Multistart 1 of 1 |
Multistart 1 of 1 |
Multistart 1 of 1 |
Multistart 1 of 1 /
Multistart 1 of 1 |
Multistart 1 of 1 |
                   </code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="01-estimacion-densidades-no-parametricas.html#cb32-1" aria-hidden="true" tabindex="-1"></a>dens.np <span class="ot">&lt;-</span> <span class="fu">npudens</span>(h_cv_np_ml)</span>
<span id="cb32-2"><a href="01-estimacion-densidades-no-parametricas.html#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="01-estimacion-densidades-no-parametricas.html#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dens.np, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-59-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="01-estimacion-densidades-no-parametricas.html#cb33-1" aria-hidden="true" tabindex="-1"></a>dens.np.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> dens.np<span class="sc">$</span>eval[, <span class="dv">1</span>], <span class="at">y =</span> dens.np<span class="sc">$</span>dens)</span>
<span id="cb33-2"><a href="01-estimacion-densidades-no-parametricas.html#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="01-estimacion-densidades-no-parametricas.html#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(x_df, <span class="fu">aes</span>(x)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..),</span>
<span id="cb33-4"><a href="01-estimacion-densidades-no-parametricas.html#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth =</span> h_cv_np_ml<span class="sc">$</span>bw, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb33-5"><a href="01-estimacion-densidades-no-parametricas.html#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu,</span>
<span id="cb33-6"><a href="01-estimacion-densidades-no-parametricas.html#cb33-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">sd =</span> sigma), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> dens.np.df,</span>
<span id="cb33-7"><a href="01-estimacion-densidades-no-parametricas.html#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(x, y), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-60-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="01-estimacion-densidades-no-parametricas.html#cb34-1" aria-hidden="true" tabindex="-1"></a>h_cv_np_ml <span class="ot">&lt;-</span> <span class="fu">npudensbw</span>(<span class="at">dat =</span> x, <span class="at">bwmethod =</span> <span class="st">&quot;cv.ml&quot;</span>,</span>
<span id="cb34-2"><a href="01-estimacion-densidades-no-parametricas.html#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ckertype =</span> <span class="st">&quot;epanechnikov&quot;</span>, <span class="at">ckerorder =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## 
Multistart 1 of 1 |
Multistart 1 of 1 |
Multistart 1 of 1 |
Multistart 1 of 1 /
Multistart 1 of 1 |
Multistart 1 of 1 |
                   </code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="01-estimacion-densidades-no-parametricas.html#cb36-1" aria-hidden="true" tabindex="-1"></a>dens.np <span class="ot">&lt;-</span> <span class="fu">npudens</span>(h_cv_np_ml)</span>
<span id="cb36-2"><a href="01-estimacion-densidades-no-parametricas.html#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="01-estimacion-densidades-no-parametricas.html#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dens.np, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-61-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="01-estimacion-densidades-no-parametricas.html#cb37-1" aria-hidden="true" tabindex="-1"></a>dens.np.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> dens.np<span class="sc">$</span>eval[, <span class="dv">1</span>], <span class="at">y =</span> dens.np<span class="sc">$</span>dens)</span>
<span id="cb37-2"><a href="01-estimacion-densidades-no-parametricas.html#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="01-estimacion-densidades-no-parametricas.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(x_df, <span class="fu">aes</span>(x)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..),</span>
<span id="cb37-4"><a href="01-estimacion-densidades-no-parametricas.html#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth =</span> h_cv_np_ml<span class="sc">$</span>bw, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-5"><a href="01-estimacion-densidades-no-parametricas.html#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu,</span>
<span id="cb37-6"><a href="01-estimacion-densidades-no-parametricas.html#cb37-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">sd =</span> sigma), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> dens.np.df,</span>
<span id="cb37-7"><a href="01-estimacion-densidades-no-parametricas.html#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(x, y), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-62-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="01-estimacion-densidades-no-parametricas.html#cb38-1" aria-hidden="true" tabindex="-1"></a>fani <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb38-2"><a href="01-estimacion-densidades-no-parametricas.html#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="01-estimacion-densidades-no-parametricas.html#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="fu">seq</span>(<span class="fl">0.001</span>, <span class="fl">0.05</span>, <span class="at">length.out =</span> <span class="dv">40</span>)) {</span>
<span id="cb38-4"><a href="01-estimacion-densidades-no-parametricas.html#cb38-4" aria-hidden="true" tabindex="-1"></a>    f <span class="ot">&lt;-</span> <span class="fu">npudens</span>(<span class="at">tdat =</span> x, <span class="at">ckertype =</span> <span class="st">&quot;epanechnikov&quot;</span>,</span>
<span id="cb38-5"><a href="01-estimacion-densidades-no-parametricas.html#cb38-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">bandwidth.compute =</span> <span class="cn">FALSE</span>, <span class="at">bws =</span> b)</span>
<span id="cb38-6"><a href="01-estimacion-densidades-no-parametricas.html#cb38-6" aria-hidden="true" tabindex="-1"></a>    fani <span class="ot">&lt;-</span> fani <span class="sc">%&gt;%</span></span>
<span id="cb38-7"><a href="01-estimacion-densidades-no-parametricas.html#cb38-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">bind_rows</span>(<span class="fu">tibble</span>(<span class="at">xreal =</span> <span class="fu">sort</span>(x), <span class="at">x =</span> f<span class="sc">$</span>eval<span class="sc">$</span>x,</span>
<span id="cb38-8"><a href="01-estimacion-densidades-no-parametricas.html#cb38-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> f<span class="sc">$</span>dens, <span class="at">bw =</span> b))</span>
<span id="cb38-9"><a href="01-estimacion-densidades-no-parametricas.html#cb38-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-10"><a href="01-estimacion-densidades-no-parametricas.html#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="01-estimacion-densidades-no-parametricas.html#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fani) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, y), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb38-12"><a href="01-estimacion-densidades-no-parametricas.html#cb38-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;Ancho de banda = {closest_state}&quot;</span>)) <span class="sc">+</span></span>
<span id="cb38-13"><a href="01-estimacion-densidades-no-parametricas.html#cb38-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span> <span class="fu">transition_states</span>(bw) <span class="sc">+</span></span>
<span id="cb38-14"><a href="01-estimacion-densidades-no-parametricas.html#cb38-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">view_follow</span>()</span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="01-estimacion-densidades-no-parametricas.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># anim_save(&#39;manual_figure/bandwidth-animation-np.gif&#39;)</span></span></code></pre></div>
<!-- \includemedia[ -->
<!-- label=bandwidth, -->
<!-- width=0.6\linewidth,height=0.45\linewidth, -->
<!-- addresource=manual_figure/bandwidth-animation-np.mp4, -->
<!-- transparent, -->
<!-- %transparent player background -->
<!-- activate=pageopen, -->
<!-- %show VPlayer's right-click menu -->
<!-- flashvars={ -->
<!-- source=manual_figure/bandwidth-animation-np.mp4 -->
<!-- &loop=true -->
<!-- % loop video -->
<!-- } -->
<!-- ]{}{VPlayer.swf} -->
<div class="exercise">
<p><span id="exr:unnamed-chunk-64" class="exercise"><strong>Ejercicio 2.7  </strong></span>Implementar el intervalo confianza visto en clase para estimadores de densidades por núcleos y visualizarlo de en ggplot.</p>
<p><strong>Si se atreven: ¿Se podría hacer una versión animada de ese gráfico para visualizar el significado real de este el intervalo de confianza?</strong></p>
</div>
</div>
</div>
<div id="ejercicios" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Ejercicios<a href="01-estimacion-densidades-no-parametricas.html#ejercicios" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Del libro de <span class="citation">(Härdle et al. 2004)</span> hagan los siguientes ejercicios</p>
<ol style="list-style-type: decimal">
<li><strong>Sección 2:</strong> 1, 2, 3, 5, 7, 14</li>
<li><strong>Sección 3:</strong> 4, 8, 10, 11, 16,</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="02-jacknife-bootstrap.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/maikol-solis/notas-curso-estadistica/edit/master/01-estimacion-densidades-no-parametricas.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/maikol-solis/notas-curso-estadistica/blob/master/01-estimacion-densidades-no-parametricas.Rmd",
"text": null
},
"download": ["Notas-Curso-Estadistica.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toc_depth": 5
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
