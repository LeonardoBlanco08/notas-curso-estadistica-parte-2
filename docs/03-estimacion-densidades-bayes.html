<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 4 Estimación de densidades con Bayes | Notas Curso de Estadística II</title>
  <meta name="description" content="Capítulo 4 Estimación de densidades con Bayes | Notas Curso de Estadística II" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 4 Estimación de densidades con Bayes | Notas Curso de Estadística II" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 4 Estimación de densidades con Bayes | Notas Curso de Estadística II" />
  
  
  

<meta name="author" content="Maikol Solís Chacón y Luis Barboza Chinchilla" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="02-jacknife-bootstrap.html"/>
<link rel="next" href="04-metodos-lineares-regresion.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Curso de Estadística</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html"><i class="fa fa-check"></i><b>2</b> Estimación no-paramétrica de densidades</a>
<ul>
<li class="chapter" data-level="2.1" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#histograma"><i class="fa fa-check"></i><b>2.1</b> Histograma</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#construcción-estadística"><i class="fa fa-check"></i><b>2.1.1</b> Construcción Estadística</a></li>
<li class="chapter" data-level="2.1.2" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#construcción-probabilística"><i class="fa fa-check"></i><b>2.1.2</b> Construcción probabilística</a></li>
<li class="chapter" data-level="2.1.3" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#propiedades-estadísticas"><i class="fa fa-check"></i><b>2.1.3</b> Propiedades estadísticas</a></li>
<li class="chapter" data-level="2.1.4" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#propiedades-estadísticas-1"><i class="fa fa-check"></i><b>2.1.4</b> Propiedades estadísticas</a></li>
<li class="chapter" data-level="2.1.5" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#sesgo"><i class="fa fa-check"></i><b>2.1.5</b> Sesgo</a></li>
<li class="chapter" data-level="2.1.6" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#varianza"><i class="fa fa-check"></i><b>2.1.6</b> Varianza</a></li>
<li class="chapter" data-level="2.1.7" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#error-cuadrático-medio"><i class="fa fa-check"></i><b>2.1.7</b> Error cuadrático medio</a></li>
<li class="chapter" data-level="2.1.8" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#error-cuadrático-medio-integrado"><i class="fa fa-check"></i><b>2.1.8</b> Error cuadrático medio integrado</a></li>
<li class="chapter" data-level="2.1.9" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#ancho-de-banda-óptimo-para-el-histograma"><i class="fa fa-check"></i><b>2.1.9</b> Ancho de banda óptimo para el histograma</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#estimación-de-densidades-basada-en-kernels."><i class="fa fa-check"></i><b>2.2</b> Estimación de densidades basada en kernels.</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#primera-construcción"><i class="fa fa-check"></i><b>2.2.1</b> Primera construcción</a></li>
<li class="chapter" data-level="2.2.2" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#otra-construcción"><i class="fa fa-check"></i><b>2.2.2</b> Otra construcción</a></li>
<li class="chapter" data-level="2.2.3" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#propiedades-estadísticas-2"><i class="fa fa-check"></i><b>2.2.3</b> Propiedades Estadísticas</a></li>
<li class="chapter" data-level="2.2.4" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#sesgo-1"><i class="fa fa-check"></i><b>2.2.4</b> Sesgo</a></li>
<li class="chapter" data-level="2.2.5" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#error-cuadrático-medio-y-error-cuadrático-medio-integrado"><i class="fa fa-check"></i><b>2.2.5</b> Error cuadrático medio y Error cuadrático medio integrado</a></li>
<li class="chapter" data-level="2.2.6" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#ancho-de-banda-óptimo"><i class="fa fa-check"></i><b>2.2.6</b> Ancho de banda óptimo</a></li>
<li class="chapter" data-level="2.2.7" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#intervalos-de-confianza-para-estimadores-de-densidad-no-paramétricos"><i class="fa fa-check"></i><b>2.2.7</b> Intervalos de confianza para estimadores de densidad no paramétricos</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#laboratorio"><i class="fa fa-check"></i><b>2.3</b> Laboratorio</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#efecto-de-distintos-kernels-en-la-estimación"><i class="fa fa-check"></i><b>2.3.1</b> Efecto de distintos Kernels en la estimación</a></li>
<li class="chapter" data-level="2.3.2" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#efecto-del-ancho-de-banda-en-la-estimación"><i class="fa fa-check"></i><b>2.3.2</b> Efecto del ancho de banda en la estimación</a></li>
<li class="chapter" data-level="2.3.3" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#ancho-de-banda-óptimo-1"><i class="fa fa-check"></i><b>2.3.3</b> Ancho de banda óptimo</a></li>
<li class="chapter" data-level="2.3.4" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#validación-cruzada-1"><i class="fa fa-check"></i><b>2.3.4</b> Validación cruzada</a></li>
<li class="chapter" data-level="2.3.5" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#temas-adicionales"><i class="fa fa-check"></i><b>2.3.5</b> Temas adicionales</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="01-estimacion-densidades-no-parametricas.html"><a href="01-estimacion-densidades-no-parametricas.html#ejercicios"><i class="fa fa-check"></i><b>2.4</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="02-jacknife-bootstrap.html"><a href="02-jacknife-bootstrap.html"><i class="fa fa-check"></i><b>3</b> Jackknife y Bootstrap</a>
<ul>
<li class="chapter" data-level="3.1" data-path="02-jacknife-bootstrap.html"><a href="02-jacknife-bootstrap.html#caso-concreto"><i class="fa fa-check"></i><b>3.1</b> Caso concreto</a></li>
<li class="chapter" data-level="3.2" data-path="02-jacknife-bootstrap.html"><a href="02-jacknife-bootstrap.html#jackknife"><i class="fa fa-check"></i><b>3.2</b> Jackknife</a></li>
<li class="chapter" data-level="3.3" data-path="02-jacknife-bootstrap.html"><a href="02-jacknife-bootstrap.html#bootstrap"><i class="fa fa-check"></i><b>3.3</b> Bootstrap</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="02-jacknife-bootstrap.html"><a href="02-jacknife-bootstrap.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>3.3.1</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="3.3.2" data-path="02-jacknife-bootstrap.html"><a href="02-jacknife-bootstrap.html#resumiendo"><i class="fa fa-check"></i><b>3.3.2</b> Resumiendo</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="02-jacknife-bootstrap.html"><a href="02-jacknife-bootstrap.html#ejercicios-1"><i class="fa fa-check"></i><b>3.4</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="03-estimacion-densidades-bayes.html"><a href="03-estimacion-densidades-bayes.html"><i class="fa fa-check"></i><b>4</b> Estimación de densidades con Bayes</a>
<ul>
<li class="chapter" data-level="4.1" data-path="03-estimacion-densidades-bayes.html"><a href="03-estimacion-densidades-bayes.html#introducción-a-la-estimación-bayesiana"><i class="fa fa-check"></i><b>4.1</b> Introducción a la estimación Bayesiana</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="03-estimacion-densidades-bayes.html"><a href="03-estimacion-densidades-bayes.html#preliminares"><i class="fa fa-check"></i><b>4.1.1</b> Preliminares</a></li>
<li class="chapter" data-level="4.1.2" data-path="03-estimacion-densidades-bayes.html"><a href="03-estimacion-densidades-bayes.html#ejemplo-sencillo"><i class="fa fa-check"></i><b>4.1.2</b> Ejemplo sencillo</a></li>
<li class="chapter" data-level="4.1.3" data-path="03-estimacion-densidades-bayes.html"><a href="03-estimacion-densidades-bayes.html#datos-reales"><i class="fa fa-check"></i><b>4.1.3</b> Datos reales</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="03-estimacion-densidades-bayes.html"><a href="03-estimacion-densidades-bayes.html#previa-de-histograma"><i class="fa fa-check"></i><b>4.2</b> Previa de histograma</a></li>
<li class="chapter" data-level="4.3" data-path="03-estimacion-densidades-bayes.html"><a href="03-estimacion-densidades-bayes.html#métodos-monte-carlo"><i class="fa fa-check"></i><b>4.3</b> Métodos Monte Carlo</a></li>
<li class="chapter" data-level="4.4" data-path="03-estimacion-densidades-bayes.html"><a href="03-estimacion-densidades-bayes.html#una-moneda"><i class="fa fa-check"></i><b>4.4</b> Una moneda</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="03-estimacion-densidades-bayes.html"><a href="03-estimacion-densidades-bayes.html#ejemplo-del-viajero"><i class="fa fa-check"></i><b>4.4.1</b> Ejemplo del viajero</a></li>
<li class="chapter" data-level="4.4.2" data-path="03-estimacion-densidades-bayes.html"><a href="03-estimacion-densidades-bayes.html#cadenas-de-markov"><i class="fa fa-check"></i><b>4.4.2</b> Cadenas de Markov</a></li>
<li class="chapter" data-level="4.4.3" data-path="03-estimacion-densidades-bayes.html"><a href="03-estimacion-densidades-bayes.html#el-algoritmo-de-metropolis-hasting"><i class="fa fa-check"></i><b>4.4.3</b> El algoritmo de Metropolis-Hasting</a></li>
<li class="chapter" data-level="4.4.4" data-path="03-estimacion-densidades-bayes.html"><a href="03-estimacion-densidades-bayes.html#por-qué-el-algoritmo-de-metropolis-hasting-funciona"><i class="fa fa-check"></i><b>4.4.4</b> ¿Por qué el algoritmo de Metropolis Hasting funciona?</a></li>
<li class="chapter" data-level="4.4.5" data-path="03-estimacion-densidades-bayes.html"><a href="03-estimacion-densidades-bayes.html#extensión-al-caso-del-viajero"><i class="fa fa-check"></i><b>4.4.5</b> Extensión al caso del viajero</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="03-estimacion-densidades-bayes.html"><a href="03-estimacion-densidades-bayes.html#dos-monedas"><i class="fa fa-check"></i><b>4.5</b> Dos monedas</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="03-estimacion-densidades-bayes.html"><a href="03-estimacion-densidades-bayes.html#muestreo-de-gibbs"><i class="fa fa-check"></i><b>4.5.1</b> Muestreo de Gibbs</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="03-estimacion-densidades-bayes.html"><a href="03-estimacion-densidades-bayes.html#uso-de-jags"><i class="fa fa-check"></i><b>4.6</b> Uso de JAGS</a></li>
<li class="chapter" data-level="4.7" data-path="03-estimacion-densidades-bayes.html"><a href="03-estimacion-densidades-bayes.html#uso-de-stan"><i class="fa fa-check"></i><b>4.7</b> Uso de STAN</a></li>
<li class="chapter" data-level="4.8" data-path="03-estimacion-densidades-bayes.html"><a href="03-estimacion-densidades-bayes.html#ejercicios-2"><i class="fa fa-check"></i><b>4.8</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html"><i class="fa fa-check"></i><b>5</b> Métodos lineales de regresión</a>
<ul>
<li class="chapter" data-level="5.1" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#introducción-al-aprendizaje-estadístico."><i class="fa fa-check"></i><b>5.1</b> Introducción al Aprendizaje Estadístico.</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#formas-de-estimar-f"><i class="fa fa-check"></i><b>5.1.1</b> Formas de estimar <span class="math inline">\(f\)</span></a></li>
<li class="chapter" data-level="5.1.2" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#medidas-de-bondad-de-ajuste"><i class="fa fa-check"></i><b>5.1.2</b> Medidas de bondad de ajuste</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#regresión-lineal"><i class="fa fa-check"></i><b>5.2</b> Regresión lineal</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#forma-matricial"><i class="fa fa-check"></i><b>5.2.1</b> Forma matricial</a></li>
<li class="chapter" data-level="5.2.2" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#laboratorio-1"><i class="fa fa-check"></i><b>5.2.2</b> Laboratorio</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#propiedades-estadísticas-3"><i class="fa fa-check"></i><b>5.3</b> Propiedades estadísticas</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#prueba-t"><i class="fa fa-check"></i><b>5.3.1</b> Prueba <span class="math inline">\(t\)</span></a></li>
<li class="chapter" data-level="5.3.2" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#prueba-f"><i class="fa fa-check"></i><b>5.3.2</b> Prueba <span class="math inline">\(F\)</span></a></li>
<li class="chapter" data-level="5.3.3" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#laboratorio-2"><i class="fa fa-check"></i><b>5.3.3</b> Laboratorio</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#medida-de-bondad-de-ajuste"><i class="fa fa-check"></i><b>5.4</b> Medida de bondad de ajuste</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#laboratorio-3"><i class="fa fa-check"></i><b>5.4.1</b> Laboratorio</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#predicción"><i class="fa fa-check"></i><b>5.5</b> Predicción</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#laboratorio-4"><i class="fa fa-check"></i><b>5.5.1</b> Laboratorio</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#interacciones"><i class="fa fa-check"></i><b>5.6</b> Interacciones</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#laboratorio-5"><i class="fa fa-check"></i><b>5.6.1</b> Laboratorio</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#supuestos"><i class="fa fa-check"></i><b>5.7</b> Supuestos</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#chequeos-básicos-de-las-hipótesis-de-regresión-lineal"><i class="fa fa-check"></i><b>5.7.1</b> Chequeos básicos de las hipótesis de regresión lineal</a></li>
<li class="chapter" data-level="5.7.2" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#otros-chequeos-importantes"><i class="fa fa-check"></i><b>5.7.2</b> Otros chequeos importantes</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="04-metodos-lineares-regresion.html"><a href="04-metodos-lineares-regresion.html#ejercicios-3"><i class="fa fa-check"></i><b>5.8</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html"><i class="fa fa-check"></i><b>6</b> Regresión Logística</a>
<ul>
<li class="chapter" data-level="6.1" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#preliminares-1"><i class="fa fa-check"></i><b>6.1</b> Preliminares</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#oportunidad-relativa-odds-ratio"><i class="fa fa-check"></i><b>6.1.1</b> Oportunidad relativa (Odds Ratio)</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#máxima-verosimilitud"><i class="fa fa-check"></i><b>6.2</b> Máxima verosimilitud</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#resultados-adicionales"><i class="fa fa-check"></i><b>6.2.1</b> Resultados adicionales</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#diágnosticos-del-modelo"><i class="fa fa-check"></i><b>6.3</b> Diágnosticos del modelo</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#supuesto-de-linealidad"><i class="fa fa-check"></i><b>6.3.1</b> Supuesto de linealidad</a></li>
<li class="chapter" data-level="6.3.2" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#valores-de-gran-influencia"><i class="fa fa-check"></i><b>6.3.2</b> Valores de gran influencia</a></li>
<li class="chapter" data-level="6.3.3" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#multicolinealidad-1"><i class="fa fa-check"></i><b>6.3.3</b> Multicolinealidad</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#predicción-y-poder-de-clasificación"><i class="fa fa-check"></i><b>6.4</b> Predicción y poder de clasificación</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#curva-roc"><i class="fa fa-check"></i><b>6.4.1</b> Curva ROC</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="05-regresion-logistica.html"><a href="05-regresion-logistica.html#ejercicios-4"><i class="fa fa-check"></i><b>6.5</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html"><i class="fa fa-check"></i><b>7</b> Métodos de selección de variables y regularización.</a>
<ul>
<li class="chapter" data-level="7.1" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#estimación-del-error-de-prueba"><i class="fa fa-check"></i><b>7.1</b> Estimación del error de prueba</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#técnica-de-conjunto-de-validación"><i class="fa fa-check"></i><b>7.1.1</b> Técnica de conjunto de validación</a></li>
<li class="chapter" data-level="7.1.2" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#validación-cruzada-leave-one-out-loocv"><i class="fa fa-check"></i><b>7.1.2</b> Validación cruzada “Leave-One-Out” (LOOCV)</a></li>
<li class="chapter" data-level="7.1.3" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#validación-cruzada-k-veces"><i class="fa fa-check"></i><b>7.1.3</b> Validación cruzada <span class="math inline">\(k-\)</span>veces</a></li>
<li class="chapter" data-level="7.1.4" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#validación-cruzada-para-clasificación"><i class="fa fa-check"></i><b>7.1.4</b> Validación cruzada para clasificación</a></li>
<li class="chapter" data-level="7.1.5" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#otras-medidas-de-error-de-prueba"><i class="fa fa-check"></i><b>7.1.5</b> Otras medidas de error de prueba</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#selección-de-variables"><i class="fa fa-check"></i><b>7.2</b> Selección de variables</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#selección-del-mejor-subconjunto."><i class="fa fa-check"></i><b>7.2.1</b> Selección del mejor subconjunto.</a></li>
<li class="chapter" data-level="7.2.2" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#selección-de-modelos-hacia-adelante-forward-stepwise-selection"><i class="fa fa-check"></i><b>7.2.2</b> Selección de modelos hacia adelante (<strong>Forward Stepwise Selection</strong>)</a></li>
<li class="chapter" data-level="7.2.3" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#selección-de-modelos-hacia-atrás-backward-stepwise-selection"><i class="fa fa-check"></i><b>7.2.3</b> Selección de modelos hacia atrás (<strong>Backward Stepwise Selection</strong>)</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#métodos-de-regularización"><i class="fa fa-check"></i><b>7.3</b> Métodos de regularización</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#regresión-ridge"><i class="fa fa-check"></i><b>7.3.1</b> Regresión Ridge</a></li>
<li class="chapter" data-level="7.3.2" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#regresión-lasso"><i class="fa fa-check"></i><b>7.3.2</b> Regresión Lasso</a></li>
<li class="chapter" data-level="7.3.3" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#explicación-gráfica"><i class="fa fa-check"></i><b>7.3.3</b> Explicación gráfica</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#laboratorio-6"><i class="fa fa-check"></i><b>7.4</b> Laboratorio</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#cross-validation"><i class="fa fa-check"></i><b>7.4.1</b> Cross-Validation</a></li>
<li class="chapter" data-level="7.4.2" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#regresión-lasso-1"><i class="fa fa-check"></i><b>7.4.2</b> Regresión Lasso</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="06-seleccion-de-variables.html"><a href="06-seleccion-de-variables.html#ejercicios-5"><i class="fa fa-check"></i><b>7.5</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="08-clasificacion.html"><a href="08-clasificacion.html"><i class="fa fa-check"></i><b>8</b> Análisis en componentes principales</a>
<ul>
<li class="chapter" data-level="8.1" data-path="08-clasificacion.html"><a href="08-clasificacion.html#aprendizaje-no-supervisado"><i class="fa fa-check"></i><b>8.1</b> Aprendizaje no-supervisado</a></li>
<li class="chapter" data-level="8.2" data-path="08-clasificacion.html"><a href="08-clasificacion.html#representación-gráfica"><i class="fa fa-check"></i><b>8.2</b> Representación gráfica</a></li>
<li class="chapter" data-level="8.3" data-path="08-clasificacion.html"><a href="08-clasificacion.html#primer-componente-principal"><i class="fa fa-check"></i><b>8.3</b> Primer componente principal</a></li>
<li class="chapter" data-level="8.4" data-path="08-clasificacion.html"><a href="08-clasificacion.html#segunda-componente-principal"><i class="fa fa-check"></i><b>8.4</b> Segunda componente principal</a></li>
<li class="chapter" data-level="8.5" data-path="08-clasificacion.html"><a href="08-clasificacion.html#circulo-de-correlaciones"><i class="fa fa-check"></i><b>8.5</b> Circulo de correlaciones</a></li>
<li class="chapter" data-level="8.6" data-path="08-clasificacion.html"><a href="08-clasificacion.html#volvamos-a-nuestro-ejemplo"><i class="fa fa-check"></i><b>8.6</b> Volvamos a nuestro ejemplo</a></li>
<li class="chapter" data-level="8.7" data-path="08-clasificacion.html"><a href="08-clasificacion.html#cuántos-componentes-usar"><i class="fa fa-check"></i><b>8.7</b> ¿Cuántos componentes usar?</a></li>
<li class="chapter" data-level="8.8" data-path="08-clasificacion.html"><a href="08-clasificacion.html#laboratorio-7"><i class="fa fa-check"></i><b>8.8</b> Laboratorio</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="08-clasificacion.html"><a href="08-clasificacion.html#clasificador-logístico"><i class="fa fa-check"></i><b>8.8.1</b> Clasificador logístico</a></li>
<li class="chapter" data-level="8.8.2" data-path="08-clasificacion.html"><a href="08-clasificacion.html#análisis-discriminante-lineal"><i class="fa fa-check"></i><b>8.8.2</b> Análisis Discriminante Lineal</a></li>
<li class="chapter" data-level="8.8.3" data-path="08-clasificacion.html"><a href="08-clasificacion.html#análisis-discriminante-cuadrático"><i class="fa fa-check"></i><b>8.8.3</b> Análisis Discriminante Cuadrático</a></li>
<li class="chapter" data-level="8.8.4" data-path="08-clasificacion.html"><a href="08-clasificacion.html#k-vecinos-más-cercanos"><i class="fa fa-check"></i><b>8.8.4</b> K vecinos más cercanos</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="08-clasificacion.html"><a href="08-clasificacion.html#ejercicios-6"><i class="fa fa-check"></i><b>8.9</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="09-calculo-bayes.html"><a href="09-calculo-bayes.html"><i class="fa fa-check"></i><b>9</b> Cálculo Bayesiano Computacional</a>
<ul>
<li class="chapter" data-level="9.1" data-path="09-calculo-bayes.html"><a href="09-calculo-bayes.html#repaso-de-estadística-bayesiana"><i class="fa fa-check"></i><b>9.1</b> Repaso de Estadística Bayesiana</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="09-calculo-bayes.html"><a href="09-calculo-bayes.html#modelo-de-un-parámetro"><i class="fa fa-check"></i><b>9.1.1</b> Modelo de un parámetro</a></li>
<li class="chapter" data-level="9.1.2" data-path="09-calculo-bayes.html"><a href="09-calculo-bayes.html#modelo-de-más-de-un-parámetro"><i class="fa fa-check"></i><b>9.1.2</b> Modelo de más de un parámetro</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="09-calculo-bayes.html"><a href="09-calculo-bayes.html#motivación-cálculo-de-integrales"><i class="fa fa-check"></i><b>9.2</b> Motivación: Cálculo de Integrales</a></li>
<li class="chapter" data-level="9.3" data-path="09-calculo-bayes.html"><a href="09-calculo-bayes.html#ejemplo-base-modelo-beta-binomial."><i class="fa fa-check"></i><b>9.3</b> Ejemplo base: modelo beta-binomial.</a></li>
<li class="chapter" data-level="9.4" data-path="09-calculo-bayes.html"><a href="09-calculo-bayes.html#aproximación-de-laplace"><i class="fa fa-check"></i><b>9.4</b> Aproximación de Laplace</a></li>
<li class="chapter" data-level="9.5" data-path="09-calculo-bayes.html"><a href="09-calculo-bayes.html#simulación"><i class="fa fa-check"></i><b>9.5</b> Simulación</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="09-calculo-bayes.html"><a href="09-calculo-bayes.html#simulación-monte-carlo"><i class="fa fa-check"></i><b>9.5.1</b> Simulación Monte Carlo</a></li>
<li class="chapter" data-level="9.5.2" data-path="09-calculo-bayes.html"><a href="09-calculo-bayes.html#muestreo-por-rechazo"><i class="fa fa-check"></i><b>9.5.2</b> Muestreo por rechazo</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="09-calculo-bayes.html"><a href="09-calculo-bayes.html#muestreo-por-importancia"><i class="fa fa-check"></i><b>9.6</b> Muestreo por importancia</a></li>
<li class="chapter" data-level="9.7" data-path="09-calculo-bayes.html"><a href="09-calculo-bayes.html#remuestreo-por-importancia"><i class="fa fa-check"></i><b>9.7</b> Remuestreo por importancia</a></li>
<li class="chapter" data-level="9.8" data-path="09-calculo-bayes.html"><a href="09-calculo-bayes.html#algoritmo-de-metropolis-hastings"><i class="fa fa-check"></i><b>9.8</b> Algoritmo de Metropolis-Hastings</a></li>
<li class="chapter" data-level="9.9" data-path="09-calculo-bayes.html"><a href="09-calculo-bayes.html#algoritmo-de-gibbs"><i class="fa fa-check"></i><b>9.9</b> Algoritmo de Gibbs</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="09-calculo-bayes.html"><a href="09-calculo-bayes.html#diagnósticos-de-convergencia-de-mcmc"><i class="fa fa-check"></i><b>9.9.1</b> Diagnósticos de convergencia de MCMC</a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="09-calculo-bayes.html"><a href="09-calculo-bayes.html#ejemplos"><i class="fa fa-check"></i><b>9.10</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="9.10.1" data-path="09-calculo-bayes.html"><a href="09-calculo-bayes.html#datos-agrupados-bajo-una-población-normal"><i class="fa fa-check"></i><b>9.10.1</b> Datos agrupados bajo una población normal</a></li>
</ul></li>
<li class="chapter" data-level="9.11" data-path="09-calculo-bayes.html"><a href="09-calculo-bayes.html#ejercicios-7"><i class="fa fa-check"></i><b>9.11</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notas Curso de Estadística II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="estimación-de-densidades-con-bayes" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Capítulo 4</span> Estimación de densidades con Bayes<a href="03-estimacion-densidades-bayes.html#estimación-de-densidades-con-bayes" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introducción-a-la-estimación-bayesiana" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Introducción a la estimación Bayesiana<a href="03-estimacion-densidades-bayes.html#introducción-a-la-estimación-bayesiana" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="preliminares" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Preliminares<a href="03-estimacion-densidades-bayes.html#preliminares" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recordemos que tenemos <span class="math inline">\(f(\theta)\)</span> la previa, <span class="math inline">\(L(\theta)\)</span> la
verosimilitud de los datos y <span class="math inline">\(f(\theta|\text { data })\)</span> la posterior
ajustada a los datos.</p>
<p><span class="math display">\[\begin{equation*}
    f(\theta | \text { data }) \propto f(\theta) L(\theta)
\end{equation*}\]</span></p>
<p>Además para el caso de la binomial tenemos que</p>
<p><span class="math display">\[\begin{equation*}
    f(y | \theta)=\theta^{\gamma}(1-\theta)^{(1-\gamma)}
\end{equation*}\]</span></p>
<p>y la distribución beta se escribe de la forma</p>
<p><span class="math display">\[\begin{align*}
    f(\theta | a, b) &amp; =\operatorname{beta}(\theta | a, b)         \\
                     &amp; =\theta^{(a-1)}(1-\theta)^{(b-1)} / B(a, b)
\end{align*}\]</span></p>
<p>donde</p>
<p><span class="math display">\[\begin{equation*}
    B(a, b)=\int_{0}^{1}  \theta^{(a-1)}(1-\theta)^{(b-1)}\mathrm{d} \theta.
\end{equation*}\]</span></p>
<p>Los valores de <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span> controlan la forma de esta distribución</p>
<div class="figure">
<img src="manual_figures/betas.png" alt="" />
<p class="caption">Tomado de <span class="citation">Kruschke (2014)</span></p>
</div>
<p>Una forma alternative es <span class="math inline">\(\mu=a /(a+b)\)</span> es la media, <span class="math inline">\(\kappa=a+b\)</span>
es la concentración y <span class="math inline">\(\omega=(a-1) /(a+b-2)\)</span> es la moda de la
distribución Beta, entonces se cumple que</p>
<p><span class="math display">\[\begin{align*}
          &amp; a=\mu \kappa \quad \text { y } \quad b=(1-\mu) \kappa                                         \\
          &amp; a=\omega(\kappa-2)+1 \quad \text { y } \quad b=(1-\omega)(\kappa-2)+1 \text { para } \kappa&gt;2
\end{align*}\]</span></p>
<p>Es decir, es posible estimar <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span> de <span class="math inline">\(\kappa\)</span>, <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\omega\)</span></p>
<p>De acuerdo la combinación de estas dos distribuciones forma una familia conjugada de modo que</p>
<p><span class="math display">\[\begin{align*}
        f(\theta | z, N)
          &amp; = f(z, N | \theta) f(\theta) / f(z, N)
        \quad                                              \\
          &amp; = \theta^{z}(1-\theta)^{(N-z)} \frac{\theta^{(a-1)}(1-\theta)^{(b-1)}}{B(a, b)} / p(z, N) \\
          &amp; = \theta^{z}(1-\theta)^{(N-z)} \theta^{(a-1)}(1-\theta)^{(b-1)} /[B(a, b) p(z, N)]        \\
          &amp; = \theta^{((z+a)-1)}(1-\theta)^{((N-z+b)-1)} /[B(a, b) p(z, N)]                           \\
          &amp; = \theta^{((z+a)-1)}(1-\theta)^{((N-z+b)-1)} / B(z+a, N-z+b)
\end{align*}\]</span></p>
</div>
<div id="ejemplo-sencillo" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Ejemplo sencillo<a href="03-estimacion-densidades-bayes.html#ejemplo-sencillo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suponga que se hace una encuesta a 27 estudiantes y se encuentra que
11 dicen que duermen más de 8 horas diarias y el resto no. Nuestro
objetivo es encontrar inferencias sobre la proporción <span class="math inline">\(p\)</span> de
estudiantes que duermen al menos 8 horas diarias. El modelo más
adecuado es</p>
<p><span class="math display">\[
        f(x \vert p) \propto p^s (1-p)^f
\]</span></p>
<p>donde <span class="math inline">\(s\)</span> es la cantidad de estudiantes que duermen más de 8 horas y
<span class="math inline">\(f\)</span> los que duermen menos de 8 horas.</p>
<p>Una primera aproximación para la previa es usar una distribución
discreta. En este caso, el investigador asigna una probabilidad a
cierta cantidad de horas de sueño, según su experiencia. Así, por
ejemplo:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="03-estimacion-densidades-bayes.html#cb80-1" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span></code></pre></div>
<pre><code>##  [1] 0.05 0.15 0.25 0.35 0.45 0.55 0.65 0.75 0.85 0.95</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="03-estimacion-densidades-bayes.html#cb82-1" aria-hidden="true" tabindex="-1"></a>(prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">5.2</span>, <span class="dv">8</span>, <span class="fl">7.2</span>, <span class="fl">4.6</span>, <span class="fl">2.1</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span>, <span class="dv">0</span>,</span>
<span id="cb82-2"><a href="03-estimacion-densidades-bayes.html#cb82-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>))</span></code></pre></div>
<pre><code>##  [1] 1.0 5.2 8.0 7.2 4.6 2.1 0.7 0.1 0.0 0.0</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="03-estimacion-densidades-bayes.html#cb84-1" aria-hidden="true" tabindex="-1"></a>(prior <span class="ot">&lt;-</span> prior<span class="sc">/</span><span class="fu">sum</span>(prior))</span></code></pre></div>
<pre><code>##  [1] 0.034602076 0.179930796 0.276816609 0.249134948 0.159169550 0.072664360
##  [7] 0.024221453 0.003460208 0.000000000 0.000000000</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="03-estimacion-densidades-bayes.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p, prior, <span class="at">type =</span> <span class="st">&quot;h&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Probabilidad Previa&quot;</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-107-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<p>El paquete <code>LearnBayes</code> tiene la función <code>pdisc</code> que estima la
distribución posterior para una previa discreta binomial. Recuerde que
el valor 11 representa la cantidad de estudiantes con más de 8 horas
de sueño y 16 lo que no duermen esa cantidad.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="03-estimacion-densidades-bayes.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(LearnBayes)</span>
<span id="cb87-2"><a href="03-estimacion-densidades-bayes.html#cb87-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">16</span>)</span>
<span id="cb87-3"><a href="03-estimacion-densidades-bayes.html#cb87-3" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">pdisc</span>(p, prior, data)</span>
<span id="cb87-4"><a href="03-estimacion-densidades-bayes.html#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(p, prior, post), <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##          p prior post
##  [1,] 0.05  0.03 0.00
##  [2,] 0.15  0.18 0.00
##  [3,] 0.25  0.28 0.13
##  [4,] 0.35  0.25 0.48
##  [5,] 0.45  0.16 0.33
##  [6,] 0.55  0.07 0.06
##  [7,] 0.65  0.02 0.00
##  [8,] 0.75  0.00 0.00
##  [9,] 0.85  0.00 0.00
## [10,] 0.95  0.00 0.00</code></pre>
<p>Y podemos ver la diferencia entre la previa (negro) y la posterior
(roja),</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="03-estimacion-densidades-bayes.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p, post, <span class="at">type =</span> <span class="st">&quot;h&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb89-2"><a href="03-estimacion-densidades-bayes.html#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(p <span class="sc">+</span> <span class="fl">0.01</span>, prior, <span class="at">type =</span> <span class="st">&quot;h&quot;</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-109-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<p>¿Qué se puede deducir de estos resultados?</p>
</div>
<div id="datos-reales" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Datos reales<a href="03-estimacion-densidades-bayes.html#datos-reales" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Continuemos el ejercicio pero esta vez usando datos reales.</p>
<p>Carguemos los datos <code>studdendata</code> del paquete <code>LearnBayes</code>. Esta base
son preguntas que se le hicieron a un grupo de estudiantes de Bowling
Green State University. Para mayor información use <code>?studentdata</code>.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="03-estimacion-densidades-bayes.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;studentdata&quot;</span>)</span></code></pre></div>
<p>Como solo se tiene la hora de dormir y la hora de despertarse, se debe tomar la diferencia.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="03-estimacion-densidades-bayes.html#cb91-1" aria-hidden="true" tabindex="-1"></a>horas_sueno <span class="ot">&lt;-</span> studentdata<span class="sc">$</span>WakeUp <span class="sc">-</span> studentdata<span class="sc">$</span>ToSleep</span>
<span id="cb91-2"><a href="03-estimacion-densidades-bayes.html#cb91-2" aria-hidden="true" tabindex="-1"></a>horas_sueno <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(horas_sueno)</span>
<span id="cb91-3"><a href="03-estimacion-densidades-bayes.html#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(horas_sueno)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   2.500   6.500   7.500   7.385   8.500  12.500</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="03-estimacion-densidades-bayes.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(horas_sueno, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-111-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<p>Ahora supongamos que se tiene quiere ajustar una previa continua a este modelo. Para esto usaremos una distribución Beta con parámetros <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span>, de la forma</p>
<p><span class="math display">\[
    f(p\vert \alpha, \beta) \propto p^{1-a} (1-p)^{1-b}.
\]</span></p>
<p>El ajuste de los parámetros de la Beta depende mucho de la información
previa que se tenga del modelo. Una forma fácil de estimarlo es a
través de cuantiles con los cuales se puede reescribir estos
parámetros. En particular, suponga que se cree que el <span class="math inline">\(50\%\)</span> de las
observaciones la proporción será menor que 0.3 y el <span class="math inline">\(90\%\)</span> será menor
que 0.5.</p>
<p>Para esto ajustaremos los siguientes parámetros</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="03-estimacion-densidades-bayes.html#cb94-1" aria-hidden="true" tabindex="-1"></a>quantile2 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">p =</span> <span class="fl">0.9</span>, <span class="at">x =</span> <span class="fl">0.5</span>)</span>
<span id="cb94-2"><a href="03-estimacion-densidades-bayes.html#cb94-2" aria-hidden="true" tabindex="-1"></a>quantile1 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">p =</span> <span class="fl">0.5</span>, <span class="at">x =</span> <span class="fl">0.3</span>)</span>
<span id="cb94-3"><a href="03-estimacion-densidades-bayes.html#cb94-3" aria-hidden="true" tabindex="-1"></a>ab <span class="ot">&lt;-</span> <span class="fu">beta.select</span>(quantile1, quantile2)</span>
<span id="cb94-4"><a href="03-estimacion-densidades-bayes.html#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="03-estimacion-densidades-bayes.html#cb94-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> ab[<span class="dv">1</span>]</span>
<span id="cb94-6"><a href="03-estimacion-densidades-bayes.html#cb94-6" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> ab[<span class="dv">2</span>]</span>
<span id="cb94-7"><a href="03-estimacion-densidades-bayes.html#cb94-7" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">11</span></span>
<span id="cb94-8"><a href="03-estimacion-densidades-bayes.html#cb94-8" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="dv">16</span></span></code></pre></div>
<p>En este caso se obtendra la distribución posterior Beta con paramétros
<span class="math inline">\(\alpha + s\)</span> y <span class="math inline">\(\beta + f\)</span>,</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="03-estimacion-densidades-bayes.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x, a <span class="sc">+</span> s, b <span class="sc">+</span> f), <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">xlab =</span> <span class="st">&quot;p&quot;</span>,</span>
<span id="cb95-2"><a href="03-estimacion-densidades-bayes.html#cb95-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Densidad&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">4</span>)</span>
<span id="cb95-3"><a href="03-estimacion-densidades-bayes.html#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x, s <span class="sc">+</span> <span class="dv">1</span>, f <span class="sc">+</span> <span class="dv">1</span>), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb95-4"><a href="03-estimacion-densidades-bayes.html#cb95-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">4</span>)</span>
<span id="cb95-5"><a href="03-estimacion-densidades-bayes.html#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x, a, b), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">4</span>)</span>
<span id="cb95-6"><a href="03-estimacion-densidades-bayes.html#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">0.7</span>, <span class="dv">4</span>, <span class="fu">c</span>(<span class="st">&quot;Previa&quot;</span>, <span class="st">&quot;Verosimilitud&quot;</span>, <span class="st">&quot;Posterior&quot;</span>),</span>
<span id="cb95-7"><a href="03-estimacion-densidades-bayes.html#cb95-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-113-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<p>En particular, si estamos interesados en <span class="math inline">\(\mathbb{P}(p&gt;=.5 | \text {  data })\)</span> se puede estimar con</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="03-estimacion-densidades-bayes.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pbeta</span>(<span class="fl">0.5</span>, a <span class="sc">+</span> s, b <span class="sc">+</span> f)</span></code></pre></div>
<pre><code>## [1] 0.0690226</code></pre>
<p>y el intervalo de confianza correspondiente a esta distribución sería</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="03-estimacion-densidades-bayes.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qbeta</span>(<span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>), a <span class="sc">+</span> s, b <span class="sc">+</span> f)</span></code></pre></div>
<pre><code>## [1] 0.2555267 0.5133608</code></pre>
<p>Otra opción para estimar este intervalo es simular 1000 veces la
distribución beta y observar su comportamiento en los cuantiles</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="03-estimacion-densidades-bayes.html#cb100-1" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1000</span>, a <span class="sc">+</span> s, b <span class="sc">+</span> f)</span>
<span id="cb100-2"><a href="03-estimacion-densidades-bayes.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ps, <span class="at">xlab =</span> <span class="st">&quot;p&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-116-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<p>La probabilidad que este valor sea mayor que 0.5 es</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="03-estimacion-densidades-bayes.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(ps <span class="sc">&gt;=</span> <span class="fl">0.5</span>)<span class="sc">/</span><span class="dv">1000</span></span></code></pre></div>
<pre><code>## [1] 0.065</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="03-estimacion-densidades-bayes.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(ps, <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>))</span></code></pre></div>
<pre><code>##        5%       95% 
## 0.2571102 0.5102856</code></pre>
</div>
</div>
<div id="previa-de-histograma" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Previa de histograma<a href="03-estimacion-densidades-bayes.html#previa-de-histograma" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El caso anterior funciona perfecto dada la combinación Binomial-Beta.</p>
<p>¿Qué pasaría si nuestra previa no está basada beta, sino que
quisiéramos extraerla directamente de los datos?</p>
<p>El método que usaremos será el siguiente:</p>
<ul>
<li>Elija una cuadrícula de valores de <span class="math inline">\(p\)</span> sobre un intervalo que cubra
la densidad posterior.</li>
<li>Calcule el producto de la probabilidad <span class="math inline">\(L (p)\)</span> y el <span class="math inline">\(f (p)\)</span> sobre
esa grilla.</li>
<li>Normalice dividiendo cada producto por la suma de los productos. En
esto paso, estamos aproximando la densidad posterior por una
probabilidad discreta Distribución en la grilla.</li>
<li>Usando el comando <code>sample</code> de <code>R</code>, tome una muestra aleatoria con
reemplazo de la distribución discreta.</li>
</ul>
<p>El resultado nos debe arrojar una muestra de la distribución posterior
sobre la grilla</p>
<p>Suponga nuevamente que tenemos las mismas previas dadas al inicio del
capítulo</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="03-estimacion-densidades-bayes.html#cb105-1" aria-hidden="true" tabindex="-1"></a>midpt <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb105-2"><a href="03-estimacion-densidades-bayes.html#cb105-2" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">5.2</span>, <span class="dv">8</span>, <span class="fl">7.2</span>, <span class="fl">4.6</span>, <span class="fl">2.1</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb105-3"><a href="03-estimacion-densidades-bayes.html#cb105-3" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> prior<span class="sc">/</span><span class="fu">sum</span>(prior)</span></code></pre></div>
<p>Con la función <code>histprior</code> construye los valores de <span class="math inline">\(p\)</span> sobre una
grilla.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="03-estimacion-densidades-bayes.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">histprior</span>(x, midpt, prior), <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>,</span>
<span id="cb106-2"><a href="03-estimacion-densidades-bayes.html#cb106-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Densidad previa&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>))</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-120-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<p>Luego recordando que nuestra posterior es <span class="math inline">\(beta(s+1,f+1)\)</span> tenemos que</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="03-estimacion-densidades-bayes.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">histprior</span>(x, midpt, prior) <span class="sc">*</span> <span class="fu">dbeta</span>(x, s <span class="sc">+</span> <span class="dv">1</span>,</span>
<span id="cb107-2"><a href="03-estimacion-densidades-bayes.html#cb107-2" aria-hidden="true" tabindex="-1"></a>    f <span class="sc">+</span> <span class="dv">1</span>), <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">ylab =</span> <span class="st">&quot;Densidad posterior&quot;</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-121-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<p>Para conseguir la distribución posterior, solo debemos de construirla para una secuencia ordenada de valores <span class="math inline">\(p\)</span></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="03-estimacion-densidades-bayes.html#cb108-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">1000</span>)</span>
<span id="cb108-2"><a href="03-estimacion-densidades-bayes.html#cb108-2" aria-hidden="true" tabindex="-1"></a>post <span class="ot">=</span> <span class="fu">histprior</span>(p, midpt, prior) <span class="sc">*</span> <span class="fu">dbeta</span>(p, s <span class="sc">+</span> <span class="dv">1</span>,</span>
<span id="cb108-3"><a href="03-estimacion-densidades-bayes.html#cb108-3" aria-hidden="true" tabindex="-1"></a>    f <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb108-4"><a href="03-estimacion-densidades-bayes.html#cb108-4" aria-hidden="true" tabindex="-1"></a>post <span class="ot">=</span> post<span class="sc">/</span><span class="fu">sum</span>(post)</span></code></pre></div>
<p>Finalmente basta con tomar el muestreo de la posterior</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="03-estimacion-densidades-bayes.html#cb109-1" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">sample</span>(p, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> post)</span>
<span id="cb109-2"><a href="03-estimacion-densidades-bayes.html#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ps, <span class="at">xlab =</span> <span class="st">&quot;p&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-123-1.svg" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="métodos-monte-carlo" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Métodos Monte Carlo<a href="03-estimacion-densidades-bayes.html#métodos-monte-carlo" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="una-moneda" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Una moneda<a href="03-estimacion-densidades-bayes.html#una-moneda" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El tratamiento clásico de la estimación de parámetros bayesiana nos dice que si tenemos una densidad previa y la ``combinamos’’ con la verosimilitud de los datos, estos nos dará una densidad con más información. Se podría repetir el proceso varias veces para tratar de ajustar mejor la densidad posterior.</p>
<p>Sin embargo, se podría usar potencia de los métodos Monte Carlo para que esta búsqueda sea muy efectiva para encontrar los parámetros adecuados.</p>
<div id="ejemplo-del-viajero" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Ejemplo del viajero<a href="03-estimacion-densidades-bayes.html#ejemplo-del-viajero" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suponga que tenemos un viajero que quiere estar en 7 lugares distintos (suponga que están en línea recta) y la probabilidad de pasar a un lugar a otro se decide tirando una moneda no sesgada (50% a la derecha y 50% a la izquierda).</p>
<p>Este caso sería una simple caminata aleatoria sin ningún interés en particular.</p>
<p>Suponga además, que el viajero quiere estar más tiempo donde haya una mayor cantidad de personas <span class="math inline">\(P\)</span> pero siguiendo ese patrón aleatorio. Entonces la forma de describir su decisión de moverse sería:</p>
<ul>
<li>Tira la moneda y decide si va a la izquierda o la derecha.
<ol style="list-style-type: decimal">
<li><p>Si el lugar nuevo tiene personas que el actual salta a ese lugar.</p></li>
<li><p>Si el lugar nuevo tiene personas entonces el viajero tiene que decidir si se queda o se mueve. | calcula la probabilidad de moverse como <span class="math inline">\(p_{moverse} = P_{nuevo}/P_{actual}\)</span>.</p>
<p><strong>Tira un número aleatorio entre 0 y 1 <span class="math inline">\(r\)</span></strong></p>
<ol style="list-style-type: decimal">
<li>Si <span class="math inline">\(p_{moverse}&gt;r\)</span> entonces se mueve.</li>
<li>Sino, se queda donde está.</li>
</ol></li>
</ol></li>
</ul>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="03-estimacion-densidades-bayes.html#cb110-1" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span></span>
<span id="cb110-2"><a href="03-estimacion-densidades-bayes.html#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="03-estimacion-densidades-bayes.html#cb110-3" aria-hidden="true" tabindex="-1"></a>pos_actual <span class="ot">&lt;-</span> <span class="fu">sample</span>(P, <span class="dv">1</span>)</span>
<span id="cb110-4"><a href="03-estimacion-densidades-bayes.html#cb110-4" aria-hidden="true" tabindex="-1"></a>pos_nueva <span class="ot">&lt;-</span> pos_actual</span>
<span id="cb110-5"><a href="03-estimacion-densidades-bayes.html#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="03-estimacion-densidades-bayes.html#cb110-6" aria-hidden="true" tabindex="-1"></a>n_pasos <span class="ot">&lt;-</span> <span class="dv">50000</span></span>
<span id="cb110-7"><a href="03-estimacion-densidades-bayes.html#cb110-7" aria-hidden="true" tabindex="-1"></a>trayectoria <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_pasos)</span>
<span id="cb110-8"><a href="03-estimacion-densidades-bayes.html#cb110-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-9"><a href="03-estimacion-densidades-bayes.html#cb110-9" aria-hidden="true" tabindex="-1"></a>trayectoria[<span class="dv">1</span>] <span class="ot">&lt;-</span> pos_actual</span>
<span id="cb110-10"><a href="03-estimacion-densidades-bayes.html#cb110-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-11"><a href="03-estimacion-densidades-bayes.html#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_pasos) {</span>
<span id="cb110-12"><a href="03-estimacion-densidades-bayes.html#cb110-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tira la moneda para decidir</span></span>
<span id="cb110-13"><a href="03-estimacion-densidades-bayes.html#cb110-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-14"><a href="03-estimacion-densidades-bayes.html#cb110-14" aria-hidden="true" tabindex="-1"></a>    moneda <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb110-15"><a href="03-estimacion-densidades-bayes.html#cb110-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># moneda es 0 o 1</span></span>
<span id="cb110-16"><a href="03-estimacion-densidades-bayes.html#cb110-16" aria-hidden="true" tabindex="-1"></a>    pos_nueva <span class="ot">&lt;-</span> pos_actual</span>
<span id="cb110-17"><a href="03-estimacion-densidades-bayes.html#cb110-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (moneda <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> (pos_actual <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">&lt;=</span> <span class="dv">7</span>) {</span>
<span id="cb110-18"><a href="03-estimacion-densidades-bayes.html#cb110-18" aria-hidden="true" tabindex="-1"></a>        pos_nueva <span class="ot">=</span> pos_actual <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb110-19"><a href="03-estimacion-densidades-bayes.html#cb110-19" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (moneda <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> (pos_actual <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">&gt;=</span> <span class="dv">1</span>) {</span>
<span id="cb110-20"><a href="03-estimacion-densidades-bayes.html#cb110-20" aria-hidden="true" tabindex="-1"></a>        pos_nueva <span class="ot">&lt;-</span> pos_actual <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb110-21"><a href="03-estimacion-densidades-bayes.html#cb110-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb110-22"><a href="03-estimacion-densidades-bayes.html#cb110-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-23"><a href="03-estimacion-densidades-bayes.html#cb110-23" aria-hidden="true" tabindex="-1"></a>    p_moverse <span class="ot">&lt;-</span> <span class="fu">min</span>(pos_nueva<span class="sc">/</span>pos_actual, <span class="dv">1</span>)</span>
<span id="cb110-24"><a href="03-estimacion-densidades-bayes.html#cb110-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-25"><a href="03-estimacion-densidades-bayes.html#cb110-25" aria-hidden="true" tabindex="-1"></a>    hay_movimiento <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> p_moverse <span class="sc">&lt;=</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb110-26"><a href="03-estimacion-densidades-bayes.html#cb110-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-27"><a href="03-estimacion-densidades-bayes.html#cb110-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (hay_movimiento) {</span>
<span id="cb110-28"><a href="03-estimacion-densidades-bayes.html#cb110-28" aria-hidden="true" tabindex="-1"></a>        pos_actual <span class="ot">&lt;-</span> pos_nueva</span>
<span id="cb110-29"><a href="03-estimacion-densidades-bayes.html#cb110-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb110-30"><a href="03-estimacion-densidades-bayes.html#cb110-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-31"><a href="03-estimacion-densidades-bayes.html#cb110-31" aria-hidden="true" tabindex="-1"></a>    trayectoria[k] <span class="ot">&lt;-</span> pos_nueva</span>
<span id="cb110-32"><a href="03-estimacion-densidades-bayes.html#cb110-32" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="03-estimacion-densidades-bayes.html#cb111-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>n_pasos, <span class="at">P =</span> trayectoria)</span>
<span id="cb111-2"><a href="03-estimacion-densidades-bayes.html#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="03-estimacion-densidades-bayes.html#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df[<span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>, ]) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, P)) <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb111-4"><a href="03-estimacion-densidades-bayes.html#cb111-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-125-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="03-estimacion-densidades-bayes.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(P), <span class="at">stat =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">+</span></span>
<span id="cb112-2"><a href="03-estimacion-densidades-bayes.html#cb112-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-125-2.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="03-estimacion-densidades-bayes.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(trayectoria)</span></code></pre></div>
<pre><code>## [1] 4.86236</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="03-estimacion-densidades-bayes.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(trayectoria)</span></code></pre></div>
<pre><code>## [1] 1.79851</code></pre>
</div>
<div id="cadenas-de-markov" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Cadenas de Markov<a href="03-estimacion-densidades-bayes.html#cadenas-de-markov" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recuerde que estamos buscando el “camino” que el viajero tomará para pasar la mayor parte del tiempo de en los lugares más poblados (con mayor <span class="math inline">\(\theta\)</span>).</p>
<p><span class="math display">\[\begin{equation*}
\theta_{1} \curvearrowright \theta_{2} \curvearrowright \ldots \curvearrowright \theta_{50000}.
\end{equation*}\]</span></p>
<p>Denotamos <span class="math inline">\(\theta_{1}\to\theta_{2}\)</span> si el viajero pasó de <span class="math inline">\(\theta_{1}\)</span> hacia <span class="math inline">\(\theta_{2}\)</span>.</p>
<p>Entonces</p>
<ul>
<li><span class="math inline">\(\mathbb{P}\left(\theta \rightarrow \theta+1\right)=0.5 \min \left(\frac{P(\theta+1)}{P(\theta)} / , 1\right)\)</span></li>
<li><span class="math inline">\(\mathbb{P}\left(\theta + 1 \rightarrow \theta\right)=0.5 \min \left(\frac{P(\theta)}{P(\theta+1)} / , 1\right)\)</span></li>
</ul>
<p>Entonces la razón entre estas dos probabilidades es</p>
<p><span class="math display">\[\begin{align*}
    \frac{\mathbb{P}\left(\theta \rightarrow \theta+1\right)}{\mathbb{P}\left(\theta +1 \rightarrow \theta\right)}
      &amp; =\frac{0.5 \min (P(\theta+1) / P(\theta), 1)}{0.5 \min (P(\theta) / P(\theta+1), 1)} \\
      &amp; =\left\{\begin{array}{ll}
        \frac{P(\theta+1)}{P(\theta) }
          &amp; \text { si } P(\theta+1)&gt;P(\theta) \\
        \frac{P(\theta+1) }{P(\theta)}
          &amp; \text { si } P(\theta+1)&lt;P(\theta)
    \end{array}\right.                                             \\
    \, &amp; =\frac{P(\theta+1)}{P(\theta)}.
\end{align*}\]</span></p>
<p>Es decir que la razón de las probabilidades es equivalente a la razón entre las proporción de las poblaciones. Por lo tanto la mayoría de las veces se estará en los lugares con mayor población.</p>
<p>Esta cadena se puede escribir usando una matriz de transición de la forma</p>
<p><span class="math display">\[\begin{equation*}
T= \left(\begin{array}{ccccc}
\ddots &amp; \mathbb{P}(\theta-2 \rightarrow \theta-1) &amp; 0 &amp; 0 &amp; 0 \\
\ddots &amp; \mathbb{P}(\theta-1 \rightarrow \theta-1) &amp; \mathbb{P}(\theta-1 \rightarrow \theta) &amp; 0 &amp; 0 \\
0 &amp; \mathbb{P}(\theta \rightarrow \theta-1) &amp; \mathbb{P}(\theta \rightarrow \theta) &amp; \mathbb{P}(\theta \rightarrow \theta+1) &amp; 0 \\
0 &amp; 0 &amp; \mathbb{P}(\theta+1 \rightarrow \theta) &amp; \mathbb{P}(\theta+1 \rightarrow \theta+1) &amp; \ddots \\
0 &amp; 0 &amp; 0 &amp; \mathbb{P}(\theta+2 \rightarrow \theta+1) &amp; \ddots
\end{array}\right)
\end{equation*}\]</span></p>
<p>La matriz <span class="math inline">\(T\)</span> tiene las propiedades</p>
<ol style="list-style-type: decimal">
<li>Existencia de una única distribución estacionaria (llamada <span class="math inline">\(f\)</span> más adelante).</li>
<li>Es ergódica, i.e., es aperíodica y positiva recurrente. Recuerde que una cadena de markov es érgodica si siempre se puede pasar de un estado a otro (no necesariamente en 1 paso). Otra forma de verlo es que la para alguna potencia de <span class="math inline">\(T\)</span> todos los sus elementos serán positivos estrictos.</li>
</ol>
</div>
<div id="el-algoritmo-de-metropolis-hasting" class="section level3 hasAnchor" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> El algoritmo de Metropolis-Hasting<a href="03-estimacion-densidades-bayes.html#el-algoritmo-de-metropolis-hasting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El ejemplo anterior era bastante sencillo pero demuestra que se puede
encontrar el mejor estimador posible simplemente ejecutando una y otra
vez maximizando la estadía en los lugares más poblados.</p>
<p>En este ejemplo la función a maximizar es la cantidad de personas
<span class="math inline">\(P(\theta)=\theta\)</span>, pero en general nuestro objetivo será maximizar
la distribución posterior <span class="math inline">\(f(\theta| \text{ datos })\)</span>.</p>
<p>En palabras simples el algoritmo de Metropoli Hasting es</p>
<ol style="list-style-type: decimal">
<li>Simule un valor <span class="math inline">\(\theta^{*}\)</span> de una densidad de propuesta
<span class="math inline">\(p\left(\theta^{*} | \theta^{t-1}\right)\)</span></li>
<li>Estime la razón
<span class="math display">\[
R=\frac{f\left(\theta^{*}\right) L\left(\theta^{t-1} |
     \theta^{*}\right)}{f\left(\theta^{t-1}\right) L\left(\theta^{*} |
     \theta^{t-1}\right)}
\]</span></li>
<li>Estima la probabilidad de aceptación <span class="math inline">\(p_{\text {moverse }}=\min \{R, 1\}\)</span>.</li>
<li>Tome <span class="math inline">\(\theta^{t}\)</span> tal que <span class="math inline">\(\theta^{t}=\theta^{*}\)</span>
con probabilidad <span class="math inline">\(p_{\text {moverse }}\)</span>; en otro caso <span class="math inline">\(\theta^{t}=\)</span> <span class="math inline">\(\theta^{t-1}\)</span></li>
</ol>
<p>El algoritmo de Metropolis-Hastings se puede construir de muchas
formas, dependiendo de la densidad de proposición</p>
<p>Si esta es independiente de las elecciones anteriores entonces,
<span class="math display">\[
    L\left(\theta^{*} | \theta^{t-1}\right)=L\left(\theta^{*}\right)
\]</span></p>
<p>Otras formas es escoger
<span class="math display">\[
    L\left(\theta^{*} |
    \theta^{t-1}\right)=h\left(\theta^{*}-\theta^{t-1}\right)
\]</span>
donde <span class="math inline">\(h\)</span> es simétrica alrededor del origen. En este tipo de
cadenas, la razón <span class="math inline">\(R\)</span> tiene la forma
<span class="math display">\[
    R=\frac{f\left(\theta^{*}\right)}{f\left(\theta^{t-1}\right)}
\]</span></p>
<p>Una última opción es tomar
<span class="math display">\[
    \theta^{*}=\theta^{t-1}+ Z
\]</span></p>
<p>donde <span class="math inline">\(Z\)</span> es una normal centrada con cierta estructura de varianza.</p>
</div>
<div id="por-qué-el-algoritmo-de-metropolis-hasting-funciona" class="section level3 hasAnchor" number="4.4.4">
<h3><span class="header-section-number">4.4.4</span> ¿Por qué el algoritmo de Metropolis Hasting funciona?<a href="03-estimacion-densidades-bayes.html#por-qué-el-algoritmo-de-metropolis-hasting-funciona" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[\begin{equation}
\mathbb{P}\left(\theta_{\star} | \theta^{(t)}\right)=L\left(\theta_{\star} | \theta^{(t)}\right) \cdot \min \left\{1, \frac{f\left(\theta_{\star}\right) L\left(\theta^{(t)} | \theta_{\star}\right)}{f\left(\theta^{(t)}\right) L\left(\theta_{\star} | \theta^{(t)}\right)}\right\}
\end{equation}\]</span></p>
<p>Si se comienza en <span class="math inline">\(f\left(\theta^{(t)}\right)\)</span> entonces</p>
<p><span class="math display">\[\begin{align}
\begin{array}{l}
f\left(\theta^{(t)}\right) \mathbb{P}\left(\theta_{\star} | \theta^{(t)}\right) \\
\quad=\quad f\left(\theta^{(t)}\right) L\left(\theta_{\star} | \theta^{(t)}\right) \min \left\{1, \frac{f\left(\theta_{\star}\right) L\left(\theta^{(t)} | \theta_{\star}\right)}{f\left(\theta^{(t)}\right) L\left(\theta_{\star} | \theta^{(t)}\right)}\right\} \\
\quad=\min \left\{f\left(\theta^{(t)}\right) L\left(\theta_{\star} | \theta^{(t)}\right), f\left(\theta_{\star}\right) L\left(\theta^{(t)} | \theta_{\star}\right)\right\} \\
\quad=\quad f\left(\theta_{\star}\right) L\left(\theta^{(t)} | \theta_{\star}\right) \min \left\{\frac{f\left(\theta^{(t)}\right) L\left(\theta_{\star} | \theta^{(t)}\right)}{f\left(\theta_{\star}\right) L\left(\theta^{\left(t | \theta_{\star}\right)}\right.}, 1\right\} \\
\quad=f\left(\theta_{\star}\right) \mathbb{P}\left(\theta^{(t)} | \theta_{\star}\right)
\end{array}
\end{align}\]</span></p>
<p>Asumiendo que existe una cantidad finita de estados <span class="math inline">\(\theta_{1}, \ldots, \theta_{M}\)</span>, entonces.</p>
<p><span class="math display">\[\begin{equation*}
f\left(\theta_{j}\right) = \underbrace{\sum_{i=1}^{M} f\left(\theta_{i}\right) \mathbb{P} \left(\theta_{j} | \theta_{i}\right)}_{\text {Probabilidad total  }}=\sum_{i=1}^{M} f\left(\theta_{j}\right) \mathbb{P} \left(\theta_{i} | \theta_{j}\right)
\end{equation*}\]</span></p>
<p><span class="math display">\[\begin{equation}
f(\boldsymbol{\theta})^\top T =   f(\boldsymbol{\theta})
\end{equation}\]</span></p>
<p>Cual indica que no importa donde empecemos siempre llegaremos a la densidad estacionaria <span class="math inline">\(f\)</span>.</p>
<p><a href="https://www.ece.iastate.edu/~namrata/EE527_Spring08/l4c.pdf#page=32">https://www.ece.iastate.edu/~namrata/EE527_Spring08/l4c.pdf#page=32</a></p>
</div>
<div id="extensión-al-caso-del-viajero" class="section level3 hasAnchor" number="4.4.5">
<h3><span class="header-section-number">4.4.5</span> Extensión al caso del viajero<a href="03-estimacion-densidades-bayes.html#extensión-al-caso-del-viajero" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Retomemos el ejemplo del viajero. Supongamos que ahora existen una
cantidad infinita de lugares a los que puede ir y que la población de
cada isla es proporcional a la densidad posterior. Además, el viajero
podría saltar a cualquier isla que quisiera y su probabilidad de
salto cae de forma continua en el intervalo <span class="math inline">\([0,1]\)</span>.</p>
<p>Para hacer este ejemplo concreto, el viajero no conoce cuál es su
probabilidad de salto <span class="math inline">\(\theta\)</span> pero sabe que ha tirado la
moneda <span class="math inline">\(N\)</span> veces y observado <span class="math inline">\(z\)</span> exitos. Por lo tanto tendremos
una verosimilitud de <span class="math inline">\(L(z, N | \theta)=\theta^{z}(1-\theta)^{(N-z)}\)</span>.</p>
<p>La previa será dada por <span class="math inline">\(f(\theta)=\operatorname{beta}(\theta | a, b)\)</span>.</p>
<p>Los saltos serán gobernados por una normal centrada con media
<span class="math inline">\(\sigma\)</span> de modo que <span class="math inline">\(\Delta \theta \sim \mathcal{N}\left(0,\sigma^{2}\right)\)</span>.</p>
<p>Entonces el algoritmo de Metropolis Hasting se puede reformular como</p>
<ol style="list-style-type: decimal">
<li><p>Simule un valor de salto<span class="math inline">\(\Delta \theta \sim \mathcal{N}\left(0,\sigma^{2}\right)\)</span> y denote <span class="math inline">\(\theta^{t} = \theta^{t} + \Delta\theta\)</span>.</p></li>
<li><p>Probabilidad de aceptación <span class="math inline">\(p_{\text {moverse }}\)</span>
<span class="math display">\[\begin{align*}
p_{\text {moverse }}
   &amp; =\min \left(1, \frac{P\left(\theta_{\ast}\right)}{P\left(\theta_{t-1}\right)}\right) \\
               &amp; =\min \left(1, \frac{p\left(D |
     \theta_{\ast}\right) p\left(\theta_{\ast}\right)}{p\left(D | \theta_{t-1}\right)
     p\left(\theta_{t-1}\right)}\right) \\
   &amp; =\min \left(1, \frac{\operatorname{Bernoulli}\left(z, N |
     \theta_{\ast}\right)
     \operatorname{beta}\left(\theta_{\ast} | a,
     b\right)}{\operatorname{Bernoulli}\left(z, N |
     \theta_{t-1}\right)
     \operatorname{beta}\left(\theta_{t-1} | a, b\right)}\right) \\
   &amp; =\min \left(1,
\frac{\theta_{\ast}^{z}\left(1-\theta_{\ast}\right)^{(N-z)}
         \theta_{\ast} \left(1-\theta_{\ast}\right)^{(b-1)}
         / B(a,b)}{\theta_{t-1}^{z}\left(1-\theta_{t-1}\right)^{(N-z)}
         \theta_{t-1}^{(a-1)}\left(1-\theta_{t-1}\right)^{(b-1)}
         / B(a, b)}\right)
\end{align*}\]</span></p></li>
<li><p>Tome <span class="math inline">\(\theta_{t}\)</span> tal que <span class="math inline">\(\theta_{t}=\theta_{*}\)</span>
con probabilidad <span class="math inline">\(p_{\text {moverse }} ;\)</span> en otro caso <span class="math inline">\(\theta_{t}=\)</span> <span class="math inline">\(\theta_{t-1}\)</span></p></li>
</ol>
<p>En el ejemplo del viajero queremos ver la probabilidad <span class="math inline">\(\theta\)</span> de
que salte al siguiente destino. Tomemos <span class="math inline">\(\sigma=0.2\)</span> y supongamos
que se ha visto que el viajero de <span class="math inline">\(N=20\)</span> y <span class="math inline">\(z=14\)</span> éxitos. Por
cuestiones de practicidad se tomará <span class="math inline">\(\theta_0 = 0.1\)</span>.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="03-estimacion-densidades-bayes.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Carga de datos observados</span></span>
<span id="cb117-2"><a href="03-estimacion-densidades-bayes.html#cb117-2" aria-hidden="true" tabindex="-1"></a>datos_observados <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">6</span>), <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">14</span>))</span>
<span id="cb117-3"><a href="03-estimacion-densidades-bayes.html#cb117-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-4"><a href="03-estimacion-densidades-bayes.html#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Funci&lt;U+00F3&gt;n de verosimilitud Binomial</span></span>
<span id="cb117-5"><a href="03-estimacion-densidades-bayes.html#cb117-5" aria-hidden="true" tabindex="-1"></a>verosimilitud <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, data) {</span>
<span id="cb117-6"><a href="03-estimacion-densidades-bayes.html#cb117-6" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">&lt;-</span> <span class="fu">sum</span>(data)</span>
<span id="cb117-7"><a href="03-estimacion-densidades-bayes.html#cb117-7" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> <span class="fu">length</span>(data)</span>
<span id="cb117-8"><a href="03-estimacion-densidades-bayes.html#cb117-8" aria-hidden="true" tabindex="-1"></a>    pDatosDadoTheta <span class="ot">&lt;-</span> theta<span class="sc">^</span>z <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> theta)<span class="sc">^</span>(N <span class="sc">-</span> z)</span>
<span id="cb117-9"><a href="03-estimacion-densidades-bayes.html#cb117-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Es para asegurarse que los datos caigan en</span></span>
<span id="cb117-10"><a href="03-estimacion-densidades-bayes.html#cb117-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># [0,1].</span></span>
<span id="cb117-11"><a href="03-estimacion-densidades-bayes.html#cb117-11" aria-hidden="true" tabindex="-1"></a>    pDatosDadoTheta[theta <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">|</span> theta <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb117-12"><a href="03-estimacion-densidades-bayes.html#cb117-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(pDatosDadoTheta)</span>
<span id="cb117-13"><a href="03-estimacion-densidades-bayes.html#cb117-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb117-14"><a href="03-estimacion-densidades-bayes.html#cb117-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-15"><a href="03-estimacion-densidades-bayes.html#cb117-15" aria-hidden="true" tabindex="-1"></a><span class="co"># densidad previa</span></span>
<span id="cb117-16"><a href="03-estimacion-densidades-bayes.html#cb117-16" aria-hidden="true" tabindex="-1"></a>previa <span class="ot">&lt;-</span> <span class="cf">function</span>(theta) {</span>
<span id="cb117-17"><a href="03-estimacion-densidades-bayes.html#cb117-17" aria-hidden="true" tabindex="-1"></a>    pTheta <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(theta, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb117-18"><a href="03-estimacion-densidades-bayes.html#cb117-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Es para asegurarse que los datos caigan en</span></span>
<span id="cb117-19"><a href="03-estimacion-densidades-bayes.html#cb117-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># [0,1].</span></span>
<span id="cb117-20"><a href="03-estimacion-densidades-bayes.html#cb117-20" aria-hidden="true" tabindex="-1"></a>    pTheta[theta <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">|</span> theta <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb117-21"><a href="03-estimacion-densidades-bayes.html#cb117-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(pTheta)</span>
<span id="cb117-22"><a href="03-estimacion-densidades-bayes.html#cb117-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb117-23"><a href="03-estimacion-densidades-bayes.html#cb117-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-24"><a href="03-estimacion-densidades-bayes.html#cb117-24" aria-hidden="true" tabindex="-1"></a><span class="co"># densidad posterior</span></span>
<span id="cb117-25"><a href="03-estimacion-densidades-bayes.html#cb117-25" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, data) {</span>
<span id="cb117-26"><a href="03-estimacion-densidades-bayes.html#cb117-26" aria-hidden="true" tabindex="-1"></a>    posterior <span class="ot">&lt;-</span> <span class="fu">verosimilitud</span>(theta, data) <span class="sc">*</span> <span class="fu">previa</span>(theta)</span>
<span id="cb117-27"><a href="03-estimacion-densidades-bayes.html#cb117-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(posterior)</span>
<span id="cb117-28"><a href="03-estimacion-densidades-bayes.html#cb117-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb117-29"><a href="03-estimacion-densidades-bayes.html#cb117-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-30"><a href="03-estimacion-densidades-bayes.html#cb117-30" aria-hidden="true" tabindex="-1"></a>n_pasos <span class="ot">&lt;-</span> <span class="dv">50000</span></span>
<span id="cb117-31"><a href="03-estimacion-densidades-bayes.html#cb117-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-32"><a href="03-estimacion-densidades-bayes.html#cb117-32" aria-hidden="true" tabindex="-1"></a>trayectoria <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_pasos)</span>
<span id="cb117-33"><a href="03-estimacion-densidades-bayes.html#cb117-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-34"><a href="03-estimacion-densidades-bayes.html#cb117-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Valor inicial</span></span>
<span id="cb117-35"><a href="03-estimacion-densidades-bayes.html#cb117-35" aria-hidden="true" tabindex="-1"></a>trayectoria[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb117-36"><a href="03-estimacion-densidades-bayes.html#cb117-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-37"><a href="03-estimacion-densidades-bayes.html#cb117-37" aria-hidden="true" tabindex="-1"></a>n_aceptados <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb117-38"><a href="03-estimacion-densidades-bayes.html#cb117-38" aria-hidden="true" tabindex="-1"></a>n_rechazados <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb117-39"><a href="03-estimacion-densidades-bayes.html#cb117-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-40"><a href="03-estimacion-densidades-bayes.html#cb117-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-41"><a href="03-estimacion-densidades-bayes.html#cb117-41" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb117-42"><a href="03-estimacion-densidades-bayes.html#cb117-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-43"><a href="03-estimacion-densidades-bayes.html#cb117-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(n_pasos <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb117-44"><a href="03-estimacion-densidades-bayes.html#cb117-44" aria-hidden="true" tabindex="-1"></a>    pos_actual <span class="ot">&lt;-</span> trayectoria[t]</span>
<span id="cb117-45"><a href="03-estimacion-densidades-bayes.html#cb117-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-46"><a href="03-estimacion-densidades-bayes.html#cb117-46" aria-hidden="true" tabindex="-1"></a>    salto_propuesto <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma)</span>
<span id="cb117-47"><a href="03-estimacion-densidades-bayes.html#cb117-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-48"><a href="03-estimacion-densidades-bayes.html#cb117-48" aria-hidden="true" tabindex="-1"></a>    proba_aceptacion <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">1</span>, <span class="fu">posterior</span>(pos_actual <span class="sc">+</span></span>
<span id="cb117-49"><a href="03-estimacion-densidades-bayes.html#cb117-49" aria-hidden="true" tabindex="-1"></a>        salto_propuesto, datos_observados)<span class="sc">/</span><span class="fu">posterior</span>(pos_actual,</span>
<span id="cb117-50"><a href="03-estimacion-densidades-bayes.html#cb117-50" aria-hidden="true" tabindex="-1"></a>        datos_observados))</span>
<span id="cb117-51"><a href="03-estimacion-densidades-bayes.html#cb117-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-52"><a href="03-estimacion-densidades-bayes.html#cb117-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Aceptamos el salto?</span></span>
<span id="cb117-53"><a href="03-estimacion-densidades-bayes.html#cb117-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> proba_aceptacion) {</span>
<span id="cb117-54"><a href="03-estimacion-densidades-bayes.html#cb117-54" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Aceptados</span></span>
<span id="cb117-55"><a href="03-estimacion-densidades-bayes.html#cb117-55" aria-hidden="true" tabindex="-1"></a>        trayectoria[t <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> pos_actual <span class="sc">+</span> salto_propuesto</span>
<span id="cb117-56"><a href="03-estimacion-densidades-bayes.html#cb117-56" aria-hidden="true" tabindex="-1"></a>        n_aceptados <span class="ot">&lt;-</span> n_aceptados <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb117-57"><a href="03-estimacion-densidades-bayes.html#cb117-57" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb117-58"><a href="03-estimacion-densidades-bayes.html#cb117-58" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Rechazos</span></span>
<span id="cb117-59"><a href="03-estimacion-densidades-bayes.html#cb117-59" aria-hidden="true" tabindex="-1"></a>        trayectoria[t <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> pos_actual</span>
<span id="cb117-60"><a href="03-estimacion-densidades-bayes.html#cb117-60" aria-hidden="true" tabindex="-1"></a>        n_rechazados <span class="ot">&lt;-</span> n_rechazados <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb117-61"><a href="03-estimacion-densidades-bayes.html#cb117-61" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb117-62"><a href="03-estimacion-densidades-bayes.html#cb117-62" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Obtenemos una tasa de aceptación del 49.43 y tasa de rechazo del 50.56</p>
<p>Podemos desechar los primeros 500 pasos (por ejemplo) del proceso ya que estos son de “calentamiento”. De esta forma podremos estimar la media y la varianza de las trayectoria.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="03-estimacion-densidades-bayes.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(trayectoria[<span class="dv">500</span><span class="sc">:</span>n_pasos])</span></code></pre></div>
<pre><code>## [1] 0.6801115</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="03-estimacion-densidades-bayes.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(trayectoria[<span class="dv">500</span><span class="sc">:</span>n_pasos])</span></code></pre></div>
<pre><code>## [1] 0.09718668</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="03-estimacion-densidades-bayes.html#cb122-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>n_pasos, <span class="at">P =</span> trayectoria)</span>
<span id="cb122-2"><a href="03-estimacion-densidades-bayes.html#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="03-estimacion-densidades-bayes.html#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df[<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>, ]) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, P), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb122-4"><a href="03-estimacion-densidades-bayes.html#cb122-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-129-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="03-estimacion-densidades-bayes.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df[<span class="dv">500</span><span class="sc">:</span>n_pasos, ]) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(P, <span class="at">y =</span> ..density..),</span>
<span id="cb123-2"><a href="03-estimacion-densidades-bayes.html#cb123-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-129-2.svg" width="70%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="dos-monedas" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Dos monedas<a href="03-estimacion-densidades-bayes.html#dos-monedas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Un problema con el algoritmo de Metropolis-Hastings (M-H) es que solo funciona para la estimación de un solo parámetro.</p>
<p>El muestreo de Gibbs está pensado en el caso de la estimación de muchos parámetros de forma bastante ordenada.</p>
<p>Supongamos que tenemos dos monedas y queremos ver la proporción de escudos generados entre las dos monedas:</p>
<p>Tenemos:</p>
<ul>
<li>Parámetros: <span class="math inline">\(\theta_{1}\)</span> y <span class="math inline">\(\theta_{2}\)</span>.</li>
<li>Datos: <span class="math inline">\(N_{1}\)</span> tiradas de la moneda 1 y <span class="math inline">\(N_{2}\)</span> tiradas de la moneda 2. (cada una tuvo <span class="math inline">\(z_{1}\)</span> y <span class="math inline">\(z_{2}\)</span> éxitos).</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><p>Verosimilitud: Bernoulli.
<span class="math display">\[\begin{equation*}
y_{1}^{i}\sim \mathrm{Bernoulli}(\theta_{1})
\quad
y_{2}^{i}\sim \mathrm{Bernoulli}(\theta_{2})
\end{equation*}\]</span></p></li>
<li><p>Previa: Beta independiente para cada <span class="math inline">\(\theta\)</span>.
<span class="math display">\[\begin{equation*}
\theta_{1}\sim \mathrm{Beta}(a_{1},b_{1})
\quad
\theta_{2}\sim \mathrm{Beta}(a_{2},b_{2})
\end{equation*}\]</span></p></li>
</ol>
<p>La distribución posterior se puede escribir como</p>
<p><span class="math display">\[\begin{align*}
f\left(\theta_{1}, \theta_{2} | D\right)
&amp;=f\left(D | \theta_{1}, \theta_{2}\right) \frac{f\left(\theta_{1}, \theta_{2}\right)}{f(D)} \\
&amp;=\theta_{1}^{z_{1}}\left(1-\theta_{1}\right)^{N_{1}-z_{1}} \theta_{1}^{z_{2}}\left(1-\theta_{2}\right)^{N_{2}-z_{2}} \frac{f\left(\theta_{1}, \theta_{2}\right)}{f(D)}  \\
&amp;=\frac{\theta_{1}^{z_{1}}\left(1-\theta_{1}\right)^{N_{1}-z_{1}} \theta_{1}^{z_{2}}\left(1-\theta_{2}\right)^{N_{2}-z_{2}} \theta_{1}^{a_{1}-1}\left(1-\theta_{1}\right)^{b_{1}-1} \theta_{2}^{a_{2}-1}\left(1-\theta_{2}\right)^{b_{2}-1}}{f(D) B\left(a_{1}, b_{1}\right) B\left(a_{2}, b_{2}\right)} \\
&amp;=\frac{\theta_{1}^{z_{1}+a_{1}-1}\left(1-\theta_{1}\right)^{N_{1}-z_{1}+b_{1}-1} \theta_{2}^{z_{2}+a_{2}-1}\left(1-\theta_{2}\right)^{N_{2}-z_{2}+b_{2}-1}}{f(D) B\left(a_{1}, b_{1}\right) B\left(a_{2}, b_{2}\right)}
\end{align*}\]</span>
Entonces la distribución posterior de <span class="math inline">\(\left(\theta_{1}, \theta_{2}\right)\)</span> son dos distribuciones independientes Betas:
<span class="math inline">\(\operatorname{Beta}\left(z_{1}+a, N_{1}-z_{1}+b_{1}\right)\)</span> y <span class="math inline">\(\operatorname{Beta}\left(z_{2}+a, N_{2}-z_{2}+b_{2}\right)\)</span></p>
<p>Tratemos de encontrar los parámetros para la distribución posterior usando un algoritmo de Metropolis-Hasting. <a href="https://rpruim.github.io/Kruschke-Notes/markov-chain-monte-carlo-mcmc.html#metropolis">Función tomada de Kruschke-Notes</a></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="03-estimacion-densidades-bayes.html#cb124-1" aria-hidden="true" tabindex="-1"></a>metro_2coins <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb124-2"><a href="03-estimacion-densidades-bayes.html#cb124-2" aria-hidden="true" tabindex="-1"></a>  z1, n1,              <span class="co"># z = successes, n = trials</span></span>
<span id="cb124-3"><a href="03-estimacion-densidades-bayes.html#cb124-3" aria-hidden="true" tabindex="-1"></a>  z2, n2,              <span class="co"># z = successes, n = trials</span></span>
<span id="cb124-4"><a href="03-estimacion-densidades-bayes.html#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">size  =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>), <span class="co"># sds of jump distribution</span></span>
<span id="cb124-5"><a href="03-estimacion-densidades-bayes.html#cb124-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="co"># value of thetas to start at</span></span>
<span id="cb124-6"><a href="03-estimacion-densidades-bayes.html#cb124-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_steps =</span> <span class="fl">5e4</span>,     <span class="co"># number of steps to run the algorithm</span></span>
<span id="cb124-7"><a href="03-estimacion-densidades-bayes.html#cb124-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior1 =</span> dbeta,      <span class="co"># function describing prior</span></span>
<span id="cb124-8"><a href="03-estimacion-densidades-bayes.html#cb124-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior2 =</span> dbeta,      <span class="co"># function describing prior</span></span>
<span id="cb124-9"><a href="03-estimacion-densidades-bayes.html#cb124-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">args1 =</span> <span class="fu">list</span>(),      <span class="co"># additional args for prior1</span></span>
<span id="cb124-10"><a href="03-estimacion-densidades-bayes.html#cb124-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">args2 =</span> <span class="fu">list</span>()      <span class="co"># additional args for prior2</span></span>
<span id="cb124-11"><a href="03-estimacion-densidades-bayes.html#cb124-11" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb124-12"><a href="03-estimacion-densidades-bayes.html#cb124-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-13"><a href="03-estimacion-densidades-bayes.html#cb124-13" aria-hidden="true" tabindex="-1"></a>  theta1            <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, num_steps)  <span class="co"># trick to pre-alocate memory</span></span>
<span id="cb124-14"><a href="03-estimacion-densidades-bayes.html#cb124-14" aria-hidden="true" tabindex="-1"></a>  theta2            <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, num_steps)  <span class="co"># trick to pre-alocate memory</span></span>
<span id="cb124-15"><a href="03-estimacion-densidades-bayes.html#cb124-15" aria-hidden="true" tabindex="-1"></a>  proposed_theta1   <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, num_steps)  <span class="co"># trick to pre-alocate memory</span></span>
<span id="cb124-16"><a href="03-estimacion-densidades-bayes.html#cb124-16" aria-hidden="true" tabindex="-1"></a>  proposed_theta2   <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, num_steps)  <span class="co"># trick to pre-alocate memory</span></span>
<span id="cb124-17"><a href="03-estimacion-densidades-bayes.html#cb124-17" aria-hidden="true" tabindex="-1"></a>  move              <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, num_steps)  <span class="co"># trick to pre-alocate memory</span></span>
<span id="cb124-18"><a href="03-estimacion-densidades-bayes.html#cb124-18" aria-hidden="true" tabindex="-1"></a>  theta1[<span class="dv">1</span>]         <span class="ot">&lt;-</span> start[<span class="dv">1</span>]</span>
<span id="cb124-19"><a href="03-estimacion-densidades-bayes.html#cb124-19" aria-hidden="true" tabindex="-1"></a>  theta2[<span class="dv">1</span>]         <span class="ot">&lt;-</span> start[<span class="dv">2</span>]</span>
<span id="cb124-20"><a href="03-estimacion-densidades-bayes.html#cb124-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-21"><a href="03-estimacion-densidades-bayes.html#cb124-21" aria-hidden="true" tabindex="-1"></a>  size1 <span class="ot">&lt;-</span> size[<span class="dv">1</span>] </span>
<span id="cb124-22"><a href="03-estimacion-densidades-bayes.html#cb124-22" aria-hidden="true" tabindex="-1"></a>  size2 <span class="ot">&lt;-</span> size[<span class="dv">2</span>] </span>
<span id="cb124-23"><a href="03-estimacion-densidades-bayes.html#cb124-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-24"><a href="03-estimacion-densidades-bayes.html#cb124-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(num_steps<span class="dv">-1</span>)) {</span>
<span id="cb124-25"><a href="03-estimacion-densidades-bayes.html#cb124-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># head to new &quot;island&quot;</span></span>
<span id="cb124-26"><a href="03-estimacion-densidades-bayes.html#cb124-26" aria-hidden="true" tabindex="-1"></a>    proposed_theta1[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, theta1[i], size1)</span>
<span id="cb124-27"><a href="03-estimacion-densidades-bayes.html#cb124-27" aria-hidden="true" tabindex="-1"></a>    proposed_theta2[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, theta2[i], size2)</span>
<span id="cb124-28"><a href="03-estimacion-densidades-bayes.html#cb124-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb124-29"><a href="03-estimacion-densidades-bayes.html#cb124-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (proposed_theta1[i <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">||</span></span>
<span id="cb124-30"><a href="03-estimacion-densidades-bayes.html#cb124-30" aria-hidden="true" tabindex="-1"></a>        proposed_theta1[i <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">||</span></span>
<span id="cb124-31"><a href="03-estimacion-densidades-bayes.html#cb124-31" aria-hidden="true" tabindex="-1"></a>        proposed_theta2[i <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">||</span></span>
<span id="cb124-32"><a href="03-estimacion-densidades-bayes.html#cb124-32" aria-hidden="true" tabindex="-1"></a>        proposed_theta2[i <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">&gt;=</span> <span class="dv">1</span>) {</span>
<span id="cb124-33"><a href="03-estimacion-densidades-bayes.html#cb124-33" aria-hidden="true" tabindex="-1"></a>      proposed_posterior <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># because prior is 0</span></span>
<span id="cb124-34"><a href="03-estimacion-densidades-bayes.html#cb124-34" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb124-35"><a href="03-estimacion-densidades-bayes.html#cb124-35" aria-hidden="true" tabindex="-1"></a>      current_prior <span class="ot">&lt;-</span> </span>
<span id="cb124-36"><a href="03-estimacion-densidades-bayes.html#cb124-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">do.call</span>(prior1, <span class="fu">c</span>(<span class="fu">list</span>(theta1[i]), args1)) <span class="sc">*</span></span>
<span id="cb124-37"><a href="03-estimacion-densidades-bayes.html#cb124-37" aria-hidden="true" tabindex="-1"></a>        <span class="fu">do.call</span>(prior2, <span class="fu">c</span>(<span class="fu">list</span>(theta2[i]), args2))</span>
<span id="cb124-38"><a href="03-estimacion-densidades-bayes.html#cb124-38" aria-hidden="true" tabindex="-1"></a>      current_likelihood  <span class="ot">&lt;-</span> </span>
<span id="cb124-39"><a href="03-estimacion-densidades-bayes.html#cb124-39" aria-hidden="true" tabindex="-1"></a>        <span class="fu">dbinom</span>(z1, n1, theta1[i]) <span class="sc">*</span></span>
<span id="cb124-40"><a href="03-estimacion-densidades-bayes.html#cb124-40" aria-hidden="true" tabindex="-1"></a>        <span class="fu">dbinom</span>(z2, n2, theta2[i])</span>
<span id="cb124-41"><a href="03-estimacion-densidades-bayes.html#cb124-41" aria-hidden="true" tabindex="-1"></a>      current_posterior   <span class="ot">&lt;-</span> current_prior <span class="sc">*</span> current_likelihood</span>
<span id="cb124-42"><a href="03-estimacion-densidades-bayes.html#cb124-42" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb124-43"><a href="03-estimacion-densidades-bayes.html#cb124-43" aria-hidden="true" tabindex="-1"></a>      proposed_prior <span class="ot">&lt;-</span> </span>
<span id="cb124-44"><a href="03-estimacion-densidades-bayes.html#cb124-44" aria-hidden="true" tabindex="-1"></a>        <span class="fu">do.call</span>(prior1, <span class="fu">c</span>(<span class="fu">list</span>(proposed_theta1[i<span class="sc">+</span><span class="dv">1</span>]), args1)) <span class="sc">*</span></span>
<span id="cb124-45"><a href="03-estimacion-densidades-bayes.html#cb124-45" aria-hidden="true" tabindex="-1"></a>        <span class="fu">do.call</span>(prior2, <span class="fu">c</span>(<span class="fu">list</span>(proposed_theta2[i<span class="sc">+</span><span class="dv">1</span>]), args2))</span>
<span id="cb124-46"><a href="03-estimacion-densidades-bayes.html#cb124-46" aria-hidden="true" tabindex="-1"></a>      proposed_likelihood  <span class="ot">&lt;-</span> </span>
<span id="cb124-47"><a href="03-estimacion-densidades-bayes.html#cb124-47" aria-hidden="true" tabindex="-1"></a>        <span class="fu">dbinom</span>(z1, n1, proposed_theta1[i<span class="sc">+</span><span class="dv">1</span>]) <span class="sc">*</span></span>
<span id="cb124-48"><a href="03-estimacion-densidades-bayes.html#cb124-48" aria-hidden="true" tabindex="-1"></a>        <span class="fu">dbinom</span>(z2, n2, proposed_theta2[i<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb124-49"><a href="03-estimacion-densidades-bayes.html#cb124-49" aria-hidden="true" tabindex="-1"></a>      proposed_posterior   <span class="ot">&lt;-</span> proposed_prior <span class="sc">*</span> proposed_likelihood</span>
<span id="cb124-50"><a href="03-estimacion-densidades-bayes.html#cb124-50" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb124-51"><a href="03-estimacion-densidades-bayes.html#cb124-51" aria-hidden="true" tabindex="-1"></a>    prob_move           <span class="ot">&lt;-</span> proposed_posterior <span class="sc">/</span> current_posterior</span>
<span id="cb124-52"><a href="03-estimacion-densidades-bayes.html#cb124-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb124-53"><a href="03-estimacion-densidades-bayes.html#cb124-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sometimes we &quot;sail back&quot;</span></span>
<span id="cb124-54"><a href="03-estimacion-densidades-bayes.html#cb124-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&gt;</span> prob_move) { <span class="co"># sail back</span></span>
<span id="cb124-55"><a href="03-estimacion-densidades-bayes.html#cb124-55" aria-hidden="true" tabindex="-1"></a>       move[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb124-56"><a href="03-estimacion-densidades-bayes.html#cb124-56" aria-hidden="true" tabindex="-1"></a>      theta1[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> theta1[i]</span>
<span id="cb124-57"><a href="03-estimacion-densidades-bayes.html#cb124-57" aria-hidden="true" tabindex="-1"></a>      theta2[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> theta2[i]</span>
<span id="cb124-58"><a href="03-estimacion-densidades-bayes.html#cb124-58" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {                    <span class="co"># stay</span></span>
<span id="cb124-59"><a href="03-estimacion-densidades-bayes.html#cb124-59" aria-hidden="true" tabindex="-1"></a>       move[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb124-60"><a href="03-estimacion-densidades-bayes.html#cb124-60" aria-hidden="true" tabindex="-1"></a>      theta1[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> proposed_theta1[i <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb124-61"><a href="03-estimacion-densidades-bayes.html#cb124-61" aria-hidden="true" tabindex="-1"></a>      theta2[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> proposed_theta2[i <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb124-62"><a href="03-estimacion-densidades-bayes.html#cb124-62" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb124-63"><a href="03-estimacion-densidades-bayes.html#cb124-63" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb124-64"><a href="03-estimacion-densidades-bayes.html#cb124-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-65"><a href="03-estimacion-densidades-bayes.html#cb124-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb124-66"><a href="03-estimacion-densidades-bayes.html#cb124-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">step =</span> <span class="dv">1</span><span class="sc">:</span>num_steps, </span>
<span id="cb124-67"><a href="03-estimacion-densidades-bayes.html#cb124-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta1 =</span> theta1,</span>
<span id="cb124-68"><a href="03-estimacion-densidades-bayes.html#cb124-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta2 =</span> theta2,</span>
<span id="cb124-69"><a href="03-estimacion-densidades-bayes.html#cb124-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">proposed_theta1 =</span> proposed_theta1,</span>
<span id="cb124-70"><a href="03-estimacion-densidades-bayes.html#cb124-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">proposed_theta2 =</span> proposed_theta2,</span>
<span id="cb124-71"><a href="03-estimacion-densidades-bayes.html#cb124-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">move =</span> move, </span>
<span id="cb124-72"><a href="03-estimacion-densidades-bayes.html#cb124-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">size1 =</span> size1,</span>
<span id="cb124-73"><a href="03-estimacion-densidades-bayes.html#cb124-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">size2 =</span> size2</span>
<span id="cb124-74"><a href="03-estimacion-densidades-bayes.html#cb124-74" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb124-75"><a href="03-estimacion-densidades-bayes.html#cb124-75" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="03-estimacion-densidades-bayes.html#cb125-1" aria-hidden="true" tabindex="-1"></a>Metro_2coinsA <span class="ot">&lt;-</span> <span class="fu">metro_2coins</span>(<span class="at">z1 =</span> <span class="dv">6</span>, <span class="at">n1 =</span> <span class="dv">8</span>, <span class="at">z2 =</span> <span class="dv">2</span>,</span>
<span id="cb125-2"><a href="03-estimacion-densidades-bayes.html#cb125-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">n2 =</span> <span class="dv">7</span>, <span class="at">size =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.02</span>), <span class="at">args1 =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="dv">2</span>,</span>
<span id="cb125-3"><a href="03-estimacion-densidades-bayes.html#cb125-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">shape2 =</span> <span class="dv">2</span>), <span class="at">args2 =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="dv">2</span>, <span class="at">shape2 =</span> <span class="dv">2</span>))</span>
<span id="cb125-4"><a href="03-estimacion-densidades-bayes.html#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="03-estimacion-densidades-bayes.html#cb125-5" aria-hidden="true" tabindex="-1"></a>Metro_2coinsA <span class="sc">%&gt;%</span></span>
<span id="cb125-6"><a href="03-estimacion-densidades-bayes.html#cb125-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_density2d</span>(theta2 <span class="sc">~</span> theta1)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-131-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="03-estimacion-densidades-bayes.html#cb126-1" aria-hidden="true" tabindex="-1"></a>Metro_2coinsA <span class="sc">%&gt;%</span></span>
<span id="cb126-2"><a href="03-estimacion-densidades-bayes.html#cb126-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_density</span>(<span class="sc">~</span>(theta2 <span class="sc">-</span> theta1))</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-131-2.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="03-estimacion-densidades-bayes.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(Metro_2coinsA<span class="sc">$</span>theta2 <span class="sc">-</span> Metro_2coinsA<span class="sc">$</span>theta1)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-131-3.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="03-estimacion-densidades-bayes.html#cb128-1" aria-hidden="true" tabindex="-1"></a>Metro_2coinsA <span class="sc">%&gt;%</span></span>
<span id="cb128-2"><a href="03-estimacion-densidades-bayes.html#cb128-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(step <span class="sc">&lt;</span> <span class="dv">500</span>) <span class="sc">%&gt;%</span></span>
<span id="cb128-3"><a href="03-estimacion-densidades-bayes.html#cb128-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_path</span>(theta2 <span class="sc">~</span> theta1, <span class="at">color =</span> <span class="sc">~</span>step, <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb128-4"><a href="03-estimacion-densidades-bayes.html#cb128-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">&quot;open&quot;</span>, <span class="at">angle =</span> <span class="dv">30</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>,</span>
<span id="cb128-5"><a href="03-estimacion-densidades-bayes.html#cb128-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;inches&quot;</span>))) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-132-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="03-estimacion-densidades-bayes.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb129-2"><a href="03-estimacion-densidades-bayes.html#cb129-2" aria-hidden="true" tabindex="-1"></a>Metro_2coinsAplot <span class="ot">&lt;-</span> Metro_2coinsA <span class="sc">%&gt;%</span></span>
<span id="cb129-3"><a href="03-estimacion-densidades-bayes.html#cb129-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(step <span class="sc">&lt;</span> <span class="dv">500</span>) <span class="sc">%&gt;%</span></span>
<span id="cb129-4"><a href="03-estimacion-densidades-bayes.html#cb129-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_path</span>(theta2 <span class="sc">~</span> theta1, <span class="at">color =</span> <span class="sc">~</span>step, <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb129-5"><a href="03-estimacion-densidades-bayes.html#cb129-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">&quot;open&quot;</span>, <span class="at">angle =</span> <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb129-6"><a href="03-estimacion-densidades-bayes.html#cb129-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">transition_reveal</span>(step)</span>
<span id="cb129-7"><a href="03-estimacion-densidades-bayes.html#cb129-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-8"><a href="03-estimacion-densidades-bayes.html#cb129-8" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(Metro_2coinsAplot, <span class="at">fps =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="03-estimacion-densidades-bayes.html#cb130-1" aria-hidden="true" tabindex="-1"></a>Metro_2coinsB <span class="ot">&lt;-</span> <span class="fu">metro_2coins</span>(<span class="at">z1 =</span> <span class="dv">6</span>, <span class="at">n1 =</span> <span class="dv">8</span>, <span class="at">z2 =</span> <span class="dv">2</span>,</span>
<span id="cb130-2"><a href="03-estimacion-densidades-bayes.html#cb130-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">n2 =</span> <span class="dv">7</span>, <span class="at">size =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>), <span class="at">args1 =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="dv">2</span>,</span>
<span id="cb130-3"><a href="03-estimacion-densidades-bayes.html#cb130-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">shape2 =</span> <span class="dv">2</span>), <span class="at">args2 =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="dv">2</span>, <span class="at">shape2 =</span> <span class="dv">2</span>))</span>
<span id="cb130-4"><a href="03-estimacion-densidades-bayes.html#cb130-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5"><a href="03-estimacion-densidades-bayes.html#cb130-5" aria-hidden="true" tabindex="-1"></a>Metro_2coinsB <span class="sc">%&gt;%</span></span>
<span id="cb130-6"><a href="03-estimacion-densidades-bayes.html#cb130-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_density2d</span>(theta2 <span class="sc">~</span> theta1)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-135-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="03-estimacion-densidades-bayes.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(Metro_2coinsB<span class="sc">$</span>theta2 <span class="sc">-</span> Metro_2coinsB<span class="sc">$</span>theta1)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-135-2.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="03-estimacion-densidades-bayes.html#cb132-1" aria-hidden="true" tabindex="-1"></a>Metro_2coinsB <span class="sc">%&gt;%</span></span>
<span id="cb132-2"><a href="03-estimacion-densidades-bayes.html#cb132-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(step <span class="sc">&lt;</span> <span class="dv">500</span>) <span class="sc">%&gt;%</span></span>
<span id="cb132-3"><a href="03-estimacion-densidades-bayes.html#cb132-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_path</span>(theta2 <span class="sc">~</span> theta1, <span class="at">color =</span> <span class="sc">~</span>step, <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb132-4"><a href="03-estimacion-densidades-bayes.html#cb132-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">&quot;open&quot;</span>, <span class="at">angle =</span> <span class="dv">30</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>,</span>
<span id="cb132-5"><a href="03-estimacion-densidades-bayes.html#cb132-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;inches&quot;</span>))) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-136-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="03-estimacion-densidades-bayes.html#cb133-1" aria-hidden="true" tabindex="-1"></a>Metro_2coinsBplot <span class="ot">&lt;-</span> Metro_2coinsA <span class="sc">%&gt;%</span></span>
<span id="cb133-2"><a href="03-estimacion-densidades-bayes.html#cb133-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(step <span class="sc">&lt;</span> <span class="dv">500</span>) <span class="sc">%&gt;%</span></span>
<span id="cb133-3"><a href="03-estimacion-densidades-bayes.html#cb133-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_path</span>(theta2 <span class="sc">~</span> theta1, <span class="at">color =</span> <span class="sc">~</span>step, <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb133-4"><a href="03-estimacion-densidades-bayes.html#cb133-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">&quot;open&quot;</span>, <span class="at">angle =</span> <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb133-5"><a href="03-estimacion-densidades-bayes.html#cb133-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">transition_reveal</span>(step)</span>
<span id="cb133-6"><a href="03-estimacion-densidades-bayes.html#cb133-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-7"><a href="03-estimacion-densidades-bayes.html#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(Metro_2coinsBplot, <span class="at">fps =</span> <span class="dv">1</span>)</span></code></pre></div>
<div id="muestreo-de-gibbs" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Muestreo de Gibbs<a href="03-estimacion-densidades-bayes.html#muestreo-de-gibbs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para este ejemplo <span class="math inline">\(\left( \theta_{1},\theta_{2} \right)\)</span>, entonces la forma de escoger la posteriores en cada paso sería de la forma:</p>
<ol style="list-style-type: decimal">
<li>Tome al azar un <span class="math inline">\(\boldsymbol{\theta}^{0} = \left( \theta_{1}^{0},\theta_{2}^{0} \right)\)</span>.</li>
<li>Escoja <span class="math inline">\(\theta_{1}^{1}\)</span> a partir de la distribución
<span class="math inline">\(f\left(\theta_{1} \vert \theta_{1}=\theta_{1}^{0}, \theta_{2}=\theta_{2}^{0}, \boldsymbol{X} \right)\)</span>.</li>
<li>Escoja <span class="math inline">\(\theta_{2}^{1}\)</span> a partir de la distribución
<span class="math inline">\(f\left(\theta_{2} \vert \theta_{1}=\theta_{1}^{1}, \theta_{2}=\theta_{2}^{0}, \boldsymbol{X} \right)\)</span>.</li>
</ol>
<p>Esto completa un ciclo del muestreo. Cada ciclo genera nuevos <span class="math inline">\(\boldsymbol{\theta}^{i} = \left( \theta_{1}^{i},\theta_{2}^{i} \right)\)</span> hasta que el proceso converja.</p>
<div class="remark">
<p><span id="unlabeled-div-31" class="remark"><em>Nota:</em>. </span>En realidad el muestreo de Gibbs se basa en el algoritmo de M-H, con la diferencia que la elección de los parámetros se escogen teniendo en cuanta los datos y fijando los otros parámetros. Es decir,</p>
<p><span class="math display">\[\begin{align*}
&amp;{\left[\theta_{1} | \theta_{2}, \ldots, \theta_{M}, datos \right]} \\
&amp;{\left[\theta_{2} | \theta_{1}, \theta_{3}, \ldots, \theta_{M}, datos \right]} \\
&amp;{\left[\theta_{M} | \theta_{1}, \ldots, \theta_{M-1}, datos \right]}
\end{align*}\]</span></p>
</div>
<p>El tratamiento teórico puede ser consultado <a href="https://www.ece.iastate.edu/~namrata/EE527_Spring08/l4c.pdf#page=16">https://www.ece.iastate.edu/~namrata/EE527_Spring08/l4c.pdf#page=16</a></p>
<p><span class="math display">\[\begin{align*}
f\left(\theta_{1} | \theta_{2}, D\right)
&amp;= \frac{f\left(\theta_{1}, \theta_{2} | D\right)}{f\left(\theta_{2} | D\right)}  \\
&amp;= \frac{f\left(\theta_{1}, \theta_{2} | D\right)}{\int f\left(\theta_{1}, \theta_{2} | D\right)d \theta_{1}}   \\
&amp;=\frac{\operatorname{dbeta}\left(\theta_{1}, z_{1}+a_{1}, N_{1}-z_{1}+b_{1}\right) \cdot \operatorname{dbeta}\left(\theta_{2}, z_{2}+a_{2}, N_{2}-z_{2}+b_{2}\right)}{\int  \operatorname{dbeta}\left(\theta_{1}, z_{1}+a_{1}, N_{1}-z_{1}+b_{1}\right) \cdot \operatorname{dbeta}\left(\theta_{2} | z_{2}+a_{2}, N_{2}-z_{2}+b_{2}\right)d \theta_{1}} \\
&amp;=\frac{\operatorname{dbeta}\left(\theta_{1}, z_{1}+a_{1}, N_{1}-z_{1}+b_{1}\right) \cdot \operatorname{dbeta}\left(\theta_{2}, z_{2}+a_{2}, N_{2}-z_{2}+b_{2}\right)}{\operatorname{dbeta}\left(\theta_{2} | z_{2}+a_{2}, N_{2}-z_{2}+b_{2}\right) \int  \operatorname{dbeta}\left(\theta_{1}, z_{1}+a_{1}, N_{1}-z_{1}+b_{1}\right)d \theta_{1}} \\
&amp;=\frac{\operatorname{dbeta}\left(\theta_{1}, z_{1}+a_{1}, N_{1}-z_{1}+b_{1}\right)}{\int  \operatorname{dbeta}\left(\theta_{1}, z_{1}+a_{1}, N_{1}-z_{1}+b_{1}\right)d \theta_{1}} \\
&amp;=\operatorname{dbeta}\left(\theta_{1}, z_{1}+a_{1}, N_{1}-z_{1}+b_{1}\right)
\end{align*}\]</span></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="03-estimacion-densidades-bayes.html#cb134-1" aria-hidden="true" tabindex="-1"></a>gibbs_2coins <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb134-2"><a href="03-estimacion-densidades-bayes.html#cb134-2" aria-hidden="true" tabindex="-1"></a>  z1, n1,              <span class="co"># z = successes, n = trials</span></span>
<span id="cb134-3"><a href="03-estimacion-densidades-bayes.html#cb134-3" aria-hidden="true" tabindex="-1"></a>  z2, n2,              <span class="co"># z = successes, n = trials</span></span>
<span id="cb134-4"><a href="03-estimacion-densidades-bayes.html#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="co"># value of thetas to start at</span></span>
<span id="cb134-5"><a href="03-estimacion-densidades-bayes.html#cb134-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_steps =</span> <span class="fl">1e4</span>,     <span class="co"># number of steps to run the algorithm</span></span>
<span id="cb134-6"><a href="03-estimacion-densidades-bayes.html#cb134-6" aria-hidden="true" tabindex="-1"></a>  a1, b1,              <span class="co"># params for prior for theta1</span></span>
<span id="cb134-7"><a href="03-estimacion-densidades-bayes.html#cb134-7" aria-hidden="true" tabindex="-1"></a>  a2, b2               <span class="co"># params for prior for theta2</span></span>
<span id="cb134-8"><a href="03-estimacion-densidades-bayes.html#cb134-8" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb134-9"><a href="03-estimacion-densidades-bayes.html#cb134-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb134-10"><a href="03-estimacion-densidades-bayes.html#cb134-10" aria-hidden="true" tabindex="-1"></a>  theta1            <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, num_steps)  <span class="co"># trick to pre-alocate memory</span></span>
<span id="cb134-11"><a href="03-estimacion-densidades-bayes.html#cb134-11" aria-hidden="true" tabindex="-1"></a>  theta2            <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, num_steps)  <span class="co"># trick to pre-alocate memory</span></span>
<span id="cb134-12"><a href="03-estimacion-densidades-bayes.html#cb134-12" aria-hidden="true" tabindex="-1"></a>  theta1[<span class="dv">1</span>]         <span class="ot">&lt;-</span> start[<span class="dv">1</span>]</span>
<span id="cb134-13"><a href="03-estimacion-densidades-bayes.html#cb134-13" aria-hidden="true" tabindex="-1"></a>  theta2[<span class="dv">1</span>]         <span class="ot">&lt;-</span> start[<span class="dv">2</span>]</span>
<span id="cb134-14"><a href="03-estimacion-densidades-bayes.html#cb134-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb134-15"><a href="03-estimacion-densidades-bayes.html#cb134-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(num_steps<span class="dv">-1</span>)) {</span>
<span id="cb134-16"><a href="03-estimacion-densidades-bayes.html#cb134-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">1</span>) { <span class="co"># update theta1</span></span>
<span id="cb134-17"><a href="03-estimacion-densidades-bayes.html#cb134-17" aria-hidden="true" tabindex="-1"></a>      theta1[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, z1 <span class="sc">+</span> a1, n1 <span class="sc">-</span> z1 <span class="sc">+</span> b1)</span>
<span id="cb134-18"><a href="03-estimacion-densidades-bayes.html#cb134-18" aria-hidden="true" tabindex="-1"></a>      theta2[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> theta2[i]</span>
<span id="cb134-19"><a href="03-estimacion-densidades-bayes.html#cb134-19" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {           <span class="co"># update theta2</span></span>
<span id="cb134-20"><a href="03-estimacion-densidades-bayes.html#cb134-20" aria-hidden="true" tabindex="-1"></a>      theta1[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> theta1[i]</span>
<span id="cb134-21"><a href="03-estimacion-densidades-bayes.html#cb134-21" aria-hidden="true" tabindex="-1"></a>      theta2[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, z2 <span class="sc">+</span> a2, n2 <span class="sc">-</span> z2 <span class="sc">+</span> b2)</span>
<span id="cb134-22"><a href="03-estimacion-densidades-bayes.html#cb134-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb134-23"><a href="03-estimacion-densidades-bayes.html#cb134-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb134-24"><a href="03-estimacion-densidades-bayes.html#cb134-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb134-25"><a href="03-estimacion-densidades-bayes.html#cb134-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb134-26"><a href="03-estimacion-densidades-bayes.html#cb134-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">step =</span> <span class="dv">1</span><span class="sc">:</span>num_steps, </span>
<span id="cb134-27"><a href="03-estimacion-densidades-bayes.html#cb134-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta1 =</span> theta1,</span>
<span id="cb134-28"><a href="03-estimacion-densidades-bayes.html#cb134-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta2 =</span> theta2,</span>
<span id="cb134-29"><a href="03-estimacion-densidades-bayes.html#cb134-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb134-30"><a href="03-estimacion-densidades-bayes.html#cb134-30" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="03-estimacion-densidades-bayes.html#cb135-1" aria-hidden="true" tabindex="-1"></a>Gibbs <span class="ot">&lt;-</span> <span class="fu">gibbs_2coins</span>(<span class="at">z1 =</span> <span class="dv">6</span>, <span class="at">n1 =</span> <span class="dv">8</span>, <span class="at">z2 =</span> <span class="dv">2</span>, <span class="at">n2 =</span> <span class="dv">7</span>,</span>
<span id="cb135-2"><a href="03-estimacion-densidades-bayes.html#cb135-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">a1 =</span> <span class="dv">2</span>, <span class="at">b1 =</span> <span class="dv">2</span>, <span class="at">a2 =</span> <span class="dv">2</span>, <span class="at">b2 =</span> <span class="dv">2</span>)</span>
<span id="cb135-3"><a href="03-estimacion-densidades-bayes.html#cb135-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-4"><a href="03-estimacion-densidades-bayes.html#cb135-4" aria-hidden="true" tabindex="-1"></a>Gibbs <span class="sc">%&gt;%</span></span>
<span id="cb135-5"><a href="03-estimacion-densidades-bayes.html#cb135-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_density2d</span>(theta2 <span class="sc">~</span> theta1)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-140-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="03-estimacion-densidades-bayes.html#cb136-1" aria-hidden="true" tabindex="-1"></a>Gibbs <span class="sc">%&gt;%</span></span>
<span id="cb136-2"><a href="03-estimacion-densidades-bayes.html#cb136-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_dens</span>(<span class="sc">~</span>theta1)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-140-2.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="03-estimacion-densidades-bayes.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(Gibbs<span class="sc">$</span>theta1)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-140-3.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="03-estimacion-densidades-bayes.html#cb138-1" aria-hidden="true" tabindex="-1"></a>Gibbs <span class="sc">%&gt;%</span></span>
<span id="cb138-2"><a href="03-estimacion-densidades-bayes.html#cb138-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(step <span class="sc">&lt;</span> <span class="dv">500</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-3"><a href="03-estimacion-densidades-bayes.html#cb138-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_path</span>(theta2 <span class="sc">~</span> theta1, <span class="at">color =</span> <span class="sc">~</span>step, <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb138-4"><a href="03-estimacion-densidades-bayes.html#cb138-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">&quot;open&quot;</span>, <span class="at">angle =</span> <span class="dv">30</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>,</span>
<span id="cb138-5"><a href="03-estimacion-densidades-bayes.html#cb138-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;inches&quot;</span>))) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-141-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="03-estimacion-densidades-bayes.html#cb139-1" aria-hidden="true" tabindex="-1"></a>Gibbsplot <span class="ot">&lt;-</span> Gibbs <span class="sc">%&gt;%</span></span>
<span id="cb139-2"><a href="03-estimacion-densidades-bayes.html#cb139-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(step <span class="sc">&lt;</span> <span class="dv">500</span>) <span class="sc">%&gt;%</span></span>
<span id="cb139-3"><a href="03-estimacion-densidades-bayes.html#cb139-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_path</span>(theta2 <span class="sc">~</span> theta1, <span class="at">color =</span> <span class="sc">~</span>step, <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb139-4"><a href="03-estimacion-densidades-bayes.html#cb139-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">&quot;open&quot;</span>, <span class="at">angle =</span> <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb139-5"><a href="03-estimacion-densidades-bayes.html#cb139-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">transition_reveal</span>(step)</span>
<span id="cb139-6"><a href="03-estimacion-densidades-bayes.html#cb139-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-7"><a href="03-estimacion-densidades-bayes.html#cb139-7" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(Gibbsplot, <span class="at">fps =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>Ciclos completos</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="03-estimacion-densidades-bayes.html#cb140-1" aria-hidden="true" tabindex="-1"></a>Gibbs <span class="sc">%&gt;%</span></span>
<span id="cb140-2"><a href="03-estimacion-densidades-bayes.html#cb140-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(step<span class="sc">%%</span><span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb140-3"><a href="03-estimacion-densidades-bayes.html#cb140-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_density2d</span>(theta2 <span class="sc">~</span> theta1)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-143-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="03-estimacion-densidades-bayes.html#cb141-1" aria-hidden="true" tabindex="-1"></a>Gibbs <span class="sc">%&gt;%</span></span>
<span id="cb141-2"><a href="03-estimacion-densidades-bayes.html#cb141-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(step<span class="sc">%%</span><span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb141-3"><a href="03-estimacion-densidades-bayes.html#cb141-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_density</span>(<span class="sc">~</span>(theta2 <span class="sc">-</span> theta1))</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-143-2.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="03-estimacion-densidades-bayes.html#cb142-1" aria-hidden="true" tabindex="-1"></a>Gibbs <span class="sc">%&gt;%</span></span>
<span id="cb142-2"><a href="03-estimacion-densidades-bayes.html#cb142-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(step<span class="sc">%%</span><span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb142-3"><a href="03-estimacion-densidades-bayes.html#cb142-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">difference =</span> theta2 <span class="sc">-</span> theta1) <span class="sc">%&gt;%</span></span>
<span id="cb142-4"><a href="03-estimacion-densidades-bayes.html#cb142-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(difference) <span class="sc">%&gt;%</span></span>
<span id="cb142-5"><a href="03-estimacion-densidades-bayes.html#cb142-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">acf</span>()</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-143-3.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="03-estimacion-densidades-bayes.html#cb143-1" aria-hidden="true" tabindex="-1"></a>Gibbs <span class="sc">%&gt;%</span></span>
<span id="cb143-2"><a href="03-estimacion-densidades-bayes.html#cb143-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(step <span class="sc">&lt;</span> <span class="dv">500</span>, step<span class="sc">%%</span><span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb143-3"><a href="03-estimacion-densidades-bayes.html#cb143-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_path</span>(theta2 <span class="sc">~</span> theta1, <span class="at">color =</span> <span class="sc">~</span>step, <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb143-4"><a href="03-estimacion-densidades-bayes.html#cb143-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">&quot;open&quot;</span>, <span class="at">angle =</span> <span class="dv">30</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>,</span>
<span id="cb143-5"><a href="03-estimacion-densidades-bayes.html#cb143-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;inches&quot;</span>))) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-144-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="03-estimacion-densidades-bayes.html#cb144-1" aria-hidden="true" tabindex="-1"></a>Gibbsplot2 <span class="ot">&lt;-</span> Gibbs <span class="sc">%&gt;%</span></span>
<span id="cb144-2"><a href="03-estimacion-densidades-bayes.html#cb144-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(step <span class="sc">&lt;</span> <span class="dv">500</span>, step<span class="sc">%%</span><span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb144-3"><a href="03-estimacion-densidades-bayes.html#cb144-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_path</span>(theta2 <span class="sc">~</span> theta1, <span class="at">color =</span> <span class="sc">~</span>step, <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb144-4"><a href="03-estimacion-densidades-bayes.html#cb144-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">&quot;open&quot;</span>, <span class="at">angle =</span> <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb144-5"><a href="03-estimacion-densidades-bayes.html#cb144-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">transition_reveal</span>(step)</span>
<span id="cb144-6"><a href="03-estimacion-densidades-bayes.html#cb144-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-7"><a href="03-estimacion-densidades-bayes.html#cb144-7" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(Gibbsplot2, <span class="at">fps =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
</div>
<div id="uso-de-jags" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Uso de JAGS<a href="03-estimacion-densidades-bayes.html#uso-de-jags" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El paquete que usaremos en esta sección es <code>R2jags</code> y <code>coda</code>. Los cargamos con las instrucciones</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="03-estimacion-densidades-bayes.html#cb145-1" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;rpruim/CalvinBayes&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="03-estimacion-densidades-bayes.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb146-2"><a href="03-estimacion-densidades-bayes.html#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb146-3"><a href="03-estimacion-densidades-bayes.html#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(CalvinBayes)</span></code></pre></div>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="03-estimacion-densidades-bayes.html#cb147-1" aria-hidden="true" tabindex="-1"></a>bernoulli <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;data/bernoulli.csv&quot;</span>,</span>
<span id="cb147-2"><a href="03-estimacion-densidades-bayes.html#cb147-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb147-3"><a href="03-estimacion-densidades-bayes.html#cb147-3" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">glimpse</span>(bernoulli)</span></code></pre></div>
<pre><code>## Rows: 50
## Columns: 1
## $ y &lt;int&gt; 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0,~</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="03-estimacion-densidades-bayes.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bernoulli<span class="sc">$</span>y)</span></code></pre></div>
<pre><code>## [1] 0.3</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="03-estimacion-densidades-bayes.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(bernoulli<span class="sc">$</span>y)</span></code></pre></div>
<pre><code>## [1] 0.46291</code></pre>
<p>En el lenguaje usual de JAGS, el modelo debe escribirse de la forma:</p>
<pre><code>model
{
    for (i in 1:N) {
        y[i] ~ dbern(theta)
    }
    theta ~ dbeta(1, 1)
}
</code></pre>
<p>donde <code>dbern</code> y <code>dbeta</code> son las densidades de una bernoulli y beta respectivamente. En este lenguage no existen versiones vectorizadas de las funciones por lo que todo debe llenarse usando <code>for</code>’s. Una revisión completa de este lenguage la pueden econtrar en su manual de uso <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p>El paquete <code>R2jags</code> tiene la capacidad que en lugar de usar este tipo de sintaxis, se pueda usar el lenguaje natural para escribir el modelo. Note el uso de <code>function</code> en este caso.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="03-estimacion-densidades-bayes.html#cb154-1" aria-hidden="true" tabindex="-1"></a>bern_model <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb154-2"><a href="03-estimacion-densidades-bayes.html#cb154-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb154-3"><a href="03-estimacion-densidades-bayes.html#cb154-3" aria-hidden="true" tabindex="-1"></a>        y[i] <span class="sc">~</span> <span class="fu">dbern</span>(theta)</span>
<span id="cb154-4"><a href="03-estimacion-densidades-bayes.html#cb154-4" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb154-5"><a href="03-estimacion-densidades-bayes.html#cb154-5" aria-hidden="true" tabindex="-1"></a>    theta <span class="sc">~</span> <span class="fu">dbeta</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb154-6"><a href="03-estimacion-densidades-bayes.html#cb154-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="03-estimacion-densidades-bayes.html#cb155-1" aria-hidden="true" tabindex="-1"></a>bern_jags <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data =</span> <span class="fu">list</span>(<span class="at">y =</span> bernoulli<span class="sc">$</span>y, <span class="at">N =</span> <span class="fu">nrow</span>(bernoulli)),</span>
<span id="cb155-2"><a href="03-estimacion-densidades-bayes.html#cb155-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">model.file =</span> bern_model, <span class="at">parameters.to.save =</span> <span class="fu">c</span>(<span class="st">&quot;theta&quot;</span>))</span></code></pre></div>
<pre><code>## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 50
##    Unobserved stochastic nodes: 1
##    Total graph size: 53
## 
## Initializing model</code></pre>
<p>Veamos el resultado</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="03-estimacion-densidades-bayes.html#cb157-1" aria-hidden="true" tabindex="-1"></a>bern_jags</span></code></pre></div>
<pre><code>## Inference for Bugs model at &quot;/var/folders/4d/qj4qr8zx1n36td0hlt0p7x_h0000gn/T//RtmpzzsaUt/model8a4c4d19f0a2.txt&quot;, fit using jags,
##  3 chains, each with 2000 iterations (first 1000 discarded)
##  n.sims = 3000 iterations saved
##          mu.vect sd.vect   2.5%    25%    50%    75%  97.5%  Rhat n.eff
## theta      0.309   0.063  0.193  0.266  0.305  0.350  0.436 1.001  3000
## deviance  62.061   1.373 61.087 61.170 61.518 62.433 65.834 1.005  1400
## 
## For each parameter, n.eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor (at convergence, Rhat=1).
## 
## DIC info (using the rule, pD = var(deviance)/2)
## pD = 0.9 and DIC = 63.0
## DIC is an estimate of expected predictive error (lower deviance is better).</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="03-estimacion-densidades-bayes.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">posterior</span>(bern_jags))</span></code></pre></div>
<pre><code>## Error in h(simpleError(msg, call)): error in evaluating the argument &#39;x&#39; in selecting a method for function &#39;head&#39;: argument &quot;data&quot; is missing, with no default</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="03-estimacion-densidades-bayes.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dhistogram</span>(<span class="sc">~</span>theta, <span class="at">data =</span> <span class="fu">posterior</span>(bern_jags),</span>
<span id="cb161-2"><a href="03-estimacion-densidades-bayes.html#cb161-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">bins =</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span></span>
<span id="cb161-3"><a href="03-estimacion-densidades-bayes.html#cb161-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_dens</span>(<span class="sc">~</span>theta, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb161-4"><a href="03-estimacion-densidades-bayes.html#cb161-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_dist</span>(<span class="st">&quot;beta&quot;</span>, <span class="at">shape1 =</span> <span class="dv">16</span>, <span class="at">shape2 =</span> <span class="dv">36</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>## Error in verosimilitud(theta, data): argument &quot;data&quot; is missing, with no default</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="03-estimacion-densidades-bayes.html#cb163-1" aria-hidden="true" tabindex="-1"></a>bern_mcmc <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(bern_jags)</span>
<span id="cb163-2"><a href="03-estimacion-densidades-bayes.html#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bern_mcmc)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-154-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="03-estimacion-densidades-bayes.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb164-2"><a href="03-estimacion-densidades-bayes.html#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(bern_mcmc, <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;theta&quot;</span>), <span class="at">prob =</span> <span class="fl">0.9</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-155-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="03-estimacion-densidades-bayes.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(bern_mcmc, <span class="at">pars =</span> <span class="st">&quot;theta&quot;</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-156-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="03-estimacion-densidades-bayes.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(bern_mcmc, <span class="at">pars =</span> <span class="st">&quot;theta&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb166-2"><a href="03-estimacion-densidades-bayes.html#cb166-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_facet_grid</span>(Chain <span class="sc">~</span> .) <span class="sc">%&gt;%</span></span>
<span id="cb166-3"><a href="03-estimacion-densidades-bayes.html#cb166-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_refine</span>(<span class="fu">scale_color_viridis_d</span>())</span></code></pre></div>
<pre><code>## Error in `combine_vars()`:
## ! At least one layer must contain all faceting variables: `Chain`.
## * Plot is missing `Chain`
## * Layer 1 is missing `Chain`</code></pre>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-157-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="03-estimacion-densidades-bayes.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_post</span>(bern_mcmc[, <span class="st">&quot;theta&quot;</span>], <span class="at">main =</span> <span class="st">&quot;theta&quot;</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(theta),</span>
<span id="cb168-2"><a href="03-estimacion-densidades-bayes.html#cb168-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">cenTend =</span> <span class="st">&quot;median&quot;</span>, <span class="at">compVal =</span> <span class="fl">0.5</span>, <span class="at">ROPE =</span> <span class="fu">c</span>(<span class="fl">0.45</span>,</span>
<span id="cb168-3"><a href="03-estimacion-densidades-bayes.html#cb168-3" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0.55</span>), <span class="at">credMass =</span> <span class="fl">0.9</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-158-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="03-estimacion-densidades-bayes.html#cb169-1" aria-hidden="true" tabindex="-1"></a>twobernoulli <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/2bernoulli.csv&quot;</span>)</span>
<span id="cb169-2"><a href="03-estimacion-densidades-bayes.html#cb169-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-3"><a href="03-estimacion-densidades-bayes.html#cb169-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(twobernoulli)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">y</th>
<th align="left">s</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">Reginald</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="left">Reginald</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">Reginald</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">Reginald</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">Reginald</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">Reginald</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">Reginald</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="left">Reginald</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="left">Tony</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="left">Tony</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">Tony</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="left">Tony</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="left">Tony</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">Tony</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="left">Tony</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="03-estimacion-densidades-bayes.html#cb170-1" aria-hidden="true" tabindex="-1"></a>Target <span class="ot">&lt;-</span> twobernoulli <span class="sc">%&gt;%</span></span>
<span id="cb170-2"><a href="03-estimacion-densidades-bayes.html#cb170-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">hit =</span> y, <span class="at">subject =</span> s)</span>
<span id="cb170-3"><a href="03-estimacion-densidades-bayes.html#cb170-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-4"><a href="03-estimacion-densidades-bayes.html#cb170-4" aria-hidden="true" tabindex="-1"></a>Target <span class="sc">%&gt;%</span></span>
<span id="cb170-5"><a href="03-estimacion-densidades-bayes.html#cb170-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(subject) <span class="sc">%&gt;%</span></span>
<span id="cb170-6"><a href="03-estimacion-densidades-bayes.html#cb170-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">prop_0 =</span> <span class="fu">sum</span>(<span class="dv">1</span> <span class="sc">-</span> hit)<span class="sc">/</span><span class="fu">n</span>(), <span class="at">prop_1 =</span> <span class="fu">sum</span>(hit)<span class="sc">/</span><span class="fu">n</span>(),</span>
<span id="cb170-7"><a href="03-estimacion-densidades-bayes.html#cb170-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">attemps =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 2 x 4
##   subject  prop_0 prop_1 attemps
##   &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;   &lt;int&gt;
## 1 Reginald  0.25   0.75        8
## 2 Tony      0.714  0.286       7</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="03-estimacion-densidades-bayes.html#cb172-1" aria-hidden="true" tabindex="-1"></a>bern2_model <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb172-2"><a href="03-estimacion-densidades-bayes.html#cb172-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>Nobs) {</span>
<span id="cb172-3"><a href="03-estimacion-densidades-bayes.html#cb172-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># each response is Bernoulli with the</span></span>
<span id="cb172-4"><a href="03-estimacion-densidades-bayes.html#cb172-4" aria-hidden="true" tabindex="-1"></a>        <span class="co"># appropriate theta</span></span>
<span id="cb172-5"><a href="03-estimacion-densidades-bayes.html#cb172-5" aria-hidden="true" tabindex="-1"></a>        hit[i] <span class="sc">~</span> <span class="fu">dbern</span>(theta[subject[i]])</span>
<span id="cb172-6"><a href="03-estimacion-densidades-bayes.html#cb172-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb172-7"><a href="03-estimacion-densidades-bayes.html#cb172-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>Nsub) {</span>
<span id="cb172-8"><a href="03-estimacion-densidades-bayes.html#cb172-8" aria-hidden="true" tabindex="-1"></a>        theta[s] <span class="sc">~</span> <span class="fu">dbeta</span>(<span class="dv">2</span>, <span class="dv">2</span>)  <span class="co"># prior for each theta</span></span>
<span id="cb172-9"><a href="03-estimacion-densidades-bayes.html#cb172-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb172-10"><a href="03-estimacion-densidades-bayes.html#cb172-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="03-estimacion-densidades-bayes.html#cb173-1" aria-hidden="true" tabindex="-1"></a>TargetList <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Nobs =</span> <span class="fu">nrow</span>(Target), <span class="at">Nsub =</span> <span class="dv">2</span>, <span class="at">hit =</span> Target<span class="sc">$</span>hit,</span>
<span id="cb173-2"><a href="03-estimacion-densidades-bayes.html#cb173-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">subject =</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(Target<span class="sc">$</span>subject)))</span>
<span id="cb173-3"><a href="03-estimacion-densidades-bayes.html#cb173-3" aria-hidden="true" tabindex="-1"></a>TargetList</span></code></pre></div>
<pre><code>## $Nobs
## [1] 15
## 
## $Nsub
## [1] 2
## 
## $hit
##  [1] 1 0 1 1 1 1 1 0 0 0 1 0 0 1 0
## 
## $subject
##  [1] 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="03-estimacion-densidades-bayes.html#cb175-1" aria-hidden="true" tabindex="-1"></a>bern2_jags <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data =</span> TargetList, <span class="at">model =</span> bern2_model,</span>
<span id="cb175-2"><a href="03-estimacion-densidades-bayes.html#cb175-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">parameters.to.save =</span> <span class="st">&quot;theta&quot;</span>)</span></code></pre></div>
<pre><code>## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 15
##    Unobserved stochastic nodes: 2
##    Total graph size: 35
## 
## Initializing model</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="03-estimacion-densidades-bayes.html#cb177-1" aria-hidden="true" tabindex="-1"></a>bern2_mcmc <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(bern2_jags)</span>
<span id="cb177-2"><a href="03-estimacion-densidades-bayes.html#cb177-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-3"><a href="03-estimacion-densidades-bayes.html#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_acf</span>(bern2_mcmc)</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-163-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="03-estimacion-densidades-bayes.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_combo</span>(bern2_mcmc, <span class="at">combo =</span> <span class="fu">c</span>(<span class="st">&quot;dens&quot;</span>, <span class="st">&quot;dens_overlay&quot;</span>,</span>
<span id="cb178-2"><a href="03-estimacion-densidades-bayes.html#cb178-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;trace&quot;</span>, <span class="st">&quot;scatter&quot;</span>), <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;theta[1]&quot;</span>, <span class="st">&quot;theta[2]&quot;</span>))</span></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-163-2.svg" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="uso-de-stan" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Uso de STAN<a href="03-estimacion-densidades-bayes.html#uso-de-stan" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>STAN<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> es otro tipo de lenguaje para definir modelos bayesiano. El lenguaje es un poco más sencillo, pero es particularmente útil para modelos bastante complejos.</p>
<p>STAN no usa el muestreo de Gibbs, sino en el método de Monte-Carlo Hamiltoniano. En el artículo <span class="citation">(Hoffman and Gelman 2014)</span> se propone el método NUTS para mejorar el muestreo de Gibbs.</p>
<p>En este curso no nos referiremos a este procedimiento, pero si veremos un poco de la sintaxis del lenguaje STAN.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb179-1"><a href="03-estimacion-densidades-bayes.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb179-2"><a href="03-estimacion-densidades-bayes.html#cb179-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; N;               <span class="co">// number of trials</span></span>
<span id="cb179-3"><a href="03-estimacion-densidades-bayes.html#cb179-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>, <span class="kw">upper</span>=<span class="dv">1</span>&gt; y[N];   <span class="co">// success on trial n</span></span>
<span id="cb179-4"><a href="03-estimacion-densidades-bayes.html#cb179-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb179-5"><a href="03-estimacion-densidades-bayes.html#cb179-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-6"><a href="03-estimacion-densidades-bayes.html#cb179-6" aria-hidden="true" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb179-7"><a href="03-estimacion-densidades-bayes.html#cb179-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>, <span class="kw">upper</span>=<span class="dv">1</span>&gt; theta; <span class="co">// chance of success</span></span>
<span id="cb179-8"><a href="03-estimacion-densidades-bayes.html#cb179-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb179-9"><a href="03-estimacion-densidades-bayes.html#cb179-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-10"><a href="03-estimacion-densidades-bayes.html#cb179-10" aria-hidden="true" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb179-11"><a href="03-estimacion-densidades-bayes.html#cb179-11" aria-hidden="true" tabindex="-1"></a>  theta ~ uniform(<span class="dv">0</span>, <span class="dv">1</span>);        <span class="co">// prior</span></span>
<span id="cb179-12"><a href="03-estimacion-densidades-bayes.html#cb179-12" aria-hidden="true" tabindex="-1"></a>  y ~ bernoulli(theta);         <span class="co">// likelihood</span></span>
<span id="cb179-13"><a href="03-estimacion-densidades-bayes.html#cb179-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="03-estimacion-densidades-bayes.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb180-2"><a href="03-estimacion-densidades-bayes.html#cb180-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-3"><a href="03-estimacion-densidades-bayes.html#cb180-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">stan</span>(<span class="at">model_code =</span> bern_stan<span class="sc">@</span>model_code, <span class="at">data =</span> <span class="fu">list</span>(<span class="at">y =</span> bernoulli<span class="sc">$</span>y,</span>
<span id="cb180-4"><a href="03-estimacion-densidades-bayes.html#cb180-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">nrow</span>(bernoulli)), <span class="at">iter =</span> <span class="dv">5000</span>)</span></code></pre></div>
<pre><code>## 
## SAMPLING FOR MODEL &#39;4584de91ce47196187979d2da8a67926&#39; NOW (CHAIN 1).
## Chain 1: 
## Chain 1: Gradient evaluation took 2.3e-05 seconds
## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.23 seconds.
## Chain 1: Adjust your expectations accordingly!
## Chain 1: 
## Chain 1: 
## Chain 1: Iteration:    1 / 5000 [  0%]  (Warmup)
## Chain 1: Iteration:  500 / 5000 [ 10%]  (Warmup)
## Chain 1: Iteration: 1000 / 5000 [ 20%]  (Warmup)
## Chain 1: Iteration: 1500 / 5000 [ 30%]  (Warmup)
## Chain 1: Iteration: 2000 / 5000 [ 40%]  (Warmup)
## Chain 1: Iteration: 2500 / 5000 [ 50%]  (Warmup)
## Chain 1: Iteration: 2501 / 5000 [ 50%]  (Sampling)
## Chain 1: Iteration: 3000 / 5000 [ 60%]  (Sampling)
## Chain 1: Iteration: 3500 / 5000 [ 70%]  (Sampling)
## Chain 1: Iteration: 4000 / 5000 [ 80%]  (Sampling)
## Chain 1: Iteration: 4500 / 5000 [ 90%]  (Sampling)
## Chain 1: Iteration: 5000 / 5000 [100%]  (Sampling)
## Chain 1: 
## Chain 1:  Elapsed Time: 0.028353 seconds (Warm-up)
## Chain 1:                0.0353 seconds (Sampling)
## Chain 1:                0.063653 seconds (Total)
## Chain 1: 
## 
## SAMPLING FOR MODEL &#39;4584de91ce47196187979d2da8a67926&#39; NOW (CHAIN 2).
## Chain 2: 
## Chain 2: Gradient evaluation took 8e-06 seconds
## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.08 seconds.
## Chain 2: Adjust your expectations accordingly!
## Chain 2: 
## Chain 2: 
## Chain 2: Iteration:    1 / 5000 [  0%]  (Warmup)
## Chain 2: Iteration:  500 / 5000 [ 10%]  (Warmup)
## Chain 2: Iteration: 1000 / 5000 [ 20%]  (Warmup)
## Chain 2: Iteration: 1500 / 5000 [ 30%]  (Warmup)
## Chain 2: Iteration: 2000 / 5000 [ 40%]  (Warmup)
## Chain 2: Iteration: 2500 / 5000 [ 50%]  (Warmup)
## Chain 2: Iteration: 2501 / 5000 [ 50%]  (Sampling)
## Chain 2: Iteration: 3000 / 5000 [ 60%]  (Sampling)
## Chain 2: Iteration: 3500 / 5000 [ 70%]  (Sampling)
## Chain 2: Iteration: 4000 / 5000 [ 80%]  (Sampling)
## Chain 2: Iteration: 4500 / 5000 [ 90%]  (Sampling)
## Chain 2: Iteration: 5000 / 5000 [100%]  (Sampling)
## Chain 2: 
## Chain 2:  Elapsed Time: 0.035783 seconds (Warm-up)
## Chain 2:                0.044111 seconds (Sampling)
## Chain 2:                0.079894 seconds (Total)
## Chain 2: 
## 
## SAMPLING FOR MODEL &#39;4584de91ce47196187979d2da8a67926&#39; NOW (CHAIN 3).
## Chain 3: 
## Chain 3: Gradient evaluation took 1e-05 seconds
## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.1 seconds.
## Chain 3: Adjust your expectations accordingly!
## Chain 3: 
## Chain 3: 
## Chain 3: Iteration:    1 / 5000 [  0%]  (Warmup)
## Chain 3: Iteration:  500 / 5000 [ 10%]  (Warmup)
## Chain 3: Iteration: 1000 / 5000 [ 20%]  (Warmup)
## Chain 3: Iteration: 1500 / 5000 [ 30%]  (Warmup)
## Chain 3: Iteration: 2000 / 5000 [ 40%]  (Warmup)
## Chain 3: Iteration: 2500 / 5000 [ 50%]  (Warmup)
## Chain 3: Iteration: 2501 / 5000 [ 50%]  (Sampling)
## Chain 3: Iteration: 3000 / 5000 [ 60%]  (Sampling)
## Chain 3: Iteration: 3500 / 5000 [ 70%]  (Sampling)
## Chain 3: Iteration: 4000 / 5000 [ 80%]  (Sampling)
## Chain 3: Iteration: 4500 / 5000 [ 90%]  (Sampling)
## Chain 3: Iteration: 5000 / 5000 [100%]  (Sampling)
## Chain 3: 
## Chain 3:  Elapsed Time: 0.040828 seconds (Warm-up)
## Chain 3:                0.034064 seconds (Sampling)
## Chain 3:                0.074892 seconds (Total)
## Chain 3: 
## 
## SAMPLING FOR MODEL &#39;4584de91ce47196187979d2da8a67926&#39; NOW (CHAIN 4).
## Chain 4: 
## Chain 4: Gradient evaluation took 8e-06 seconds
## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.08 seconds.
## Chain 4: Adjust your expectations accordingly!
## Chain 4: 
## Chain 4: 
## Chain 4: Iteration:    1 / 5000 [  0%]  (Warmup)
## Chain 4: Iteration:  500 / 5000 [ 10%]  (Warmup)
## Chain 4: Iteration: 1000 / 5000 [ 20%]  (Warmup)
## Chain 4: Iteration: 1500 / 5000 [ 30%]  (Warmup)
## Chain 4: Iteration: 2000 / 5000 [ 40%]  (Warmup)
## Chain 4: Iteration: 2500 / 5000 [ 50%]  (Warmup)
## Chain 4: Iteration: 2501 / 5000 [ 50%]  (Sampling)
## Chain 4: Iteration: 3000 / 5000 [ 60%]  (Sampling)
## Chain 4: Iteration: 3500 / 5000 [ 70%]  (Sampling)
## Chain 4: Iteration: 4000 / 5000 [ 80%]  (Sampling)
## Chain 4: Iteration: 4500 / 5000 [ 90%]  (Sampling)
## Chain 4: Iteration: 5000 / 5000 [100%]  (Sampling)
## Chain 4: 
## Chain 4:  Elapsed Time: 0.028987 seconds (Warm-up)
## Chain 4:                0.027037 seconds (Sampling)
## Chain 4:                0.056024 seconds (Total)
## Chain 4:</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="03-estimacion-densidades-bayes.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>))</span></code></pre></div>
<pre><code>## Inference for Stan model: 4584de91ce47196187979d2da8a67926.
## 4 chains, each with iter=5000; warmup=2500; thin=1; 
## post-warmup draws per chain=2500, total post-warmup draws=10000.
## 
##         mean se_mean   sd    10%    90% n_eff Rhat
## theta   0.31    0.00 0.06   0.23   0.39  3848    1
## lp__  -32.61    0.01 0.74 -33.51 -32.11  4641    1
## 
## Samples were drawn using NUTS(diag_e) at Thu May 19 08:22:22 2022.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="03-estimacion-densidades-bayes.html#cb184-1" aria-hidden="true" tabindex="-1"></a>theta_draws <span class="ot">&lt;-</span> <span class="fu">extract</span>(fit)<span class="sc">$</span>theta</span>
<span id="cb184-2"><a href="03-estimacion-densidades-bayes.html#cb184-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-3"><a href="03-estimacion-densidades-bayes.html#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(theta_draws)</span></code></pre></div>
<pre><code>## [1] 0.3081564</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="03-estimacion-densidades-bayes.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(theta_draws, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>))</span></code></pre></div>
<pre><code>##       10%       90% 
## 0.2264123 0.3910150</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="03-estimacion-densidades-bayes.html#cb188-1" aria-hidden="true" tabindex="-1"></a>shinystan<span class="sc">::</span><span class="fu">launch_shinystan</span>(fit)</span></code></pre></div>
<div class="exercise">
<p><span id="exr:unnamed-chunk-167" class="exercise"><strong>Ejercicio 4.1  </strong></span>Replique los resultados anteriores pero para el caso de 2 monedas y comente los resultados.</p>
</div>
</div>
<div id="ejercicios-2" class="section level2 hasAnchor" number="4.8">
<h2><span class="header-section-number">4.8</span> Ejercicios<a href="03-estimacion-densidades-bayes.html#ejercicios-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Del libro <span class="citation">(Albert et al. 2009)</span>
<ul>
<li><strong>Sección 3:</strong> 3, 7.</li>
<li><strong>Sección 6:</strong> 1, 3.</li>
</ul></li>
<li>Del libro <span class="citation">(Kruschke 2014)</span>
<ul>
<li><strong>Sección 6:</strong> 2.</li>
<li><strong>Sección 7:</strong> 2.</li>
</ul></li>
</ol>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p><a href="http://web.sgh.waw.pl/~atoroj/ekonometria_bayesowska/jags_user_manual.pdf">http://web.sgh.waw.pl/~atoroj/ekonometria_bayesowska/jags_user_manual.pdf</a><a href="03-estimacion-densidades-bayes.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p><a href="https://mc-stan.org/">https://mc-stan.org/</a><a href="03-estimacion-densidades-bayes.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="02-jacknife-bootstrap.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="04-metodos-lineares-regresion.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/maikol-solis/notas-curso-estadistica/edit/master/03-estimacion-densidades-bayes.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/maikol-solis/notas-curso-estadistica/blob/master/03-estimacion-densidades-bayes.Rmd",
"text": null
},
"download": ["Notas-Curso-Estadistica.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toc_depth": 5
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
